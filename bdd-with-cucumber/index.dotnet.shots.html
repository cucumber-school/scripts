<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="author" content="Matt Wynne">
<title>BDD with Cucumber (SpecFlow)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>BDD with Cucumber (SpecFlow)</h1>
<div class="details">
<span id="author" class="author">Matt Wynne</span><br>
<span id="email" class="email"><a href="mailto:matt@cucumber.io">matt@cucumber.io</a></span><br>
<span id="revdate">Gaspar Nagy &lt;gaspar@specsolutions.eu&gt;</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_discovering_bdd">1. Discovering BDD</a></li>
<li><a href="#_your_first_scenario">2. Your first Scenario</a>
<ul class="sectlevel2">
<li><a href="#_an_introduction_to_shouty">2.1. An introduction to Shouty</a></li>
<li><a href="#_choose_the_first_scenario">2.2. Choose the first scenario</a></li>
<li><a href="#_install_specflow">2.3. Install SpecFlow</a></li>
<li><a href="#_add_a_scenario_wire_it_up">2.4. Add a scenario, wire it up</a></li>
<li><a href="#_sketch_out_the_solution">2.5. Sketch out the solution</a></li>
<li><a href="#_make_the_scenario_pass">2.6. Make the scenario pass</a></li>
</ul>
</li>
<li><a href="#_expressing_yourself">3. Expressing yourself</a>
<ul class="sectlevel2">
<li><a href="#_cucumber_expressions_not_regular_expressions">3.1. Cucumber expressions not regular expressions</a></li>
<li><a href="#_literal_expressions">3.2. Literal expressions</a></li>
<li><a href="#_capturing_parameters">3.3. Capturing parameters</a></li>
<li><a href="#_flexibility">3.4. Flexibility</a></li>
<li><a href="#_custom_parameters">3.5. Custom parameters</a></li>
</ul>
</li>
<li><a href="#_cleaning_up">4. Cleaning up</a>
<ul class="sectlevel2">
<li><a href="#_the_importance_of_readability">4.1. The importance of readability</a></li>
<li><a href="#_review_changes_that_happened_while_we_were_away">4.2. Review changes that happened while we were away</a></li>
<li><a href="#_description_field">4.3. Description field</a></li>
<li><a href="#_the_before_hook">4.4. The "Before" hook</a></li>
<li><a href="#_create_person_in_a_generic_stepdef">4.5. Create Person in a generic stepdef</a></li>
<li><a href="#_backgrounds">4.6. Backgrounds</a></li>
</ul>
</li>
<li><a href="#_loops">5. Loops</a>
<ul class="sectlevel2">
<li><a href="#_removing_redundant_scenarios">5.1. Removing redundant scenarios</a></li>
<li><a href="#_incidental_details">5.2. Incidental details</a></li>
<li><a href="#_refactoring_to_data_tables">5.3. Refactoring to Data Tables</a></li>
<li><a href="#_deeper_into_data_tables">5.4. Deeper into Data Tables</a></li>
<li><a href="#_docstring">5.5. DocString</a></li>
<li><a href="#_tdd_loops">5.6. TDD Loops</a></li>
</ul>
</li>
<li><a href="#_working_with_cucumber">6. Working with Cucumber</a>
<ul class="sectlevel2">
<li><a href="#_basic_filtering">6.1. Basic Filtering</a></li>
<li><a href="#_running_the_scenarios_from_the_command_line">6.2. Running the scenarios from the command line</a></li>
<li><a href="#_more_control">6.3. More Control</a></li>
<li><a href="#_dealing_with_execution_results">6.4. Dealing with execution results</a></li>
</ul>
</li>
<li><a href="#_details">7. Details</a></li>
<li><a href="#_example_mapping">8. Example Mapping</a>
<ul class="sectlevel2">
<li><a href="#_example_mapping_why">8.1. Example Mapping: Why?</a></li>
<li><a href="#_example_mapping_how">8.2. Example Mapping: How?</a></li>
<li><a href="#_example_mapping_conclusions">8.3. Example Mapping: Conclusions</a></li>
</ul>
</li>
<li><a href="#_support_code">9. Support Code</a></li>
<li><a href="#_acceptance_tests_vs_unit_tests">10. Acceptance Tests vs Unit Tests</a></li>
<li><a href="#_web_automation_with_selenium_webdriver">11. Web automation with Selenium Webdriver</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_discovering_bdd">1. Discovering BDD</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_your_first_scenario">2. Your first Scenario</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The video and audio assets for this chapter are <a href="https://drive.google.com/drive/u/2/folders/1He7stdn0S-zIlNmWF-d1ISuyhfC7tMwO">here</a>.</p>
</div>
<div class="sect2">
<h3 id="_an_introduction_to_shouty">2.1. An introduction to Shouty</h3>
<div class="paragraph">
<p>Shouty is a social network that allows people who are physically close to communicate, just like people have always communicated with their voices. In the real world you can talk to someone in the same room, or across the street. Or even 100 m away from you in a park - if you shout.</p>
</div>
<div class="paragraph">
<p>That’s Shouty. What you say on this social network can only be “heard” by people who are nearby.</p>
</div>
<div class="audioblock">
<div class="content">
<audio src="https://drive.google.com/uc?id=185INaLm9jKvAZqvm-CzqpkfSyGt3C_kb" controls>
Your browser does not support the audio tag.
</audio>
</div>
</div>
<div class="videoblock">
<div class="content">
<video src="https://drive.google.com/uc?id=1coTuZC_HcN3RXfduRqnZMfzlYJStQ2hq" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_choose_the_first_scenario">2.2. Choose the first scenario</h3>
<div class="paragraph">
<p>Let’s start with a very basic example of Shouty’s behaviour. Something we might have discussed in a three amigos meeting:</p>
</div>
<div class="paragraph">
<p>Sean the shouter shouts "free bagels at Sean&#8217;s" and Lucy the listener who happens to be stood across the street from his store, 15 metres away, hears him. She walks into Sean’s Coffee and takes advantage of the offer.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1547" id="shot-1547" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1</a>
We can translate this into a Gherkin scenario so that Cucumber can run it. Here&#8217;s how that would look.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener is within range
  <span class="nf">Given </span>Lucy is located 15m from Sean
  <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
  <span class="nf">Then </span>Lucy hears Sean’s message</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see there are four special keywords being used here. <code>Scenario</code> just tells Cucumber we’re about to describe an example that it can execute. Then you see the lines beginning with Given, When and Then.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1548" id="shot-1548" title="Highlight line 2" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: Highlight line 2</a>
<code>Given</code> is the context for the scenario. We’re putting the system into a specific state, ready for the scenario to unfold.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1549" id="shot-1549" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3</a>
<code>When</code> is an action. Something that happens to the system that will cause something else to happen: an outcome.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1550" id="shot-1550" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4</a>
<code>Then</code> is the outcome. It’s the behaviour we expect from the system when this action happens in this context.</p>
</div>
<div class="paragraph">
<p>You’ll notice we’ve omitted from our outcome anything about Lucy walking into Sean’s store and making a purchase. Remember, Gherkin is supposed to describe the behaviour of the system, so it would be distracting to have it in our scenario.</p>
</div>
<div class="paragraph">
<p>Each scenario has these three ingredients:
<a href="#shot-1551" id="shot-1551" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5</a>
  a context,
<a href="#shot-1552" id="shot-1552" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6</a>
  an action,
<a href="#shot-1553" id="shot-1553" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7</a>
  and one or more outcomes.</p>
</div>
<div class="paragraph">
<p>Together, they describe one single aspect of the behaviour of the system. An example.</p>
</div>
<div class="paragraph">
<p>Now that we’ve translated our example into Gherkin, we can automate it!</p>
</div>
<div class="sect3">
<h4 id="_lesson_2_questions">2.2.1. Lesson 2 - Questions</h4>
<div class="sect4">
<h5 id="_whats_an_advantage_of_using_gherkin_to_express_our_examples_in_bdd_choose_one">What’s an advantage of using  Gherkin to express our examples in BDD? (choose one) ::</h5>
<div class="ulist">
<ul>
<li>
<p>We can get Cucumber to test whether the code does what the scenario describes.</p>
</li>
<li>
<p>We can easily automate tests even if we don&#8217;t know much about programming.</p>
</li>
<li>
<p>We can use tools to generate the scenarios.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Gherkin is just one way of expressing examples of how you want your system to behave. The advantage of using this particular format is that you can use Cucumber to test them for you, making them into Living Documentation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_these_are_gherkin_keywords_choose_multiple">Which of these are Gherkin keywords? (choose multiple)::</h5>
<div class="ulist">
<ul>
<li>
<p>Scenario</p>
</li>
<li>
<p>Story</p>
</li>
<li>
<p>Given</p>
</li>
<li>
<p>Only</p>
</li>
<li>
<p>If</p>
</li>
<li>
<p>When</p>
</li>
<li>
<p>Before</p>
</li>
<li>
<p>Then</p>
</li>
<li>
<p>While</p>
</li>
<li>
<p>Check</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
We’ve introduced four Gherkin keywords so far:
  * <code>Scenario</code> tells Cucumber we’re about to describe an example that it can execute.
  * <code>Given</code>, <code>When</code> and <code>Then</code> identify the steps of the scenario.
There are a few other keywords which will be introduced later in the course.</p>
</div>
</div>
<div class="sect4">
<h5 id="_the_gherkin_keywords_given_when_and_then_allow_us_to_express_three_different_components_of_a_scenario_which_of_these_statements_correctly_describes_how_each_of_these_keywords_should_be_used_choose_multiple">The Gherkin keywords Given, When and Then, allow us to express three different components of a scenario. Which of these statements correctly describes how each of these keywords should be used? (Choose multiple)::</h5>
<div class="ulist">
<ul>
<li>
<p>Given describes something that has already happened before the interesting part of the scenario starts. (Correct)</p>
</li>
<li>
<p>Then describes an action you want to take.</p>
</li>
<li>
<p>When explains what should happen at the end of the scenario.</p>
</li>
<li>
<p>Then explains what should happen at the end of the scenario. (Correct)</p>
</li>
<li>
<p>When expresses an action that changes the state of the system. (Correct)</p>
</li>
<li>
<p>Given describes the context in which the scenario occurs. (Correct)</p>
</li>
<li>
<p>Explanation:</p>
</li>
<li>
<p>Given is the context for the scenario. We’re putting the system into a specific state, ready for the scenario to unfold.</p>
</li>
<li>
<p>When is an action. Something that happens to the system that will cause something else to happen: an outcome.</p>
</li>
<li>
<p>Then is the outcome. It’s the behaviour we expect from the system when this action happens in this context.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
<strong>Given</strong> is the context for the scenario. We’re putting the system into a specific state, ready for the scenario to unfold.</p>
</div>
<div class="paragraph">
<p><strong>When</strong> is an action. Something that happens to the system that will cause something else to happen: an outcome.</p>
</div>
<div class="paragraph">
<p><strong>Then</strong> is the outcome. It’s the behaviour we expect from the system when this action happens in this context.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_did_our_scenario_not_mention_anything_about_lucy_walking_into_seans_store_and_making_a_purchase">Why did our scenario not mention anything about Lucy walking into Sean’s store and making a purchase?</h5>
<div class="ulist">
<ul>
<li>
<p>It&#8217;s a business goal which does not belong in a Gherkin document.</p>
</li>
<li>
<p>As BDD practitioners, we&#8217;re focussed on the behaviour of the system, so we don&#8217;t care about the people who use the software.</p>
</li>
<li>
<p>Including details about these two people would be distracting from the main point of our scenario.</p>
</li>
<li>
<p>Executable scenarios need to stay focussed on the behaviour of the system itself. We can document business goals elsewhere in our Gherkin to provide context. - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Behaviour-Driven Development practitioners definitely do care about business goals, but when we&#8217;re writing the Scenario part of our Gherkin, we need to focus on the observable, testable behaviour of the system we&#8217;re building.</p>
</div>
<div class="paragraph">
<p>Later in the course we&#8217;ll show you how you can use other parts of Gherkin documents to add other relevant details, like business goals, to make great executable specifications.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_install_specflow">2.3. Install SpecFlow</h3>
<div class="paragraph">
<p><a href="#shot-1554" id="shot-1554" title="still" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1.1: still</a> Hello! I&#8217;m Gaspar Nagy, the creator of SpecFlow and a BDD trainer nowadays. I will guide you through the SpecFlow automation topics in Cucumber School. First, let&#8217;s install SpecFlow!</p>
</div>
<div class="paragraph">
<p><a href="#shot-1555" id="shot-1555" title="still" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1.2: still</a> SpecFlow is an open-source tool that is available as a <a href="#shot-1556" id="shot-1556" title="still" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1.3: still</a> NuGet package that you need to configure for your project. Although SpecFlow works fine even without Visual Studio, in Cucumber School we are going to use Visual Studio 2019, because it integrates nicely with SpecFlow. If you don&#8217;t have Visual Studio, you can download the <a href="#shot-1557" id="shot-1557" title="still" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1.4: still</a> Visual Studio Community edition that is free for education purposes and small teams.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1558" id="shot-1558" title="start VS, go under the text" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1.5: start VS, go under the text</a> In order to use the Visual Studio integration of SpecFlow, you need to install a Visual Studio extension. This is something you need to do only once. The Visual Studio extensions can be managed by opening the <strong>Manage Extensions</strong> command from the <strong>Extensions</strong> menu. <a href="#shot-1559" id="shot-1559" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1.6</a></p>
</div>
<div class="paragraph">
<p>There are plenty of useful extensions in the Visual Studio marketplace <a href="#shot-1560" id="shot-1560" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2</a> and for SpecFlow there are two that you can choose from. You will find these if you type <strong>SpecFlow</strong> into the search box. <a href="#shot-1561" id="shot-1561" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3</a> Both the <strong>SpecFlow for Visual Studio 2019</strong> <a href="#shot-1562" id="shot-1562" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4</a> and the <strong>Deveroom for SpecFlow</strong> <a href="#shot-1563" id="shot-1563" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5</a> extensions work well with SpecFlow and both of them are free and open-source. In this course I will use the Deveroom extension, but you can follow the exercises with the other one as well.</p>
</div>
<div class="paragraph">
<p>In order to install the extension you just need to click on the <strong>Download</strong> button next to the name of the extension you selected.<a href="#shot-1564" id="shot-1564" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6</a> The extension is downloaded, but it only gets installed once you close your Visual Studio. So we need to close all instances of Visual Studio 2019 and wait for the install dialog to pop up. <a href="#shot-1565" id="shot-1565" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7</a></p>
</div>
<div class="paragraph">
<p><a href="#shot-1566" id="shot-1566" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8</a> Here it is. Accept the installation of the extension by clicking on the <strong>Modify</strong> button <a href="#shot-1567" id="shot-1567" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9</a>, that completes the setup process. <a href="#shot-1568" id="shot-1568" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10</a> Our Visual Studio is now ready to work with SpecFlow. So are we.</p>
</div>
<div class="paragraph">
<p>Now we are going to create a Visual Studio solution for the Shouty application. <a href="#shot-1569" id="shot-1569" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11</a> As we will focus on the business logic of the application in this course, I create a .NET Standard class library project for the production code. <a href="#shot-1570" id="shot-1570" title="type Shouty" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: type Shouty</a> I also remove the class that comes with the template. <a href="#shot-1571" id="shot-1571" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13</a></p>
</div>
<div class="paragraph">
<p>We also need to add a project for the scenarios and the automation code. SpecFlow works with test execution frameworks in order to make the scenarios executable. It supports all well known test execution frameworks like MsTest, NUnit or xUnit. There is also a free dedicated runner developed by Tricentis called SpecFlow+ Runner. For the sake of simplicity in this course we are going to use xUnit, so I add a .NET Core <strong>xUnit Test Project</strong> to my solution. <a href="#shot-1572" id="shot-1572" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14</a></p>
</div>
<div class="paragraph">
<p>I call our test project <strong>Shouty.Specs</strong> <a href="#shot-1573" id="shot-1573" title="type Shouty.Specs" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: type Shouty.Specs</a>. Including <strong>Specs</strong> in the project name emphasizes that we are creating an executable specification. As we won&#8217;t have coded unit test in this project I remove the <code>UnitTest1.cs</code> file added by the template. <a href="#shot-1574" id="shot-1574" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16</a></p>
</div>
<div class="paragraph">
<p>To make this project a <strong>SpecFlow project</strong>, we need to add two NuGet package references.</p>
</div>
<div class="paragraph">
<p>The first is <strong>SpecFlow.xUnit</strong>. <a href="#shot-1575" id="shot-1575" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17</a> This is going to install SpecFlow for the project and configure it to work with xUnit.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1576" id="shot-1576" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18</a> At the time of the recording this leads to an error as the xUnit version used by the <strong>xUnit Test Project</strong> template is not recent enough for the latest SpecFlow version. This is something we can easily fix by updating the xUnit related packages of the specs project. <a href="#shot-1577" id="shot-1577" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19</a> In fact we can upgrade all packages in this case. <a href="#shot-1578" id="shot-1578" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20</a></p>
</div>
<div class="paragraph">
<p>Let&#8217;s retry. <a href="#shot-1579" id="shot-1579" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21</a> Installing the <strong>SpecFlow.xUnit</strong> package is now successful.</p>
</div>
<div class="paragraph">
<p>The second package we need to add is the <strong>SpecFlow.Tools.MsBuild.Generation</strong> package. <a href="#shot-1580" id="shot-1580" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22</a> This will instruct SpecFlow to turn our scenarios into executable tests every time we build the project. <a href="#shot-1581" id="shot-1581" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23</a></p>
</div>
<div class="paragraph">
<p>As we automate the scenarios, we will need to create class instances and call methods from the application project. To make this possible we need to add a reference to the SpecFlow project <a href="#shot-1582" id="shot-1582" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24</a> pointing to the <code>Shouty</code> project. <a href="#shot-1583" id="shot-1583" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 25</a></p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a quick look at the project file of the <code>Specs</code> project. <a href="#shot-1584" id="shot-1584" title="show project file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 26: show project file</a> If we did everything well, our project file should look like this. As this is a .NET Core project, we could actually achieve the same outcome just by adding these lines to the project file manually. That probably would have been easier. Maybe next time.</p>
</div>
<div class="paragraph">
<p>The SpecFlow project will contain the feature file, the automation code, and some other files necessary for the automation infrastructure. Adding all these into the root folder of the project would be quite messy. Teams that work with SpecFlow usually follow some conventions in order to structure their SpecFlow projects. If you have used any Cucumber-family tools before, these conventions will be familiar for you.</p>
</div>
<div class="paragraph">
<p>To achieve that, let&#8217;s create three folders. One, called <code>Features</code> <a href="#shot-1585" id="shot-1585" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 27</a> where we will store&#8230;&#8203; well the feature files, I guess. The second folder that we usually have is called <code>StepDefinitions</code>. <a href="#shot-1586" id="shot-1586" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 28</a> This will be the container for our automation code. And finally we also create a third folder called <code>Support</code> <a href="#shot-1587" id="shot-1587" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 29</a> where we can store any files related to the supporting infrastructure.</p>
</div>
<div class="paragraph">
<p>Nice!</p>
</div>
<div class="paragraph">
<p>Let&#8217;s verify out setup by building the solution. <a href="#shot-1588" id="shot-1588" title="build from Build menu" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 30: build from Build menu</a></p>
</div>
<div class="paragraph">
<p>The build succeeded so now we&#8217;re ready to create our first feature file.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1589" id="shot-1589" title="show extended project file, CucumberExpressions package highlighted" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 31: show extended project file, CucumberExpressions package highlighted</a></p>
</div>
<div class="paragraph">
<p>In this course we are going to use Cucumber Expressions that are explained in detail in Chapter 3. In SpecFlow version 3.1 that we use Cucumber Expressions are not supported by default. You can enable this feature by adding the <code>CucumberExpressions.SpecFlow.3-1</code> NuGet package to the project, like you can see in the project file. We also specified the exact SpecFlow package version explicitly to avoid the version compatibility warning. With later SpecFlow versions, these additions won&#8217;t be needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_add_a_scenario_wire_it_up">2.4. Add a scenario, wire it up</h3>
<div class="paragraph">
<p>Let&#8217;s create our first feature file <a href="#shot-1590" id="shot-1590" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1</a> using the "Add / New Item&#8230;&#8203;" command. Call the file <code>HearShout.feature</code></p>
</div>
<div class="paragraph">
<p><a href="#shot-1591" id="shot-1591" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2</a>
All feature files start with the keyword <code>Feature:</code>
<a href="#shot-1592" id="shot-1592" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3</a>
followed by a name.
It&#8217;s a good convention to give it a name that matches the file name. <a href="#shot-1593" id="shot-1593" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4</a></p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> <span class="err">Hear</span> <span class="err">shout</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1594" id="shot-1594" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5</a>
Now let&#8217;s write out our first scenario.</p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener is within range
	<span class="nf">Given </span>Lucy is located 15m from Sean
	<span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
	<span class="nf">Then </span>Lucy hears Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1595" id="shot-1595" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5.1</a> This is the one where the listener is within range. <a href="#shot-1596" id="shot-1596" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5.2</a> Given Lucy is located 15 metres for Sean, <a href="#shot-1597" id="shot-1597" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5.3</a> When Sean shouts "free bagels at Sean&#8217;s", <a href="#shot-1598" id="shot-1598" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5.4</a>, Then Lucy hears Sean&#8217;s message.</p>
</div>
<div class="paragraph">
<p>Build the solution. <a href="#shot-1599" id="shot-1599" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6</a></p>
</div>
<div class="paragraph">
<p>As you can see <a href="#shot-1600" id="shot-1600" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7</a> our new scenario has appeared in the "Test Explorer" window.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t have a "Test Explorer" in your Visual Studio, you can open it <a href="#shot-1601" id="shot-1601" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8</a> using the "Test Explorer" command from the "Test" menu.</p>
</div>
<div class="paragraph">
<p>Run the tests. <a href="#shot-1602" id="shot-1602" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9</a></p>
</div>
<div class="paragraph">
<p>The test execution failed with an error message <a href="#shot-1603" id="shot-1603" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10</a> that says "No matching step definition found for one or more steps". This is because some of our steps are <em>undefined</em>.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1604" id="shot-1604" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11</a> Undefined steps are also higlighted in Visual Studio with an orange color.</p>
</div>
<div class="paragraph">
<p><em>Undefined</em> means SpecFlow doesn&#8217;t know what to do for any of the three steps we wrote in our Gherkin scenario. It needs us to provide some <em>step definitions</em>.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1605" id="shot-1605" title="02.04.animation.mp4" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11.1: 02.04.animation.mp4</a></p>
</div>
<div class="paragraph">
<p>Step definitions translate from the plain language you use in Gherkin into C# code. We write a C# method, then annotate it with a pattern using the Given, When or Then attributes provided by SpecFlow.</p>
</div>
<div class="paragraph">
<p>When SpecFlow runs a step, it looks for a step definition that matches the text in the Gherkin step. If it finds one, then it executes the code in the step definition.</p>
</div>
<div class="paragraph">
<p>If it doesn&#8217;t find one… well, you&#8217;ve just seen what happens. <a href="#shot-1606" id="shot-1606" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12</a> SpecFlow prints out some code snippets that we can use as a basis for new step definitions,
but you can get the same snippets from Visual Studio, <a href="#shot-1607" id="shot-1607" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13</a> using the "Define steps&#8230;&#8203;" command in the editor.</p>
</div>
<div class="paragraph">
<p>The dialog can help us to create a new class and paste the selected snippets. <a href="#shot-1608" id="shot-1608" title="disable and re-enable checkbox" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: disable and re-enable checkbox</a> We&#8217;ll just call the class <code>StepDefinitions</code>. <a href="#shot-1609" id="shot-1609" title="change name and go ahead with 'Create'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: change name and go ahead with 'Create'</a></p>
</div>
<div class="paragraph">
<p><a href="#shot-1610" id="shot-1610" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16</a> The wizard detected that we had a <code>StepDefinitions</code> folder and saved the new class there. SpecFlow would find it anywhere within the same project, but it is better this way.</p>
</div>
<div class="paragraph">
<p>Now run the tests again.
<a href="#shot-1611" id="shot-1611" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17</a></p>
</div>
<div class="paragraph">
<p>This time we&#8217;ve got another error message. <a href="#shot-1612" id="shot-1612" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18</a> It says "One or more step definitions are not implemented yet".</p>
</div>
<div class="paragraph">
<p>The step definition snippets we have copied into the project <a href="#shot-1613" id="shot-1613" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19</a> have thrown a <code>PendingStepException</code> that at the end caused this error.</p>
</div>
<div class="paragraph">
<p>Now our scenario and our steps are <em>pending</em>, meaning that we have to implement the automation code to have a fully automated scenario.
You can think of the <code>PendingStepException</code> as a reminder of that.</p>
</div>
<div class="paragraph">
<p>Now that we&#8217;ve wired up our step definitions to the Gherkin steps, it&#8217;s almost time to start working on our solution. First though, let&#8217;s tidy up the generated code.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1614" id="shot-1614" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20</a>
We&#8217;ll rename the <code>int</code> parameter to something that better reflects its meaning. We&#8217;ll call it <code>distance</code>.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1615" id="shot-1615" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21</a> We can put a breakpoint into the method and <a href="#shot-1616" id="shot-1616" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22</a> debug the scenario to see what&#8217;s happening.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1617" id="shot-1617" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23</a> When the breakpoint hits, the value of the <code>distance</code> parameter is 15.</p>
</div>
<div class="paragraph">
<p>Notice that the number 15 does not appear anywhere in our C# code. The value is automatically passed from the scenario step to the step definition.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re interested, that was caused by the <a href="#shot-1618" id="shot-1618" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24</a> <code>{int}</code> in the step definition pattern or <em>cucumber expression</em>. We’ll explain these patterns in detail in a future lesson.</p>
</div>
<div class="sect3">
<h4 id="_lesson_4_questions">2.4.1. Lesson 4 - Questions</h4>
<div class="sect4">
<h5 id="_what_do_step_definitions_do_choose_one">What do step definitions do? (choose one) ::</h5>
<div class="ulist">
<ul>
<li>
<p>Provide a glossary of domain terms for your stakeholders</p>
</li>
<li>
<p>Give Cucumber/SpecFlow a way to automate your gherkin steps - TRUE</p>
</li>
<li>
<p>Add extra meaning to our Gherkin steps</p>
</li>
<li>
<p>Generate code from gherkin documents</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
&lt;java&gt;
Step definitions are Java methods that actually do what&#8217;s described in each step of a Gherkin scenario.</p>
</div>
<div class="paragraph">
<p>When it tries to run each step of a scenario, Cucumber will search for a step definition that matches. If there&#8217;s a matching step definition, it will call the method to run it.
&lt;/java&gt;</p>
</div>
<div class="paragraph">
<p>&lt;js&gt;
Step definitions are JavaScript functions that actually do what&#8217;s described in each step of a Gherkin scenario.</p>
</div>
<div class="paragraph">
<p>When it tries to run each step of a scenario, Cucumber will search for a step definition that matches. If there&#8217;s a matching step definition, it will call the function.
&lt;/js&gt;</p>
</div>
<div class="paragraph">
<p>&lt;ruby&gt;
Step definitions are Ruby blocks that actually do what&#8217;s described in each step of a Gherkin scenario.</p>
</div>
<div class="paragraph">
<p>When it tries to run each step of a scenario, Cucumber will search for a step definition that matches. If there&#8217;s a matching step definition, it will execute the code in the block.
&lt;/ruby&gt;</p>
</div>
<div class="paragraph">
<p>&lt;C#&gt;
Step definitions are C# methods that actually do what&#8217;s described in each step of a Gherkin scenario.</p>
</div>
<div class="paragraph">
<p>When it tries to run each step of a scenario, SpecFlow will search for a step definition that matches. If there&#8217;s a matching step definition, it will call the method to run it.
&lt;/C#&gt;</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_does_it_mean_when_cucumberspecflow_says_a_step_is_pending_choose_one">What does it mean when Cucumber/SpecFlow says a step is Pending? (choose one) ::</h5>
<div class="ulist">
<ul>
<li>
<p>The step took too long to execute and was terminated
&lt;java&gt; * The step threw a <code>PendingException</code>, meaning we&#8217;re still working on implementing that step.&lt;/java&gt;
&lt;js&gt; * The step returned pending, meaning we&#8217;re still working on implementing that step.&lt;/js&gt;
&lt;ruby&gt; * The step definition threw a Pending error, meaning we&#8217;re still working on implementing that step.&lt;/ruby&gt;
&lt;C#&gt; ASK GASPAR &lt;/C#&gt;</p>
</li>
<li>
<p>Cucumber/SpecFlow was unable to find the step definitions</p>
</li>
<li>
<p>The scenario is passing</p>
</li>
<li>
<p>The scenario is failing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:</p>
</div>
<div class="paragraph">
<p>&lt;java&gt;
Cucumber tells us that a step (and by inference the Scenario that contains it) is Pending when the automation code throws a PendingException.</p>
</div>
<div class="paragraph">
<p>The PendingException is a special type of exception provided by Cucumber to allow the development team to signal that automation for a step is a work in progress. This makes it possible to tell the difference between steps that aren&#8217;t finished yet and steps that are failing due to a defect in the system.</p>
</div>
<div class="paragraph">
<p>For example, when we run our tests in a Continuous Integration (CI) environment, we can choose to ignore pending scenarios.
&lt;/java&gt;</p>
</div>
<div class="paragraph">
<p>&lt;js&gt;
Cucumber tells us that a step (and by inference the Scenario that contains it) is Pending when the automation code throws a Pending error.</p>
</div>
<div class="paragraph">
<p>This allows the development team to signal that automation for a step is a work in progress. This makes it possible to tell the difference between steps that are still being worked on and steps that are failing due to a defect in the system.</p>
</div>
<div class="paragraph">
<p>For example, when we run our tests in a Continuous Integration (CI) environment, we can choose to ignore pending scenarios.
&lt;/js&gt;</p>
</div>
<div class="paragraph">
<p>&lt;ruby&gt;
Cucumber tells us that a step (and by inference the Scenario that contains it) is Pending when the automation code throws a Pending error.</p>
</div>
<div class="paragraph">
<p>This allows the development team to signal that automation for a step is a work in progress. This makes it possible to tell the difference between steps that are still being worked on and steps that are failing due to a defect in the system.</p>
</div>
<div class="paragraph">
<p>For example, when we run our tests in a Continuous Integration (CI) environment, we can choose to ignore pending scenarios.
&lt;/ruby&gt;</p>
</div>
<div class="paragraph">
<p>&lt;C#&gt; ASK GASPAR &lt;/C#&gt;</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_the_following_might_you_want_to_consider_when_using_a_snippet_generated_by_cucumberspecflow">Which of the following might you want to consider when using a snippet generated by Cucumber/SpecFlow?</h5>
<div class="ulist">
<ul>
<li>
<p>Does the name of the method correctly describe the intent of the step? - TRUE</p>
</li>
<li>
<p>Do the parameter names correctly describe the meaning of the arguments? - TRUE</p>
</li>
<li>
<p>Does the snippet correctly automate the gherkin step as described? - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
When Cucumber/SpecFlow generates a snippet, it has no idea of the business context of the undefined step. The implementation that Cucumber/SpecFlow generates will definitely not automate what&#8217;s been written in your Gherkin - that&#8217;s up to you! Also, the name of the method and the parameters are just placeholders. It&#8217;s the job of the person writing the code to rename the method and parameters to reflect the business domain.</p>
</div>
</div>
<div class="sect4">
<h5 id="_whats_the_next_step_in_bdd_after_weve_pasted_in_the_step_definition_snippet_and_seen_it_fail_with_a_pending_status">What’s the next step in BDD after we’ve pasted in the step definition snippet and seen it fail with a <code>pending</code> status?</h5>
<div class="ulist">
<ul>
<li>
<p>Check with our project manager about the requirement</p>
</li>
<li>
<p>Implement some code that does what the Gherkin step describes - TRUE</p>
</li>
<li>
<p>Create a test framework for modelling our application</p>
</li>
<li>
<p>Run a manual test to check what the system does</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
If you read the comment in the generated snippet, Cucumber/SpecFlow is telling you to "turn the phrase above into concrete actions".</p>
</div>
<div class="paragraph">
<p>You need your step definition to call your application and do whatever the Gherkin step describes. In the case of our first step here, we want to tell the system that there are two people in certain locations.</p>
</div>
<div class="paragraph">
<p>We can use the act of fleshing out the body of our step definition as an opportunity to do some software design. We can think about what we want the interface to our system to look like, from the point of view of someone who needs to interact with it. Should we interact with it through the User Interface, or make a call to the programmer API directly? How would we like that interface to work?</p>
</div>
<div class="paragraph">
<p>We can do all of this without writing any implementation yet.</p>
</div>
<div class="paragraph">
<p>This is known as "outside-in" development. It helps us to ensure that when we do come to implementing our solution, we&#8217;re implementing it based on real needs.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sketch_out_the_solution">2.5. Sketch out the solution</h3>
<div class="paragraph">
<p><a href="#shot-1619" id="shot-1619" title="still" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: still</a>
Now that we have the step definitions matching, we can start working on our solution. We like to use our scenarios to <em>guide</em> our development, so we&#8217;ll start designing the objects we&#8217;ll need by sketching out some code in our step definitions.</p>
</div>
<div class="paragraph">
<p>The scenario will be failing while we do this, but we should see the error messages gradually progressing as we drive out the interface to our object model.</p>
</div>
<div class="paragraph">
<p>Our next goal is for the scenario to fail because we need to implement the actual business logic. <em>Then</em> we can work on changing the business logic inside our objects to make it pass.</p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="p">[</span><span class="n">Binding</span><span class="p">]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">StepDefinitions</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is located {int}m from Sean"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsLocatedMFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">PendingStepException</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts {string}"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShouts</span><span class="p">(</span><span class="kt">string</span> <span class="n">p0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">PendingStepException</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucy hears Sean's message"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyHearsSeanSMessage</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">PendingStepException</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To implement the first step, we need to create a couple of <code>Person</code> objects, one for Lucy <a href="#shot-1620" id="shot-1620" title="declare var for lucy" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: declare var for lucy</a> and one for Sean.<a href="#shot-1621" id="shot-1621" title="paste var for sean" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: paste var for sean</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">@"Lucy is located {int}m from Sean"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsLocatedMFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">lucy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">();</span>
    <span class="kt">var</span> <span class="n">sean</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">();</span>

    <span class="c1">// ...</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we create the <code>Person</code> class into our production project to remove the errors.<a href="#shot-1622" id="shot-1622" title="add new class in Shouty" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: add new class in Shouty</a> To make it visible for the SpecFlow project, <a href="#shot-1623" id="shot-1623" title="add public" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: add public</a> we need to make it <em>public</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="k">namespace</span> <span class="nn">Shouty</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1624" id="shot-1624" title="go back to step defs" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: go back to step defs</a> In order to complete the step definition for the <em>Given</em> step, we need to specify the distance between Lucy and Sean.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1625" id="shot-1625" title="02.05.animation.mp4" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6.1: 02.05.animation.mp4</a></p>
</div>
<div class="paragraph">
<p>To keep things simple, we&#8217;re going to assume all people are situated on a line: a one-dimensional co-ordinate system. We can always introduce proper geo-locations later. We&#8217;ll place Sean in the centre, and Lucy 15 metres away from Sean.</p>
</div>
<div class="paragraph">
<p>This might not be the design we&#8217;ll end up with once this is all working, but it&#8217;s a decent place to start.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1626" id="shot-1626" title="back at stepdefs, still" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: back at stepdefs, still</a>We can implement our simple distance concept by introducing a <code>MoveTo</code> method like this:<a href="#shot-1627" id="shot-1627" title="add MoveTo call" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: add MoveTo call</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">@"Lucy is located {int}m from Sean"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsLocatedMFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">lucy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">();</span>
    <span class="kt">var</span> <span class="n">sean</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">();</span>
    <span class="n">lucy</span><span class="p">.</span><span class="nf">MoveTo</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span>

    <span class="k">throw</span> <span class="k">new</span> <span class="nf">PendingStepException</span><span class="p">();</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We have two instances of person, one representing Lucy, <a href="#shot-1628" id="shot-1628" title="select lucy" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: select lucy</a>and one representing Sean. <a href="#shot-1629" id="shot-1629" title="select sean" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: select sean</a>Then we call a method to move Lucy to the position specified in the scenario.<a href="#shot-1630" id="shot-1630" title="select MoveTo call" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: select MoveTo call</a></p>
</div>
<div class="paragraph">
<p>As this seems to be complete like this, we can remove the pending exception.<a href="#shot-1631" id="shot-1631" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12</a></p>
</div>
<div class="paragraph">
<p>There is no <code>MoveTo</code> method yet, <a href="#shot-1632" id="shot-1632" title="move mouse to the error" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: move mouse to the error</a> so Visual Studio reports a compilation error. To fix it, we can create the method on the <code>Person</code> class, <a href="#shot-1633" id="shot-1633" title="use lightbulb" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: use lightbulb</a> but at this stage we don&#8217;t bother with the correct implementation. <a href="#shot-1634" id="shot-1634" title="remove exception" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: remove exception</a> It is enough if it compiles, so an empty method is just fine for now.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="k">namespace</span> <span class="nn">Shouty</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">MoveTo</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1635" id="shot-1635" title="back to stepdefs, run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: back to stepdefs, run tests</a>
When we run the scenario, the first step should be passing! The easiest way to see this is to open the test output by clicking on the "Open additional output for this result" link <a href="#shot-1636" id="shot-1636" title="click link" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17: click link</a> and check the "Standard Output" section. Here you can see all steps executed by SpecFlow with their results. The first step is "done" <a href="#shot-1637" id="shot-1637" title="select first step" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: select first step</a> and the two others are still pending <a href="#shot-1638" id="shot-1638" title="select the other steps" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19: select the other steps</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">Given Lucy is located 15m from Sean
-&gt; <span class="k">done</span>: StepDefinitions.GivenLucyIsLocatedMFromSean<span class="o">(</span>15<span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
When Sean shouts <span class="s2">"free bagels at Sean's"</span>
-&gt; pending: StepDefinitions.WhenSeanShouts<span class="o">(</span><span class="s2">"free bagels at Se..."</span><span class="o">)</span>
Then Lucy hears Sean<span class="s1">''</span>s message
-&gt; skipped because of previous errors</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;re making progress!</p>
</div>
<div class="paragraph">
<p>We&#8217;ll keep working like this until we see the scenario failing for the right reasons.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1639" id="shot-1639" title="back to stepdefs" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20: back to stepdefs</a>
In the second step definition, we want to tell Sean to shout something.</p>
</div>
<div class="paragraph">
<p>In order to send instructions to Sean from the "When" step, we need to store him <a href="#shot-1640" id="shot-1640" title="select var decl" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21: select var decl</a> in an <em>instance field</em>, so that he&#8217;ll be accessible from all of our step definitions. Let&#8217;s move both declarations up to class level together with the initializations. <a href="#shot-1641" id="shot-1641" title="move lines up, fix var, private" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22: move lines up, fix var, private</a></p>
</div>
<div class="paragraph">
<p><a href="#shot-1642" id="shot-1642" title="scroll to When" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23: scroll to When</a>
In the <code>When</code> step, we&#8217;re capturing Sean&#8217;s message using <a href="#shot-1643" id="shot-1643" title="select {string}" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24: select {string}</a> <em>this</em> pattern that is mapped to the parameter <a href="#shot-1644" id="shot-1644" title="select p0" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 25: select p0</a> <code>p0</code>. Let&#8217;s give it a more meaningful name.<a href="#shot-1645" id="shot-1645" title="rename to 'message'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 26: rename to 'message'</a>
Don&#8217;t worry if the pattern sounds unfamiliar to you, we will look at that in detail in the next chapter.</p>
</div>
<div class="paragraph">
<p>And now we can tell Sean to <em>shout</em> the message: <a href="#shot-1646" id="shot-1646" title="add sean.Shout(message) and remove throw" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 27: add sean.Shout(message) and remove throw</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="p">[</span><span class="n">Binding</span><span class="p">]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">StepDefinitions</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">Person</span> <span class="n">lucy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">();</span>
    <span class="k">private</span> <span class="n">Person</span> <span class="n">sean</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">();</span>

    <span class="c1">//...</span>

    <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">@"Sean shouts ""([^""]*)"""</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShouts</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">sean</span><span class="p">.</span><span class="nf">Shout</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//...</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We eliminate the compilation error by declaring the <code>Shout</code> method in the <code>Person</code> class. <a href="#shot-1647" id="shot-1647" title="use lightbulb" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 28: use lightbulb</a> <a href="#shot-1648" id="shot-1648" title="remove throw" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 28.1: remove throw</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="k">namespace</span> <span class="nn">Shouty</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">MoveTo</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Shout</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When we run the scenario again, <a href="#shot-1649" id="shot-1649" title="run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 29: run</a> the second step <a href="#shot-1650" id="shot-1650" title="open output, select second step" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 30: open output, select second step</a> is also passing!.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">Given Lucy is located 15m from Sean
-&gt; <span class="k">done</span>: StepDefinitions.GivenLucyIsLocatedMFromSean<span class="o">(</span>15<span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
When Sean shouts <span class="s2">"free bagels at Sean's"</span>
-&gt; <span class="k">done</span>: StepDefinitions.WhenSeanShouts<span class="o">(</span><span class="s2">"free bagels at Se..."</span><span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
Then Lucy hears Sean<span class="s1">''</span>s message
-&gt; pending: StepDefinitions.ThenLucyHearsSeanSMessage<span class="o">()</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1651" id="shot-1651" title="back to stepdefs" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 31: back to stepdefs</a>
The last step definition is where we implement a check, or assertion. We&#8217;ll verify that what Lucy has heard is exactly the same as what Sean shouted.</p>
</div>
<div class="paragraph">
<p>Once again we&#8217;re going to write the code we wish we had. <a href="#shot-1652" id="shot-1652" title="paste assert statement" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 32: paste assert statement</a> In that we are going to use an assertion from the <code>Xunit</code> library, so we need to add the necessary namespace usages.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1653" id="shot-1653" title="add xunit namespace using" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 33: add xunit namespace using</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">@"Lucy hears Sean's message"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyHearsSeanSMessage</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Assert</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">messageFromSean</span><span class="p">,</span> <span class="n">lucy</span><span class="p">.</span><span class="nf">GetMessagesHeard</span><span class="p">());</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>So we need a way to ask Lucy what messages she has heard, and we also need to know what it was that Sean shouted.</p>
</div>
<div class="paragraph">
<p>We can record what Sean shouts <a href="#shot-1654" id="shot-1654" title="select message in when" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 34: select message in when</a> by storing it in an instance field as the <code>When</code> step runs. <a href="#shot-1655" id="shot-1655" title="declare a field and update" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 35: declare a field and update</a> This is a common pattern to use in SpecFlow step definitions when you don&#8217;t want to repeat the same test data in different parts of a scenario. Now we can use that in the assertion check. <a href="#shot-1656" id="shot-1656" title="select messageFromSean in Then" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 36: select messageFromSean in Then</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">@"Sean shouts {string}"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShouts</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">sean</span><span class="p">.</span><span class="nf">Shout</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="n">messageFromSean</span> <span class="p">=</span> <span class="n">message</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We also need to add a <code>GetMessagesHeard</code> method to our Person class.<a href="#shot-1657" id="shot-1657" title="use lightbulb" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 37: use lightbulb</a> Let&#8217;s just return null for now.<a href="#shot-1658" id="shot-1658" title="add return null" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 38: add return null</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">MoveTo</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Shout</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">IList</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">GetMessagesHeard</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and watch SpecFlow run the tests again.<a href="#shot-1659" id="shot-1659" title="run, open result" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 39: run, open result</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">Given Lucy is located 15m from Sean
-&gt; <span class="k">done</span>: StepDefinitions.GivenLucyIsLocatedMFromSean<span class="o">(</span>15<span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
When Sean shouts <span class="s2">"free bagels at Sean's"</span>
-&gt; <span class="k">done</span>: StepDefinitions.WhenSeanShouts<span class="o">(</span><span class="s2">"free bagels at Se..."</span><span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
Then Lucy hears Sean<span class="s1">'s message
-&gt; error: Value cannot be null. (Parameter '</span>collection<span class="s1">')</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is great! Whenever we do BDD, getting to our first failing test is a milestone. Seeing the test fail proves that it is capable of detecting errors in our code!</p>
</div>
<div class="paragraph">
<p>Never trust an automated test that you haven&#8217;t seen fail!</p>
</div>
<div class="paragraph">
<p>Now all we have to do is write the code to make it do what it&#8217;s supposed to.</p>
</div>
<div class="sect3">
<h4 id="_lesson_5_questions">2.5.1. Lesson 5 - Questions</h4>
<div class="sect4">
<h5 id="_how_does_the_practice_writing_a_failing_test_before_implementing_the_solution_help_us">How does the practice writing a failing test before implementing the solution help us?</h5>
<div class="ulist">
<ul>
<li>
<p>Until you see a scenario fail, you can’t be sure that it can ever fail [true]</p>
</li>
<li>
<p>There’s no need to always see a scenario fail [false]</p>
</li>
<li>
<p>BDD practitioners use failing scenarios to guide their development [true]</p>
</li>
<li>
<p>A passing scenario implies the functionality it describes has already been implemented, so it may be a duplicate of an existing scenario [true]</p>
</li>
<li>
<p>BDD practitioners believe in learning from failure [false]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Behaviour-Driven Development comes from Test-Driven Development, where we always start with a failing test, then use that to guide our development. This sometimes described as red-green-refactor.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>red - write a scenario/test and see it fail
green - make it pass (as simply as possible)
refactor - improve your code, while keeping all the tests/scenarios green</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s surprisingly easy to write scenarios and step definitions that don&#8217;t do anything. It&#8217;s the transition from red to green that gives us confidence that the scenario and the implementation actually do what we expect.</p>
</div>
<div class="paragraph">
<p>If a scenario passes as soon as we write it, that means that either it&#8217;s not doing what we think it should or the behaviour that it describes has already been implemented. In that case, we&#8217;re not developing using behaviour-driven development.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_did_we_change_to_use_an_instance_variable_for_storing_each_person_select_one">Why did we change to use an instance variable for storing each Person? (select one) ::</h5>
<div class="ulist">
<ul>
<li>
<p>It ensures we can interact with the same object from different steps. [true]</p>
</li>
<li>
<p>It’s a better way to organise the code</p>
</li>
<li>
<p>It’s more efficient for performance</p>
</li>
<li>
<p>Cucumber/SpecFlow requires us to store our objects as instance variables.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
In Cucumber/SpecFlow, one of the ways to access the same instance of an object from different step definition methods, is to store it on an instance variable.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_did_we_avoid_having_to_mention_the_detail_of_the_text_sean_had_shouted_in_our_when_and_then_steps_select_one">How did we avoid having to mention the detail of the text Sean had shouted in our When and Then steps? (select one) ::</h5>
<div class="ulist">
<ul>
<li>
<p>We duplicated the text inside our Person class</p>
</li>
<li>
<p>We used an instance variable to store the text that was shouted [true]</p>
</li>
<li>
<p>We called a method on the Person class to retrieve the messages heard</p>
</li>
<li>
<p>We passed the message text in from our Gherkin scenarios</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
When you need to assert for a specific value coming out of your system in a Then step, you can use an instance variable to store it where it goes into the system (in a Given or When) step. This means you can avoid duplicating the value in multiple places in your code.</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_flow_should_we_follow_when_making_a_scenario_pass_select_one">Which flow should we follow when making a Scenario pass? (select one) ::</h5>
<div class="ulist">
<ul>
<li>
<p>Domain modelling &#8594; Write some code &#8594; Make it compile &#8594; Run the scenario &amp; watch it fail</p>
</li>
<li>
<p>Write some code &#8594; Domain modelling &#8594; Make it compile &#8594; Run the scenario</p>
</li>
<li>
<p>Write some code &#8594; Make it compile &#8594; Domain modelling &#8594; Run the scenario - TRUE</p>
</li>
<li>
<p>Domain modelling &#8594; Run the scenario &#8594; Write some code &#8594; Make it compile</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Our goal at this stage is to get to a failing test, where the only thing left to do to make it pass is make changes to the implementation of the app itself.</p>
</div>
<div class="paragraph">
<p>On an existing system, we might not need to create so much new code to get to this goal, but we might need to make some changes to how we call the system. This gives us an opportunity to do some lightweight domain modelling.</p>
</div>
<div class="paragraph">
<p>It may not compile first-time, so we implement the bare-bones of our solution until it does.</p>
</div>
<div class="paragraph">
<p>We use the scenarios to guide us in our implementation.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_make_the_scenario_pass">2.6. Make the scenario pass</h3>
<div class="paragraph">
<p>So we have our failing scenario: <a href="#shot-1660" id="shot-1660" title="start from feature file, show test result, select error" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: start from feature file, show test result, select error</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">Given Lucy is located 15m from Sean
-&gt; <span class="k">done</span>: StepDefinitions.GivenLucyIsLocatedMFromSean<span class="o">(</span>15<span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
When Sean shouts <span class="s2">"free bagels at Sean's"</span>
-&gt; <span class="k">done</span>: StepDefinitions.WhenSeanShouts<span class="o">(</span><span class="s2">"free bagels at Se..."</span><span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
Then Lucy hears Sean<span class="s1">'s message
-&gt; error: Value cannot be null. (Parameter '</span>collection<span class="s1">')</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lucy is expected to hear Sean&#8217;s message, but she hasn&#8217;t heard anything: we got <code>null</code> back from the <code>GetMessagesHeard</code> method. <a href="#shot-1661" id="shot-1661" title="switch to method" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: switch to method</a></p>
</div>
<div class="paragraph">
<p>In this case, we&#8217;re going to cheat. We have a one-line fix that will make this scenario pass, but it&#8217;s not a particularly future-proof implementation. Can you guess what it is? <a href="#shot-1662" id="shot-1662" title="paste fixed message return" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: paste fixed message return</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="k">public</span> <span class="n">IList</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">GetMessagesHeard</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="p">{</span> <span class="s">"free bagels at Sean's"</span> <span class="p">};</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>I told you it wasn&#8217;t very future proof! But let&#8217;s see what SpecFlow says to that.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1663" id="shot-1663" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: run tests</a></p>
</div>
<div class="paragraph">
<p>Fantastic! Our scenario is passing for the first time. As long as this is the <em>only</em> message anyone ever shouts, we&#8217;re good to ship this thing! But I&#8217;m afraid this is not going to be the case so let&#8217;s work a bit more on it.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1664" id="shot-1664" title="back to feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: back to feature file</a></p>
</div>
<div class="paragraph">
<p>Now, the fact that such a poor implementation can pass <em>all</em> our tests shows us that we need to work on our tests. A more comprehensive set of tests would guide us towards a better implementation.</p>
</div>
<div class="paragraph">
<p>It&#8217;s a good habit to look for the most simple solution though. We can trust that, as our tests evolve, so will our solution.</p>
</div>
<div class="paragraph">
<p>Instead of writing a note on our TODO list, let&#8217;s write another test that shouts a different message. Usually we&#8217;d expect a developer to do this using a unit test, but to keep things simple in this lesson, we&#8217;re going to write another scenario.</p>
</div>
<div class="paragraph">
<p>We&#8217;ve worked hard. It&#8217;s time for a coffee, so let&#8217;s come up with an example that has Sean offering free coffee. <a href="#shot-1665" id="shot-1665" title="paste second scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: paste second scenario</a> <a href="#shot-1666" id="shot-1666" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6.1: run tests</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout
  <span class="kn">Scenario</span><span class="p">:</span> Listener is within range
    <span class="nf">Given </span>Lucy is located 15m from Sean
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
    <span class="nf">Then </span>Lucy hears Sean's message

  <span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
    <span class="nf">Given </span>Lucy is located 15m from Sean
    <span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
    <span class="nf">Then </span>Lucy hears Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1667" id="shot-1667" title="open result, select error" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: open result, select error</a> It fails, reminding us we need to find a solution that doesn&#8217;t rely on hard-coding the message.
Now when we come back to this code, we can just run the tests and SpecFlow will tell us what we need to do next. We&#8217;re done for today!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">Test Name:	Listener hears a different message
<span class="o">[</span>...]
Result Message:
Assert.Contains<span class="o">()</span> Failure
Not found: Free coffee!
In value:  List&lt;String&gt; <span class="o">[</span><span class="s2">"free bagels at Sean's"</span><span class="o">]</span>
Result StandardOutput:
Given Lucy is located 15m from Sean
-&gt; <span class="k">done</span>: StepDefinitions.GivenLucyIsLocatedMFromSean<span class="o">(</span>15<span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
When Sean shouts <span class="s2">"Free coffee!"</span>
-&gt; <span class="k">done</span>: StepDefinitions.WhenSeanShouts<span class="o">(</span><span class="s2">"Free coffee!"</span><span class="o">)</span> <span class="o">(</span>0.0s<span class="o">)</span>
Then Lucy hears Sean<span class="s1">'s message
-&gt; error: Assert.Contains() Failure
Not found: Free coffee!
In value:  List&lt;String&gt; ["free bagels at Sean'</span>s<span class="s2">"]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, if you&#8217;re in the mood, you can always try to implement a solution yourself that makes both scenarios pass. Have fun!</p>
</div>
<div class="sect3">
<h4 id="_questions">2.6.1. Questions</h4>
<div class="qlist qanda">
<ol>
<li>
<p><em>Why should we always make sure that we see a scenario fail before we make it pass? (select multiple) </em></p>
<div class="ulist">
<ul>
<li>
<p>Until you see a scenario fail, you can’t be sure that it can ever fail [true]</p>
</li>
<li>
<p>There’s no need to always see a scenario fail [false]</p>
</li>
<li>
<p>BDD practitioners use failing scenarios to drive their development [true]</p>
</li>
<li>
<p>A passing scenario implies the functionality it describes has already been implemented, so it may be a duplicate of an existing scenario [true]</p>
</li>
<li>
<p>BDD practitioners believe in learning from failure [false]</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Why did we change to use an instance variable for storing each Person? </em></p>
<div class="ulist">
<ul>
<li>
<p>It ensures we can interact with the same object from different steps. [true]</p>
</li>
<li>
<p>It’s a better way to organise the code</p>
</li>
<li>
<p>It’s more efficient for performance</p>
</li>
<li>
<p>Cucumber requires us to store our objects as instance variables.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>How did we avoid having to mention the detail of the text Sean had shouted in our When and Then steps? </em></p>
<div class="ulist">
<ul>
<li>
<p>We duplicated the text inside our Person class</p>
</li>
<li>
<p>We used an instance variable to store the text that was shouted [true]</p>
</li>
<li>
<p>We called a method on the Person class to retrieve the messages heard</p>
</li>
<li>
<p>We passed the message text in from our Gherkin scenarios</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Which flow should we follow when making a Scenario pass? </em></p>
<div class="ulist">
<ul>
<li>
<p>Domain modelling &#8594; Write some code &#8594; Make it compile &#8594; Run the scenario &amp; watch it fail</p>
</li>
<li>
<p>Write some code &#8594; Domain modelling &#8594; Make it compile &#8594; Run the scenario</p>
</li>
<li>
<p>Write some code &#8594; Make it compile &#8594; Domain modelling &#8594; Run the scenario</p>
</li>
<li>
<p>Domain modelling &#8594; Run the scenario &#8594; Write some code &#8594; Make it compile</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Why is our naive implementation of Person.getMessagesHeard, with a hard-coded message OK in BDD? (select multiple) </em></p>
<div class="ulist">
<ul>
<li>
<p>It shows us that we need better examples to pin down the behaviour we really want from the code. [correct]</p>
</li>
<li>
<p>We know we will iterate on our solution, when we come up with more examples of what we want it to do. [correct]</p>
</li>
<li>
<p>Nobody is using our solution yet [incorrect]</p>
</li>
<li>
<p>We have to do a bad implementation so we can see our test fail. [incorrect]</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Look at this diagram (1) Write a scenario, 2) Automate it and watch it fail, 3) Write just enough code to make it pass). Which stage are we at as the video ends? </em></p>
<div class="ulist">
<ul>
<li>
<p>1</p>
</li>
<li>
<p>2</p>
</li>
<li>
<p>3</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_expressing_yourself">3. Expressing yourself</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_cucumber_expressions_not_regular_expressions">3.1. Cucumber expressions not regular expressions</h3>
<div class="paragraph">
<p><a href="#shot-1668" id="shot-1668" title="03.01.animation.mp4" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 0.1: 03.01.animation.mp4</a></p>
</div>
<div class="paragraph">
<p>In the previous chapter we explored the fundamental components of a SpecFlow test suite, and how we use SpecFlow to drive out a solution, test-first.</p>
</div>
<div class="paragraph">
<p>First we specified the behaviour we wanted, using a Gherkin scenario in a feature file. Then we wrote step definitions to translate the plain english from our scenario into concrete actions in code. Finally, we used the step definitions to guide us in building out our very basic domain model for the Shouty application.</p>
</div>
<div class="paragraph">
<p>We tend to think of the code that actually pokes around with the system as distinct from the step definitions, so we’ve drawn an extra box labelled "automation code" for this.</p>
</div>
<div class="paragraph">
<p>Automation code can do almost anything to your application: it can drive a web browser around your site, make HTTP requests to a REST API, or&#8201;&#8212;&#8201;as you’ve already seen&#8201;&#8212;&#8201;drive a domain model directly.</p>
</div>
<div class="paragraph">
<p>Automation code is a big topic that we’ll come back to. First, we want to concentrate on step definitions.
Good step definitions are important because they enable the <em>readability</em> of your scenarios. The better you are at matching plain language phrases from Gherkin, the more expressive you can be when writing scenarios. Teams who do this well refer to their features as <em>living documentation</em> - a specification document that never goes out of date.</p>
</div>
<div class="paragraph">
<p>When SpecFlow first started, we used to use <em>regular expressions</em> to match plain language phrases from Gherkin steps.</p>
</div>
<div class="paragraph">
<p>Regular expressions have quite an intimidating reputation.</p>
</div>
<div class="paragraph">
<p>Although regular expressions are still the default matching option, we started to adopt a simpler option that has been introduced in Cucumber. It is called <em>Cucumber expressions</em>.</p>
</div>
<div class="paragraph">
<p>In the SpecFlow version that we use in this course, Cucumber Expressions are not supported by default. You can enable this feature by adding the <code>CucumberExpressions.SpecFlow.3-4</code> NuGet package to the project, as we described in Chapter 2.</p>
</div>
<div class="paragraph">
<p>SpecFlow is backwards compatible so you can still use the power of regular expressions if that&#8217;s your thing.</p>
</div>
<div class="paragraph">
<p>This chapter is all about Cucumber Expressions.</p>
</div>
<div class="sect3">
<h4 id="_lesson_1_questions_ruby_java_js">3.1.1. Lesson 1 - Questions (Ruby, Java, JS)</h4>
<div class="sect4">
<h5 id="_which_of_the_following_statements_are_true">Which of the following statements are true?</h5>
<div class="ulist">
<ul>
<li>
<p>Step definitions translate human-readable scenarios into concrete actions in code - TRUE</p>
</li>
<li>
<p>BDD practitioners think of "step definitions" and "automation code" as distinct concepts - TRUE</p>
</li>
<li>
<p>Cucumber only supports automation through the user interface - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: A step definition is a piece of code that is called by Cucumber in response to a step in a scenario. You can write any code you like inside a step definition, but we&#8217;ve found it easier to maintain if we keep them short. This leads to step definitions calling dedicated automation code to perform concrete actions against the system under construction. That automation code can manipulate the user interface, make a REST call, or drive the domain model directly.</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_the_following_statements_are_true_2">Which of the following statements are true?</h5>
<div class="ulist">
<ul>
<li>
<p>Regular Expressions are exactly the same as Cucumber Expressions - FALSE</p>
</li>
<li>
<p>Modern versions of Cucumber only support both Cucumber Expressions and Rregular Expressions - TRUE</p>
</li>
<li>
<p>Cucumber Expressions are more intimidating than Regular Expressions - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Regular Expressions are a powerful tool that have been in use in computer science for many decades. They can be hard understand and maintain, so the Cucumber team created a simplified mechanism, called Cucumber Expressions. However, Cucumber remains backwards compatible, so you can use both Regular Expressions and Cucumber Expressions with modern releases of Cucumber.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lesson_1_questions_specflowcdotnet">3.1.2. Lesson 1 - Questions (SpecFlow/C#/Dotnet)</h4>
<div class="sect4">
<h5 id="_which_of_the_following_statements_are_true_3">Which of the following statements are true?</h5>
<div class="ulist">
<ul>
<li>
<p>Step definitions translate human-readable scenarios into concrete actions in code - TRUE</p>
</li>
<li>
<p>BDD practitioners think of "step definitions" and "automation code" as distinct concepts - TRUE</p>
</li>
<li>
<p>SpecFlow only supports automation through the user interface - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: A step definition is a piece of code that is called by SpecFlow in response to a step in a scenario. You can write any code you like inside a step definition, but we&#8217;ve found it easier to maintain if we keep them short. This leads to step definitions calling dedicated automation code to perform concrete actions against the system under construction. That automation code can manipulate the user interface, make a REST call, or drive the domain model directly.</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_the_following_statements_are_true_4">Which of the following statements are true?</h5>
<div class="ulist">
<ul>
<li>
<p>Regular Expressions are exactly the same as Cucumber Expressions - FALSE</p>
</li>
<li>
<p>In modern versions of SpecFlow steps can be defined using Cucumber Expressions but this feature has to be enabled first - TRUE</p>
</li>
<li>
<p>Cucumber Expressions are more intimidating than Regular Expressions - FALSE</p>
</li>
<li>
<p>Regular expressions can still be used even in modern versions of SpecFlow even if Cucumber Expressions are enabled - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Regular Expressions are a powerful tool that have been in use in computer science for many decades. They can be hard understand and maintain, so the Cucumber team created a simplified mechanism, called Cucumber Expressions that is now also available for SpecFlow. SpecFlow remains backwards compatible, so you can use both Regular Expressions and Cucumber Expressions with modern releases of SpecFlow.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_literal_expressions">3.2. Literal expressions</h3>
<div class="paragraph">
<p>Let&#8217;s look at the Shouty scenario from the last chapter. <a href="#shot-1669" id="shot-1669" title="initial zoom 150%" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: initial zoom 150%</a></p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout

<span class="kn">Scenario</span><span class="p">:</span> Listener is within range
	<span class="nf">Given </span>Lucy is located 15 metres from Sean
	<span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>As SpecFlow starts to execute this feature, it will come to the first step of the scenario <code>Given Lucy is located 15 metres from Sean</code> <a href="#shot-1670" id="shot-1670" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2</a> and say to itself "now - do I have any step definitions that match the phrase <code>Lucy is located 15 metres from Sean</code>?"</p>
</div>
<div class="paragraph">
<p><a href="#shot-1671" id="shot-1671" title="new text file, zoom 200%, full screen, make text left aligned in line 7" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: new text file, zoom 200%, full screen, make text left aligned in line 7</a>
The most simple cucumber expression that would match that step is this one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Lucy is located 15 metres from Sean</pre>
</div>
</div>
<div class="paragraph">
<p>That’s pretty simple isn&#8217;t it? Cucumber expressions are just string patterns, and the most simple pattern you can use is a perfect match.</p>
</div>
<div class="paragraph">
<p>In C#, we can use this pattern to make a step definition like this: <a href="#shot-1672" id="shot-1672" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is located 15 metres from Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsLocatedMetresFromSean</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">(</span><span class="s">"Matched!"</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We use a normal C# string to pass the cucumber expression to SpecFlow.</p>
</div>
<div class="sect3">
<h4 id="_lesson_2_questions_2">3.2.1. Lesson 2 - Questions</h4>
<div class="sect4">
<h5 id="_which_of_the_following_cucumber_expressions_will_match_the_step_given_lucy_is_15_metres_from_sean">Which of the following Cucumber Expressions will match the step "Given Lucy is 15 metres from Sean"?</h5>
<div class="ulist">
<ul>
<li>
<p>"lucy is 15 metres from sean" - FALSE</p>
</li>
<li>
<p>"Given Lucy is 15 metres from Sean" - FALSE</p>
</li>
<li>
<p>"Lucy is 15 metres from Sean" - TRUE</p>
</li>
<li>
<p>"Lucy is 15 metres from Sean Smith" - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Cucumber Expressions look for a match of the whole step text EXCLUDING the Gherkin keyword (Given/When/Then/And/But). The match is case sensitive and matches whitespace as well.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_capturing_parameters">3.3. Capturing parameters</h3>
<div class="paragraph">
<p><a href="#shot-1673" id="shot-1673" title="initial zoom 120%" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: initial zoom 120%</a>
Sometimes, we want to write step definitions that allow us to use different values in our Gherkin scenarios. For example, we might want to have other scenarios that place Lucy a different distance away from Sean. <a href="#shot-1674" id="shot-1674" title="change 15 to 100" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: change 15 to 100</a></p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout

<span class="kn">Scenario</span><span class="p">:</span> Listener is within range
	<span class="nf">Given </span>Lucy is located 100 metres from Sean
	<span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>To capture interesting values from our step definitions, we can use a feature of Cucumber Expressions called <em>parameters</em>.</p>
</div>
<div class="paragraph">
<p>For example, to capture the number of metres, we can use the <code>{int}</code> parameter: <a href="#shot-1675" id="shot-1675" title="change 15 to {int}" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: change 15 to {int}</a> which is passed as an argument to our step definition: <a href="#shot-1676" id="shot-1676" title="add parameter" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: add parameter</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is located {int} metres from Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsLocatedMetresFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we’re capturing that value as an argument. The value <code>100</code> will be passed to our code automatically by SpecFlow.</p>
</div>
<div class="paragraph">
<p>Because we&#8217;ve used Cucumber Expressions' built-in <code>{int}</code> parameter type, the value has been cast to a <code>int</code> data type for us automatically, so we can do maths with it if we want.<a href="#shot-1677" id="shot-1677" title="add text with calculation" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: add text with calculation</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is located {int} metres from Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsLocatedMetresFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">(</span><span class="s">$"Lucy is </span><span class="p">{</span><span class="n">distance</span> <span class="p">*</span> <span class="m">100</span><span class="p">}</span><span class="s"> centimetres from Sean"</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Cucumber Expressions have a bunch of built-in parameter types: <code>{int}</code>, <code>{float}</code>, <code>{word}</code> and <code>{string}</code>. You can also define your own, as we&#8217;ll see later.</p>
</div>
<div class="sect3">
<h4 id="_lesson_3_ruby_java_js">3.3.1. Lesson 3 )Ruby, Java, JS)</h4>
<div class="sect4">
<h5 id="_which_of_the_following_is_not_a_built_in_cucumber_expression_parameter_type">Which of the following is NOT a built in Cucumber Expression parameter type?</h5>
<div class="ulist">
<ul>
<li>
<p>float - FALSE</p>
</li>
<li>
<p>integer - TRUE</p>
</li>
<li>
<p>string - FALSE</p>
</li>
<li>
<p>word - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The Cucumber Expression parameter type that matches an integer is <code>{int}</code>, not <code>{integer}</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_the_following_statements_is_true">Which of the following statements is true?</h5>
<div class="ulist">
<ul>
<li>
<p>You cannot create your own Cucumber Expression parameter types - FALSE</p>
</li>
<li>
<p>Cucumber discards the value that matches a Cucumber Expression parameter type - FALSE</p>
</li>
<li>
<p>Your step definition code will be passed the value that matched the Cucumber Expression parameter type - TRUE</p>
</li>
<li>
<p>Cucumber always passes the matched parameter as a string - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Cucumber will pass the step definition a parameter for each Cucumber Expression parameter type. Cucumber will attempt to convert the text that matched into a suitable format. Using the <code>{int}</code> parameter type will result in a number being passed to the step definition. You can extend the predefined Cucumber Expression parameter types, by creating your own.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lesson_3_questions_specflowcdotnet">3.3.2. Lesson 3 - Questions (SpecFlow/C#/Dotnet)</h4>
<div class="sect4">
<h5 id="_which_of_the_following_is_not_a_built_in_cucumber_expression_parameter_type_2">Which of the following is NOT a built in Cucumber Expression parameter type?</h5>
<div class="ulist">
<ul>
<li>
<p>float - FALSE</p>
</li>
<li>
<p>integer - TRUE</p>
</li>
<li>
<p>string - FALSE</p>
</li>
<li>
<p>word - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The Cucumber Expression parameter type that matches an integer is <code>{int}</code>, not <code>{integer}</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_the_following_statements_is_true_2">Which of the following statements is true?</h5>
<div class="ulist">
<ul>
<li>
<p>You cannot create your own Cucumber Expression parameter types - FALSE</p>
</li>
<li>
<p>Cucumber discards the value that matches a Cucumber Expression parameter type - FALSE</p>
</li>
<li>
<p>Your step definition code will be passed the value that matched the Cucumber Expression parameter type - TRUE</p>
</li>
<li>
<p>SpecFlow always passes the matched parameter as a string - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: SpecFlow will pass the step definition a parameter for each Cucumber Expression parameter type. SpecFlow will attempt to convert the text that matched into a suitable format. Using the <code>{int}</code> parameter type will result in a number being passed to the step definition. You can extend the predefined Cucumber Expression parameter types, by creating your own.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_flexibility">3.4. Flexibility</h3>
<div class="paragraph">
<p>Although it&#8217;s important to try to use consistent terminology in our Gherkin scenarios to help develop the ubiquitous language of your domain, we also want scenarios to read naturally, which sometimes means allowing a bit of flexibility.</p>
</div>
<div class="paragraph">
<p>Ideally, the language used in scenarios should never be constrained by your step definitions. Otherwise they&#8217;ll end up sounding like they were written by robots. Or worse, they read like code.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1678" id="shot-1678" title="initial zoom 120%, change step text" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: initial zoom 120%, change step text</a>
One common example is the problem of plurals. Suppose we want to place Lucy and Sean just 1 metre apart:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">	<span class="nf">Given </span>Lucy is located 1 metre from Sean</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1679" id="shot-1679" title="select metre" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: select metre</a>
Because we’ve used the singular <code>metre</code> instead of the plural <code>metres</code> we don&#8217;t get a match as you can see from the different step color:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">	<span class="nf">Given </span>Lucy is located 1 metre from Sean</code></pre>
</div>
</div>
<div class="paragraph">
<p>What a pain!</p>
</div>
<div class="paragraph">
<p>Fear not. <a href="#shot-1680" id="shot-1680" title="change expression in step def" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: change expression in step def</a> We can just surround the <code>s</code> in parentheses to make it optional, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is located {int} metre(s) from Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsLocatedMetresFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1681" id="shot-1681" title="build and show scenario step color changing" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: build and show scenario step color changing</a>
We build the project and now our step matches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">	<span class="nf">Given </span>Lucy is located 1 metre from Sean</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is one way to smooth off some of the rough edges in your cucumber expressions, and allow your scenarios to be as expressive as possible.</p>
</div>
<div class="paragraph">
<p>Another is to allow <em>alternates</em> - different ways of saying the same thing. For example, to accept this step: <a href="#shot-1682" id="shot-1682" title="change located to standing" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: change located to standing</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">	<span class="nf">Given </span>Lucy is standing 1 metre from Sean</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;we can use this Cucumber Expression: <a href="#shot-1683" id="shot-1683" title="change step def" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: change step def</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is located/standing {int} metre(s) from Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsLocatedMetresFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1684" id="shot-1684" title="build and show 'go to definition'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: build and show 'go to definition'</a>
Now we can use either 'standing' or 'located' in our scenarios, and both will match just fine as you can see&#8230;&#8203;</p>
</div>
<div class="sect3">
<h4 id="_lesson_4">3.4.1. Lesson 4</h4>
<div class="sect4">
<h5 id="_how_can_you_express_in_a_cucumber_expression_that_matching_some_text_is_optional">How can you express in a Cucumber Expression that matching some text is optional?</h5>
<div class="ulist">
<ul>
<li>
<p>Enclose it in square brackets: [] - FALSE</p>
</li>
<li>
<p>Enclose it in parentheses: () - TRUE</p>
</li>
<li>
<p>Place a question mark after it: ? - FALSE</p>
</li>
<li>
<p>Precede it with a slash: / - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Any text in a Cucumber Expression that is surrounded by parentheses <code>()</code> is considered optional.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_does_a_slash_separating_words_mean_in_a_cucumber_expression">What does a slash <code>/</code> separating words mean in a Cucumber Expression?</h5>
<div class="ulist">
<ul>
<li>
<p>The words are considered alternatives - the Cucumber Expression will match any of them - TRUE</p>
</li>
<li>
<p>It doesn&#8217;t mean anything special - the Cucumber Expression will match the slash as a literal character- FALSE</p>
</li>
<li>
<p>The word that follows the slash is considered optional - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Words in a Cucumber Expression that are separated by a slash <code>/</code> are considered alternates. There must be no whitespace between the word and the slash.</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_the_following_cucumber_expressions_would_match_both_it_weighed_3_grammes_and_it_weighed_1_gramme">Which of the following Cucumber Expressions would match both "it weighed 3 grammes" and "it weighed 1 gramme"?</h5>
<div class="ulist">
<ul>
<li>
<p>"it weighed {int} gramme(s)" - TRUE</p>
</li>
<li>
<p>"it weighed 1/3 gramme/s" - FALSE</p>
</li>
<li>
<p>"it weighed 1/3 gramme(s)" - TRUE</p>
</li>
<li>
<p>"it weighed 1 / 3 gramme(s)" - FALSE</p>
</li>
<li>
<p>"it weighed 1/2/3 gramme/grammes" - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Any text surrounded by parentheses <code>()</code> is considered optional. Any words separated by a slash <code>/</code> are considered to be alternates. You can find full documentation about Cucumber Expressions at <a href="https://cucumber.io/docs/cucumber/cucumber-expressions/" class="bare">https://cucumber.io/docs/cucumber/cucumber-expressions/</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_parameters">3.5. Custom parameters</h3>
<div class="paragraph">
<p>Although you can get a long way with Cucumber Expressions' built-in parameter types, you get real power when you define your own <em>custom parameter types</em>. This allows you to transform the text captured from the Gherkin into any object you like before it&#8217;s passed into your step definition.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s define our own <code>{person}</code> custom parameter type that will convert the string <code>Lucy</code> into an instance of <code>Person</code> automatically.</p>
</div>
<div class="paragraph">
<p>We can start with the step definition, which would look something like this:  <a href="#shot-1685" id="shot-1685" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"{Person} is located/standing {int} metre(s) from Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenPersonIsLocatedMetresFromSean</span><span class="p">(</span><span class="n">Person</span> <span class="n">person</span><span class="p">,</span> <span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">person</span><span class="p">.</span><span class="nf">MoveTo</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we build or run the tests at this point we&#8217;ll see an error, because we haven&#8217;t defined the <code>{Person}</code> parameter type yet. <a href="#shot-1686" id="shot-1686" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Undefined parameter type: 'Person'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here&#8217;s how we define one.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create a new class called <code>ParameterTypes</code> in the <code>Support</code> folder: <a href="#shot-1687" id="shot-1687" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3</a></p>
</div>
<div class="paragraph">
<p>We&#8217;re going to create a method, which takes the name of a person as a string, and returns an instance of our <code>Person</code> class with that name. <a href="#shot-1688" id="shot-1688" title="Create bare method" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: Create bare method</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="k">public</span> <span class="n">Person</span> <span class="nf">ConvertPerson</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>SpecFlow will use the name of the return type - <code>Person</code> - as the parameter name we use inside the curly brackets in our step definition expressions, as soon as we&#8217;ve wired it up.</p>
</div>
<div class="paragraph">
<p>To do that, we add the <code>StepArgumentTransformation</code> attribute <a href="#shot-1689" id="shot-1689" title="Add empty StepArgumentTransformation attribute to method" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: Add empty StepArgumentTransformation attribute to method</a>, that is from the SpecFlow namespace&#8230;&#8203; <a href="#shot-1690" id="shot-1690" title="Add using" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6.1: Add using</a>. We also need to add a <code>Binding</code> attribute to the class <a href="#shot-1691" id="shot-1691" title="Add Binding" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6.2: Add Binding</a>, otherwise SpecFlow will not find our conversion method.</p>
</div>
<div class="paragraph">
<p>By default, any name is recognized as a person, but we could restrict it to a specific names using - gasp! - a regular expression. <a href="#shot-1692" id="shot-1692" title="add regex filter '(Lucy|Sean)'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7.1: add regex filter '(Lucy|Sean)'</a></p>
</div>
<div class="paragraph">
<p>This is not what we want in this project now, so let&#8217;s leave it as it was. <a href="#shot-1693" id="shot-1693" title="remove filter" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7.2: remove filter</a> You can find more examples about using <code>StepArgumentTransformation</code> in the <a href="https://docs.specflow.org/projects/specflow/en/latest/Bindings/Step-Argument-Conversions.html#step-argument-transformation">SpecFlow documentation</a>.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1694" id="shot-1694" title="Set a breakpoint to step definition; debug; show person details; stop debugger" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: Set a breakpoint to step definition; debug; show person details; stop debugger</a>
All of this means that when we run our step, we&#8217;ll be passed an instance of <code>Person</code> into our step definition automatically.</p>
</div>
<div class="paragraph">
<p>Custom parameters allow you to bring your domain <em>model</em> - the names of the classes and objects in your solution - and your domain <em>language</em> - the words you use in your scenarios and step definitions - closer together.</p>
</div>
<div class="sect3">
<h4 id="_lesson_5_questions_java">3.5.1. Lesson 5 - Questions (Java)</h4>
<div class="sect4">
<h5 id="_what_role_do_regular_expressions_play_in_cucumber_expressions">What role do Regular Expressions play in Cucumber Expressions?</h5>
<div class="ulist">
<ul>
<li>
<p>None</p>
</li>
<li>
<p>Cucumber Expressions provide a subset of Regular Expression syntax</p>
</li>
<li>
<p>Cucumber Expressions are exactly the same as Regular Expressions</p>
</li>
<li>
<p>A Regular Expression is used to define the text to be matched when using a custom Parameter Type - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: We use a Regular Expression to specify the text that should be matched when a custom Parameter Type is used in a Cucumber Expression.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_would_you_use_the_custom_parameter_type_defined_by_the_following_code">How would you use the custom Parameter Type defined by the following code?</h5>
<div class="paragraph">
<p>@ParameterType("activated")
public Status state(String activationState) {
    return new Status(activationState);
}</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{activated}</p>
</li>
<li>
<p>{activationState}</p>
</li>
<li>
<p>{state} - TRUE</p>
</li>
<li>
<p>{Status}</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The name of a custom Parameter Type is defined by the name of the method that is decorated with the <code>@ParameterType</code> annotation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lesson_5_questions_javascript">3.5.2. Lesson 5 - Questions (Javascript)</h4>
<div class="sect4">
<h5 id="_what_role_do_regular_expressions_play_in_cucumber_expressions_2">What role do Regular Expressions play in Cucumber Expressions?</h5>
<div class="ulist">
<ul>
<li>
<p>None</p>
</li>
<li>
<p>Cucumber Expressions provide a subset of Regular Expression syntax</p>
</li>
<li>
<p>Cucumber Expressions are exactly the same as Regular Expressions</p>
</li>
<li>
<p>A Regular Expression is used to define the text to be matched when using a custom Parameter Type - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: We use a Regular Expression to specify the text that should be matched when a custom Parameter Type is used in a Cucumber Expression.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_would_you_use_the_custom_parameter_type_defined_by_the_following_code_2">How would you use the custom Parameter Type defined by the following code?</h5>
<div class="paragraph">
<p>defineParameterType({
  name: 'state',
  regexp: /activated/,
  transformer: activationState &#8658; new Status(activationState)
})</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{activated}</p>
</li>
<li>
<p>{activationState}</p>
</li>
<li>
<p>{state} - TRUE</p>
</li>
<li>
<p>{Status}</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The name of a custom Parameter Type is defined by the <code>name</code> parameter passed to the <code>defineParameterType</code> method.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lesson_5_questions_ruby">3.5.3. Lesson 5 - Questions (Ruby)</h4>
<div class="sect4">
<h5 id="_what_role_do_regular_expressions_play_in_cucumber_expressions_3">What role do Regular Expressions play in Cucumber Expressions?</h5>
<div class="ulist">
<ul>
<li>
<p>None</p>
</li>
<li>
<p>Cucumber Expressions provide a subset of Regular Expression syntax</p>
</li>
<li>
<p>Cucumber Expressions are exactly the same as Regular Expressions</p>
</li>
<li>
<p>A Regular Expression is used to define the text to be matched when using a custom Parameter Type - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: We use a Regular Expression to specify the text that should be matched when a custom Parameter Type is used in a Cucumber Expression.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_would_you_use_the_custom_parameter_type_defined_by_the_following_code_3">How would you use the custom Parameter Type defined by the following code?</h5>
<div class="paragraph">
<p>ParameterType(
  name:        'state',
  regexp:      /activated/,
  transformer: &#8594; (activationState) { Status.new(activationState) }
)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{activated}</p>
</li>
<li>
<p>{activationState}</p>
</li>
<li>
<p>{state} - TRUE</p>
</li>
<li>
<p>{Status}</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The name of a custom Parameter Type is defined by the <code>name</code> parameter passed to the <code>ParameterType</code> method.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lesson_5_questions_specflowcdotnet">3.5.4. Lesson 5 - Questions (SpecFlow/C#/Dotnet)</h4>
<div class="sect4">
<h5 id="_what_role_do_regular_expressions_play_in_cucumber_expressions_4">What role do Regular Expressions play in Cucumber Expressions?</h5>
<div class="ulist">
<ul>
<li>
<p>None</p>
</li>
<li>
<p>Cucumber Expressions provide a subset of Regular Expression syntax</p>
</li>
<li>
<p>Cucumber Expressions are exactly the same as Regular Expressions</p>
</li>
<li>
<p>A Regular Expression is used to restrict the text to be matched when using a custom parameter type (StepArgumentTransformation) - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: We use a Regular Expression to restrict the text that should be matched when a custom parameter type (StepArgumentTransformation) is used in a Cucumber Expression. You can find more examples of how to use <code>StepArgumentTransformation</code> in the <a href="https://docs.specflow.org/projects/specflow/en/latest/Bindings/Step-Argument-Conversions.html#step-argument-transformation">SpecFlow documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_would_you_use_the_custom_parameter_type_defined_by_the_following_code_4">How would you use the custom Parameter Type defined by the following code?</h5>
<div class="paragraph">
<p>public Status ConvertState(string activationState)
{
return new Status(activationState);
}</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{activated} or {deactivated}</p>
</li>
<li>
<p>{activationState}</p>
</li>
<li>
<p>{Status} - TRUE</p>
</li>
<li>
<p>{ConvertState}</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The name of a custom Parameter Type is defined by the name of the return type in the method that is decorated with the <code>[StepArgumentTransformation]</code> annotation.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cleaning_up">4. Cleaning up</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_the_importance_of_readability">4.1. The importance of readability</h3>
<div class="videoblock">
<div class="content">
<video src="https://drive.google.com/uc?id=1arEP_-0Fi5CK7EC8IYCJWrc67I_XF34Z" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1695" id="shot-1695" title="04.01.animation.mp4" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 0.1: 04.01.animation.mp4</a></p>
</div>
<div class="paragraph">
<p>In the previous chapter, we talked about the importance of having readable scenarios, and you learned some new skills with Cucumber Expressions to help you achieve that goal. Those skills will give you the confidence to write scenarios exactly the way you want, knowing you’ll be able to match the Gherkin steps easily from your step definition code.</p>
</div>
<div class="paragraph">
<p>We emphasise readability because from our experience, writing Gherkin scenarios is a software design activity. Cucumber was created to bridge the communication gap between business domain experts and development teams. When you collaborate with domain experts to describe behaviour in Gherkin, you’re expressing the group’s shared understanding of the problem you need to solve. The words you use in your scenarios can have a deep impact on the way the software is designed, as we’ll see in later chapters.</p>
</div>
<div class="paragraph">
<p>The more fluent you become in writing Gherkin, the more useful a tool it becomes to help you facilitate this communication. Keeping your scenarios readable means you can get feedback at any time about whether you’re building the right thing. Over time, your features become living documentation about your system. We can’t emphasize enough how important it is to see your scenarios as more than just tests.</p>
</div>
<div class="paragraph">
<p>Maintaining a living document works both ways: the scenarios will guide your solution design, but you may also have to update your Gherkin to reflect the things you learn as you build the solution. This dance back and forth between features and solution code is an important part of BDD.</p>
</div>
<div class="paragraph">
<p>In this chapter, we’ll learn about feature descriptions, the Background keyword, and about keeping scenarios and code up-to-date with your current understanding of the project.</p>
</div>
<div class="paragraph">
<p>First, let’s catch up with what’s been happening on the Shouty project.</p>
</div>
<div class="sect3">
<h4 id="_continuity_annoucement">4.1.1. Continuity Annoucement</h4>
<div class="paragraph">
<p>Before we start, I need to explain about a continuity error between the previous chapter and this next one.</p>
</div>
<div class="paragraph">
<p>In the last chapter we showed you how to use <em>parameter types</em> to automatically create an instance of our <code>Person</code> class whenever we used it in a step defintion.</p>
</div>
<div class="paragraph">
<p>Now the first version of video series was first created many years ago, before we had added parameter types to Cucumber. Although we updated the previous chapter to demonstrate parameter types to you, we haven&#8217;t yet updated this one. So you&#8217;ll notice as you follow along here that there&#8217;s no mention of parameter types anymore.</p>
</div>
<div class="paragraph">
<p>Some of the things we&#8217;ll be doing to clean up the code in this chapter would be even cleaner if we used parameter types, and we hope to update this video someday to incorporate them into the story. In the meantime we&#8217;ll leave it as an exercise for you to think about how you would change the work we do in this episode to make the most of them.</p>
</div>
<div class="paragraph">
<p>Have fun, and don&#8217;t forget to come on <a href="https://cucumberbdd.slack.com/archives/C9C3FSGRE">the #school community Slack channel</a> to ask if you need any guidance!</p>
</div>
</div>
<div class="sect3">
<h4 id="_lesson_1_questions_ruby_java_js_2">4.1.2. Lesson 1 - Questions (Ruby, Java, JS)</h4>
<div class="sect4">
<h5 id="_which_aspects_of_cucumber_help_bridge_the_communication_gap_between_business_domain_experts_and_development_teams">Which aspects of Cucumber help bridge the communication gap between business domain experts and development teams?</h5>
<div class="ulist">
<ul>
<li>
<p>The readability of Gherkin scenarios - TRUE</p>
</li>
<li>
<p>Cucumber&#8217;s availability for different programming languages - FALSE</p>
</li>
<li>
<p>Being able to express scenarios using your own domain language - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The feature files that Cucumber understands are written using Gherkin, so that you can create scenarios that utilise your own domain language, so that they can be read and understood by everyone involved in specifying and delivering your software.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_do_cucumber_feature_files_differ_from_more_traditional_automated_tests">How do Cucumber feature files differ from more traditional automated tests?</h5>
<div class="ulist">
<ul>
<li>
<p>The purpose of feature files is to create readable specifications that can be understood by the whole team, not to provide test coverage</p>
</li>
<li>
<p>Business-readable specifications make it easier to obtain feedback about what you&#8217;re building while you&#8217;re building it, rather than waiting for a later test cycle</p>
</li>
<li>
<p>Feature files become "living documentation" when they are automated, providing a single source of truth for the whole team</p>
</li>
<li>
<p>Feature files should be written collaboratively by business and delivery, not in isolation by testers</p>
</li>
<li>
<p>There is no difference - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: BDD is the collaborative approach to developing software that Cucumber was created to support. Although Cucumber scenarios do act as tests when they are automated, this is not their primary purpose. Their primary purpose is to provide a single, shared specification, written in the domain language of your business&#8201;&#8212;&#8201;facilitating collaboration, feedback, and
reliable documentation. The primary purpose of traditional automated tests, on the other hand, is to check that the software behaves as expected.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lesson_1_questions_specflowcdotnet_2">4.1.3. Lesson 1 - Questions (SpecFlow/C#/Dotnet)</h4>
<div class="sect4">
<h5 id="_which_aspects_of_specflow_help_bridge_the_communication_gap_between_business_domain_experts_and_development_teams">Which aspects of SpecFlow help bridge the communication gap between business domain experts and development teams?</h5>
<div class="ulist">
<ul>
<li>
<p>The readability of Gherkin scenarios - TRUE</p>
</li>
<li>
<p>Gherkin scenarios can be automated in different programming languages - FALSE</p>
</li>
<li>
<p>Being able to express scenarios using your own domain language - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The feature files that SpecFlow understands are written using Gherkin, so that you can create scenarios that utilise your own domain language, so that they can be read and understood by everyone involved in specifying and delivering your software.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_do_specflow_feature_files_differ_from_more_traditional_automated_tests">How do SpecFlow feature files differ from more traditional automated tests?</h5>
<div class="ulist">
<ul>
<li>
<p>The purpose of feature files is to create readable specifications that can be understood by the whole team, not to provide test coverage</p>
</li>
<li>
<p>Business-readable specifications make it easier to obtain feedback about what you&#8217;re building while you&#8217;re building it, rather than waiting for a later test cycle</p>
</li>
<li>
<p>Feature files become "living documentation" when they are automated, providing a single source of truth for the whole team</p>
</li>
<li>
<p>Feature files should be written collaboratively by business and delivery, not in isolation by testers</p>
</li>
<li>
<p>There is no difference - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: BDD is the collaborative approach to developing software that SpecFlow was created to support. Although SpecFlow scenarios do act as tests when they are automated, this is not their primary purpose. Their primary purpose is to provide a single, shared specification, written in the domain language of your business&#8201;&#8212;&#8201;facilitating collaboration, feedback, and
reliable documentation. The primary purpose of traditional automated tests, on the other hand, is to check that the software behaves as expected.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_review_changes_that_happened_while_we_were_away">4.2. Review changes that happened while we were away</h3>
<div class="paragraph">
<p>While we were away, the developers of Shouty have been busy working on the code. Let’s have a look at what they’ve been up to.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1696" id="shot-1696" title="feature file open, run Specs tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: feature file open, run Specs tests</a>
We’ll start out by running our scenarios.</p>
</div>
<div class="paragraph">
<p>Great! It looks like both these scenarios are working now - both the different messages that Sean shouts are being heard by Lucy.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1697" id="shot-1697" title="open stepdef file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: open stepdef file</a>
Let’s dig into the code and see how these steps have been automated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">    <span class="p">[</span><span class="n">Binding</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">StepDefinitions</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">Person</span> <span class="n">lucy</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Person</span> <span class="n">sean</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">messageFromSean</span><span class="p">;</span>

        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is {int} metres from Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsMetresFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">network</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Network</span><span class="p">();</span>
            <span class="n">sean</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
            <span class="n">lucy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
            <span class="n">lucy</span><span class="p">.</span><span class="nf">MoveTo</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts {string}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShouts</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">sean</span><span class="p">.</span><span class="nf">Shout</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
            <span class="n">messageFromSean</span> <span class="p">=</span> <span class="n">message</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucy should hear Sean's message"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyShouldHearSeansMessage</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">messageFromSean</span><span class="p">,</span> <span class="n">lucy</span><span class="p">.</span><span class="nf">GetMessagesHeard</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the step definition layer, we can see that a new class has been defined, the Network.<a href="#shot-1698" id="shot-1698" title="creating instance of Network" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: creating instance of Network</a> We’re creating an instance of the network here. Then we pass that network instance to each of the Person instances we create here.<a href="#shot-1699" id="shot-1699" title="create instances of Person" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: create instances of Person</a> So both instances of Person depend on the same instance of network. The Network is what allows people to send messages to one another.</p>
</div>
<div class="paragraph">
<p>There are also a couple of new unit test classes in the Shouty solution, one for the Network class,<a href="#shot-1700" id="shot-1700" title="show existence of NetworkTests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: show existence of NetworkTests</a> and another one for the Person class.<a href="#shot-1701" id="shot-1701" title="show existence of PersonTests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: show existence of PersonTests</a></p>
</div>
<div class="paragraph">
<p>Unit tests are fine-grained tests that define the precise behaviour of each of those classes. We’ll talk more about this in a future lesson, but feel free to have a poke around in there in the meantime.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1702" id="shot-1702" title="run all tests &amp; show output that demonstrates the unit tests are passing" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: run all tests &amp; show output that demonstrates the unit tests are passing</a>
The <strong>Run All Tests</strong> command will run those unit tests as well as the SpecFlow scenarios.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1703" id="shot-1703" title="open the feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: open the feature file</a></p>
</div>
<div class="paragraph">
<p>The first thing I notice coming back to the code is that the feature file is still talking about the distance between Lucy and Sean,<a href="#shot-1704" id="shot-1704" title="focus on given step" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: focus on given step</a> but we haven’t actually implemented any behaviour around that yet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout

<span class="kn">Scenario</span><span class="p">:</span> Listener is within range
	<span class="nf">Given </span>Lucy is 15 metres from Sean
	<span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message

<span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
	<span class="nf">Given </span>Lucy is 15 metres from Sean
	<span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>This happens to us all the time - we have an idea for a new feature, but then we find the problem is too complex to solve all at once, so we break it down into simpler steps. If we’re not careful, little bits of that original idea can be left around like clutter, in the scenarios and in the code. That clutter can get in the way, especially if plans change.</p>
</div>
<div class="paragraph">
<p>We’re definitely going to develop this behaviour, but we’ve decided to defer it to our next iteration. Our current solution is just focussed on broadcasting messages between the people on the network.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s clean up the feature to reflect that current understanding.</p>
</div>
<div class="sect3">
<h4 id="_lesson_2_questions_ruby_java_js">4.2.1. Lesson 2 - Questions (Ruby, Java, JS)</h4>
<div class="sect4">
<h5 id="_why_have_the_shouty_developers_created_unit_tests_for_the_person_and_network_classes">Why have the Shouty developers created unit tests for the Person and Network classes?</h5>
<div class="ulist">
<ul>
<li>
<p>They don&#8217;t understand how to do BDD - FALSE</p>
</li>
<li>
<p>Unit tests are fine-grained tests that define the precise behaviour of each of those classes - TRUE</p>
</li>
<li>
<p>Unit tests run faster than Cucumber scenarios - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Unit tests (also known as programmer tests) are used to define precise behaviour of units of code that may not be interesting to the business&#8201;&#8212;&#8201;and so should not be written in a feature file. Writing unit tests is entirely compatible with BDD.</p>
</div>
<div class="paragraph">
<p>There is no reason for Cucumber scenarios to run significantly slower than unit tests. The Shouty step definitions that we&#8217;ve seen so far interact directly with the domain layer and run extremely fast.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_is_the_distance_between_sean_and_lucy_not_being_used_by_shouty">Why is the distance between Sean and Lucy not being used by Shouty?</h5>
<div class="ulist">
<ul>
<li>
<p>The team has decided to defer implementing range functionality until a later iteration - TRUE</p>
</li>
<li>
<p>The developers have misunderstood the specification</p>
</li>
<li>
<p>The specification has changed since the scenarios were written</p>
</li>
<li>
<p>The distance between Sean and Lucy is being used to decide if the shout is "in range"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Teams often find that the problem is too big to solve all at once, so we split it into thinner slices. Working in smaller steps is a faster, safer way of delivering software. In this case the team has decided that broadcasting messages and calculating if a person is in-range are different problems that they will address separately.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lesson_2_questions_specflow">4.2.2. Lesson 2 - Questions (SpecFlow)</h4>
<div class="sect4">
<h5 id="_why_have_the_shouty_developers_created_unit_tests_for_the_person_and_network_classes_2">Why have the Shouty developers created unit tests for the Person and Network classes?</h5>
<div class="ulist">
<ul>
<li>
<p>They don&#8217;t understand how to do BDD - FALSE</p>
</li>
<li>
<p>Unit tests are fine-grained tests that define the precise behaviour of each of those classes - TRUE</p>
</li>
<li>
<p>Unit tests run faster than Cucumber scenarios - FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Unit tests (also known as programmer tests) are used to define precise behaviour of units of code that may not be interesting to the business&#8201;&#8212;&#8201;and so should not be written in a feature file. Writing unit tests is entirely compatible with BDD.</p>
</div>
<div class="paragraph">
<p>There is no reason for SpecFlow scenarios to run significantly slower than unit tests. The Shouty step definitions that we&#8217;ve seen so far interact directly with the domain layer and run extremely fast.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_is_the_distance_between_sean_and_lucy_not_being_used_by_shouty_2">Why is the distance between Sean and Lucy not being used by Shouty?</h5>
<div class="ulist">
<ul>
<li>
<p>The team has decided to defer implementing range functionality until a later iteration - TRUE</p>
</li>
<li>
<p>The developers have misunderstood the specification</p>
</li>
<li>
<p>The specification has changed since the scenarios were written</p>
</li>
<li>
<p>The distance between Sean and Lucy is being used to decide if the shout is "in range"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Teams often find that the problem is too big to solve all at once, so we split it into thinner slices. Working in smaller steps is a faster, safer way of delivering software. In this case the team has decided that broadcasting messages and calculating if a person is in-range are different problems that they will address separately.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_description_field">4.3. Description field</h3>
<div class="paragraph">
<p>After the feature keyword, we have space in a Gherkin document to write any arbitrary text that we like.<a href="#shot-1705" id="shot-1705" title="feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: feature file</a> We call this the feature’s <em>description</em>. This is a great place to write up any notes or other details that can’t easily be expressed in examples. You might have links to wiki pages or issue trackers, or to wireframes. You can put anything you like in here, as long as you don’t start a line with a Gherkin keyword, like &#8220;Rule:&#8221; or &#8220;Scenario:&#8221;.</p>
</div>
<div class="paragraph">
<p>In this case, we can add a high level description of the Shouty application.<a href="#shot-1706" id="shot-1706" title="add description" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: add description</a> Because Shouty doesn&#8217;t yet filter by proximity, we can also write a todo list here so it’s clear that we do intend to get to that soon.<a href="#shot-1707" id="shot-1707" title="add todo list" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: add todo list</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout

Shouty allows users to "hear" other users "shouts" as long as they are close enough to each other.

<span class="err">To do</span><span class="p">:</span>
<span class="err">-</span> <span class="err">only</span> <span class="err">shout</span> <span class="err">to</span> <span class="err">people</span> <span class="err">within</span> <span class="nf">a </span>certain distance</code></pre>
</div>
</div>
<div class="paragraph">
<p>Changing the description doesn’t change anything about how SpecFlow will run this feature. It just helps the human beings reading this document to understand more about the system you’re building.</p>
</div>
<div class="paragraph">
<p>Our two scenarios are examples of how Shouty can broadcast a shout to other users. This is one of the main business rules, which we can document using the Rule keyword.<a href="#shot-1708" id="shot-1708" title="add Rule keyword" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: add Rule keyword</a> We&#8217;ll learn more about this in a later chapter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="err">Rule</span><span class="p">:</span> <span class="err">Shouts</span> <span class="err">c</span><span class="nf">an </span>be heard by other users

<span class="kn">Scenario</span><span class="p">:</span> Listener is within range
	<span class="nf">Given </span>Lucy is 15 metres from Sean
	<span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message

<span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
	<span class="nf">Given </span>Lucy is 15 metres from Sean
	<span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1709" id="shot-1709" title="shows 'Lucy is 15 metres from Sean' step definition" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: shows 'Lucy is 15 metres from Sean' step definition</a>
The step “Given Lucy is 15 metres from Sean” is misleading, since the distance between the two people is not yet relevant in our current model.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is {int} metres from Sean"</span><span class="p">)]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The step definition calls the <code>MoveTo</code> method on Person, <a href="#shot-1710" id="shot-1710" title="highlight MoveTo call" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: highlight MoveTo call</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">            <span class="n">lucy</span><span class="p">.</span><span class="nf">MoveTo</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1711" id="shot-1711" title="shows move_to method in Person class" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: shows move_to method in Person class</a>
but the MoveTo method doesn’t actually do anything.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="k">public</span> <span class="k">void</span> <span class="nf">MoveTo</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1712" id="shot-1712" title="open feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: open feature file</a>
Let’s simplify this code to do just what it needs to do right now, and no more. We can start from the scenario by changing this single step to express what’s actually going on.<a href="#shot-1713" id="shot-1713" title="change title, given steps" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: change title, given steps</a> We’ll work on one scenario at a time, and update the other one once we’re happy with this one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener hears a message
	<span class="nf">Given </span>a person named Lucy
	<span class="nf">And </span>a person named Sean
	<span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the scenario names make sense, and we have two steps, each creating a person. Notice we’re starting to reveal some more of our domain language here: we’ve introduced the words <code>Person</code> and <code>name</code>. Person is already a part of our domain language, so it’s nice to have that revealed in the language of the scenario. Name may well become a property of our person soon, so it’s also useful to have that surfaced so we can get feedback about it from the team.</p>
</div>
<div class="paragraph">
<p>One thing we’ve lost by doing this is the idea that, eventually, the two people will need to be close to each other for the message to be transmitted. We definitely wouldn’t remove detail like that without discussing it with the other people who were involved in writing and reviewing this scenario.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1714" id="shot-1714" title="create new Rule and writes out two new empty scenarios for in / out of range" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: create new Rule and writes out two new empty scenarios for in / out of range</a>
In this case, as well as adding it to the TODO list above, we’ve decided to document the range rule, and write a couple of new empty scenarios to remind us to implement that behaviour later.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="err">Rule</span><span class="p">:</span> <span class="err">Shouts</span> <span class="err">should</span> <span class="err">only</span> <span class="err">be</span> <span class="err">heard</span> <span class="err">if</span> <span class="err">listener</span> <span class="err">is</span> <span class="err">within</span> <span class="err">range</span>

<span class="kn">Scenario</span><span class="p">:</span> Listener is within range

<span class="kn">Scenario</span><span class="p">:</span> <span class="err">Listener</span> <span class="err">is</span> <span class="err">out</span> <span class="err">of</span> <span class="err">range</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1715" id="shot-1715" title="invoke 'define steps'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11.1: invoke 'define steps'</a>
Let’s press on. We can invoke the <strong>Define steps&#8230;&#8203;</strong> command to generate new step definition snippets for the new steps. <a href="#shot-1716" id="shot-1716" title="press 'copy to clipboard'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11.2: press 'copy to clipboard'</a> Copy them to clipboard and paste them into our steps file. <a href="#shot-1717" id="shot-1717" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Lucy"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedLucy</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">PendingStepException</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedSean</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">PendingStepException</span><span class="p">();</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the next lesson we&#8217;ll look at a couple of ways that we can implement these new step definitions.</p>
</div>
<div class="sect3">
<h4 id="_lesson_3_questions">4.3.1. Lesson 3 - Questions</h4>
<div class="sect4">
<h5 id="_what_is_a_feature_file_description">What is a feature file <em>description</em>?</h5>
<div class="ulist">
<ul>
<li>
<p>Any lines of text between the feature name and the first rule or scenario - TRUE</p>
</li>
<li>
<p>A line of text that starts with the <code>#</code> character</p>
</li>
<li>
<p>A block of text introduced by the <code>Description:</code> keyword</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: You can add a free text description of a feature file after the <code>Feature:</code> line that defines the feature&#8217;s name. The description can be any number of lines long. The description continues until the first rule, scenario, or scenario outline is encountered.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_is_the_purpose_of_writing_an_empty_scenario">What is the purpose of writing an empty scenario?</h5>
<div class="ulist">
<ul>
<li>
<p>It is not valid Gherkin syntax to write an empty scenario</p>
</li>
<li>
<p>Empty scenarios act as a reminder that we have more work to do - TRUE</p>
</li>
<li>
<p>Empty scenarios are a way of pretending that we have done more work than we actually have</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Cucumber treats empty scenarios as work that needs to be done and reports them as <em>pending</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_before_hook">4.4. The "Before" hook</h3>
<div class="paragraph">
<p><a href="#shot-1718" id="shot-1718" title="broken implementation" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: broken implementation</a>
We now have two step definitions to implement,<a href="#shot-1719" id="shot-1719" title="highlight network" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: highlight network</a> and that presents us with a bit of a problem. We need the same instance of Network available in both. We could just assume that the Lucy step will always run first and create it there, but that seems fragile.<a href="#shot-1720" id="shot-1720" title="initialize network in first setpdef" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: initialize network in first setpdef</a> If someone wrote a new scenario that didn’t create people in the right order, they’d end up with no Network instance, and weird bugs. We want our steps to be as independent as possible, so they can be easily composed into new scenarios.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Lucy"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedLucy</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">network</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Network</span><span class="p">();</span>
            <span class="n">lucy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedSean</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">sean</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are a couple of different ways to create this network instance in C#. The most straightforward is to use a network field and initialize it in the declaration of the <code>StepDefinitions</code> class.<a href="#shot-1721" id="shot-1721" title="remove create from step, highlight field, initialize it" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: remove create from step, highlight field, initialize it</a> Every time SpecFlow runs a scenario it creates a new instance of this class, so we’ll get a fresh instance of the Network for each scenario.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">    <span class="k">public</span> <span class="k">class</span> <span class="nc">StepDefinitions</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">Person</span> <span class="n">lucy</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Person</span> <span class="n">sean</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">messageFromSean</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Network</span> <span class="n">network</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Network</span><span class="p">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As an alternative, that can be useful if you have more complex setup to do, you can use a hook.</p>
</div>
<div class="paragraph">
<p>We need an instance of Network in every scenario, so we can declare a <code>BeforeScenario</code> Hook that creates one before each scenario starts, like this: <a href="#shot-1722" id="shot-1722" title="add hook" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: add hook</a></p>
</div>
<div class="paragraph">
<p>Now we can use that Network instance as we create Lucy <a href="#shot-1723" id="shot-1723" title="highlight network in first stepdef" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: highlight network in first stepdef</a> and Sean <a href="#shot-1724" id="shot-1724" title="highlight network in second stepdef" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: highlight network in second stepdef</a> in these two new steps.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="n">BeforeScenario</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">CreateNetwork</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">network</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Network</span><span class="p">();</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Lucy"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedLucy</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">lucy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedSean</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">sean</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It should be working again now. Let’s run the tests to check.<a href="#shot-1725" id="shot-1725" title="run all" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: run all</a></p>
</div>
<div class="paragraph">
<p>Good. Let’s do the same with the other scenario. <a href="#shot-1726" id="shot-1726" title="fix givens of other scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: fix givens of other scenario</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
	<span class="nf">Given </span>a person named Lucy
	<span class="nf">And </span>a person named Sean
	<span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1727" id="shot-1727" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: run tests</a></p>
</div>
<div class="paragraph">
<p>Now we can remove this old step definition. <a href="#shot-1728" id="shot-1728" title="open up olf given step definition" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: open up olf given step definition</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"Lucy is {int} metres from Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenLucyIsMetresFromSean</span><span class="p">(</span><span class="kt">int</span> <span class="n">distance</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">network</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Network</span><span class="p">();</span>
            <span class="n">sean</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
            <span class="n">lucy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
            <span class="n">lucy</span><span class="p">.</span><span class="nf">MoveTo</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We know we&#8217;ll need something like this in the future when we implement the proximity rule, but we don&#8217;t want to second-guess what that code will look like, so let&#8217;s clean it out for now.<a href="#shot-1729" id="shot-1729" title="remove step def" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: remove step def</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">TechTalk.SpecFlow</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Xunit</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Shouty.Specs.StepDefinitions</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">Binding</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">StepDefinitions</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">Person</span> <span class="n">lucy</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Person</span> <span class="n">sean</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">messageFromSean</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Network</span> <span class="n">network</span><span class="p">;</span>

        <span class="p">[</span><span class="n">BeforeScenario</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">CreateNetwork</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">network</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Network</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Lucy"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedLucy</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">lucy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Sean"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedSean</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">sean</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts {string}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShouts</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">sean</span><span class="p">.</span><span class="nf">Shout</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
            <span class="n">messageFromSean</span> <span class="p">=</span> <span class="n">message</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucy should hear Sean's message"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyShouldHearSeansMessage</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">messageFromSean</span><span class="p">,</span> <span class="n">lucy</span><span class="p">.</span><span class="nf">GetMessagesHeard</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1730" id="shot-1730" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: run tests</a></p>
</div>
<div class="paragraph">
<p>Now we have one last bit of dead code left, the <code>MoveTo</code> method on Person. <a href="#shot-1731" id="shot-1731" title="Go to MoveTo method" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: Go to MoveTo method</a>
Let&#8217;s clean that up too.<a href="#shot-1732" id="shot-1732" title="delete method" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: delete method</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Shouty</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">Network</span> <span class="n">network</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">messagesHeard</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>

        <span class="k">public</span> <span class="nf">Person</span><span class="p">(</span><span class="n">Network</span> <span class="n">network</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">network</span> <span class="p">=</span> <span class="n">network</span><span class="p">;</span>
            <span class="n">network</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Shout</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">network</span><span class="p">.</span><span class="nf">Broadcast</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">IList</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">GetMessagesHeard</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">messagesHeard</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Hear</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">messagesHeard</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1733" id="shot-1733" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: run tests</a>
And we&#8217;re still green!</p>
</div>
<div class="sect3">
<h4 id="_lesson_4_questions_2">4.4.1. Lesson 4 - Questions</h4>
<div class="sect4">
<h5 id="_when_does_a_beforescenario_hook_run">When does a BeforeScenario hook run?</h5>
<div class="ulist">
<ul>
<li>
<p>Before every run of SpecFlow</p>
</li>
<li>
<p>Before the first scenario in each feature file</p>
</li>
<li>
<p>Before each scenario - TRUE</p>
</li>
<li>
<p>Before each step in a scenario</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: A BeforeScenario hook runs before each scenario. Since there is no way to tell if a hook exists by looking at the feature file, you should only use hooks for performing actions that you don&#8217;t expect the business to provide feedback on.</p>
</div>
<div class="paragraph">
<p>You can read more about hooks at <a href="https://docs.specflow.org/projects/specflow/en/latest/Bindings/Hooks.html" class="bare">https://docs.specflow.org/projects/specflow/en/latest/Bindings/Hooks.html</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_why_isnt_it_a_good_idea_to_create_a_network_instance_in_the_same_step_definition_where_we_create_lucy">Why isn&#8217;t it a good idea to create a Network instance in the same step definition where we create Lucy?</h5>
<div class="ulist">
<ul>
<li>
<p>It is a good idea</p>
</li>
<li>
<p>Steps should be independent and composable. If the Network is only created when Lucy is created, future scenarios will be forced to create Lucy - TRUE</p>
</li>
<li>
<p>We&#8217;ll need to create another Network instance when we create Sean</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Every person needs to share the <strong>same</strong> Network instance, which means we need to create the Network before we create any people. By creating the Network instance in the same step definition that we create Lucy, we are forcing people to:
* create Lucy&#8201;&#8212;&#8201;even if the scenario doesn&#8217;t need Lucy
* create Lucy before any other person&#8201;&#8212;&#8201;because otherwise Network will not have been created yet</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_person_in_a_generic_stepdef">4.5. Create Person in a generic stepdef</h3>
<div class="paragraph">
<p><a href="#shot-1734" id="shot-1734" title="Freeze of stepdef code from end of lesson 4, highlighting a_person_named_Lucy/Sean" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: Freeze of stepdef code from end of lesson 4, highlighting a_person_named_Lucy/Sean</a></p>
</div>
<div class="paragraph">
<p>OK, so we’ve cleaned things up a bit, to bring the scenarios, the code and our current understanding of the problem all into sync. What’s nice to see is how well those new steps that create Lucy and Sean match the code inside the step definition.</p>
</div>
<div class="paragraph">
<p>When step definitions have to make a big leap to translate between our plain-language description of the domain in the Gherkin scenario, and the code, that’s usually a sign that something is wrong. We like to see step definitions that are only one or two lines long, because that usually indicates our scenarios are doing a good job of reflecting the domain model in the code, and vice-versa.</p>
</div>
<div class="paragraph">
<p>One problem that we still have with these scenarios is that we’re very fixed to only being able to use these two characters, Lucy and Sean. If we want to introduce anyone else into the scenario, we’re going to be creating quite a lot of duplicate code. In fact, the two step definitions for creating Lucy and Sean are almost identical, apart from those instance fields.<a href="#shot-1735" id="shot-1735" title="highlight lucy and sean fields" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: highlight lucy and sean fields</a></p>
</div>
<div class="paragraph">
<p>On a real project we wouldn’t bother about such a tiny amount of duplication at this early stage, but this isn’t a real project! Let’s play with the skills we learned in the last chapter to make a single step definition that can create Lucy or Sean.</p>
</div>
<div class="paragraph">
<p>The first problem we’ll need to tackle is these hard-coded instance field names.<a href="#shot-1736" id="shot-1736" title="highlight lucy and sean fields" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: highlight lucy and sean fields</a></p>
</div>
<div class="paragraph">
<p>We can use a <code>Dictionary</code> to store all the people involved in the scenario.</p>
</div>
<div class="paragraph">
<p>Let’s try replacing Lucy first.<a href="#shot-1737" id="shot-1737" title="highlight lucy" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: highlight lucy</a></p>
</div>
<div class="paragraph">
<p>We’ll start by creating a new <code>Dictionary</code> in the before hook, like this. <a href="#shot-1738" id="shot-1738" title="Edit Stepdefs.cs, adding private instance field <strong>people</strong>, creating in Before hook" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: Edit Stepdefs.cs, adding private instance field <strong>people</strong>, creating in Before hook</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="k">private</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;</span> <span class="n">people</span><span class="p">;</span>

        <span class="p">[</span><span class="n">BeforeScenario</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">CreateNetwork</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">network</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Network</span><span class="p">();</span>
            <span class="n">people</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;();</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can store Lucy in a key in that Dictionary. We’ll use her name as the key, hard-coding it for now.<a href="#shot-1739" id="shot-1739" title="modify a_person_named_Lucy, use people.Add" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: modify a_person_named_Lucy, use people.Add</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named Lucy"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedLucy</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Lucy"</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">));</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, where we check Lucy’s messages heard here in the assertion, we need to fetch her out of the Dictionary. <a href="#shot-1740" id="shot-1740" title="modify lucy_hears_Sean_s_message, use indexer" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: modify lucy_hears_Sean_s_message, use indexer</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucy should hear Sean's message"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyShouldHearSeansMessage</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">messageFromSean</span><span class="p">,</span> <span class="n">people</span><span class="p">[</span><span class="s">"Lucy"</span><span class="p">].</span><span class="nf">GetMessagesHeard</span><span class="p">());</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1741" id="shot-1741" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: run tests</a></p>
</div>
<div class="paragraph">
<p>With that little refactoring done, we can now try and make this first step generic for any name.<a href="#shot-1742" id="shot-1742" title="highlight a_person_named_Lucy" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: highlight a_person_named_Lucy</a></p>
</div>
<div class="paragraph">
<p>Using your new found Cucumber expression skills from the last chapter, you’ll know that if we replace the word Lucy here with a parameter expression,<a href="#shot-1743" id="shot-1743" title="replace 'Lucy' with {word}" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: replace 'Lucy' with {word}</a> we’ll have the name passed into our step definition as an argument, here.<a href="#shot-1744" id="shot-1744" title="modify stepdef name &amp; parameter list" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11.1: modify stepdef name &amp; parameter list</a> <a href="#shot-1745" id="shot-1745" title="highlight {word}" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11.2: highlight {word}</a> {word} is a special parameter type matches to a&#8230;&#8203; word. What else. Now we can use that as the key in the Dictionary.<a href="#shot-1746" id="shot-1746" title="store Person instance in Dictionary" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: store Person instance in Dictionary</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named {word}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamed</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">));</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we try and run the tests now, we get an error from SpecFlow about an ambiguous match. <a href="#shot-1747" id="shot-1747" title="running tests FAILS" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: running tests FAILS</a></p>
</div>
<div class="paragraph">
<p>Our generic step definition is now matching the step “a person named Sean”,<a href="#shot-1748" id="shot-1748" title="highlight stepdef a_person_named" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: highlight stepdef a_person_named</a> but so is the original one.<a href="#shot-1749" id="shot-1749" title="highlight stepdef a_person_named_Sean" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: highlight stepdef a_person_named_Sean</a> In bigger projects, this can be a real issue, so this warning is important.</p>
</div>
<div class="paragraph">
<p>Let’s remove the old step definition,<a href="#shot-1750" id="shot-1750" title="delete a_person_named_Sean" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: delete a_person_named_Sean</a> and fetch Sean from the Dictionary here where he shouts his message.<a href="#shot-1751" id="shot-1751" title="modify sean_shouts" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17: modify sean_shouts</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts {string}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShouts</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">people</span><span class="p">[</span><span class="s">"Sean"</span><span class="p">].</span><span class="nf">Shout</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
            <span class="n">messageFromSean</span> <span class="p">=</span> <span class="n">message</span><span class="p">;</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Great, we’re green again. <a href="#shot-1752" id="shot-1752" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: run tests</a></p>
</div>
<div class="sect3">
<h4 id="_lesson_5_questions_specflow">4.5.1. Lesson 5 - Questions (SpecFlow)</h4>
<div class="sect4">
<h5 id="_why_should_a_step_definition_be_short">Why should a step definition be short?</h5>
<div class="ulist">
<ul>
<li>
<p>Because the plain-language description of the domain in the Gherkin step should be close to the domain model in the code - TRUE</p>
</li>
<li>
<p>Step definitions don&#8217;t need to be short</p>
</li>
<li>
<p>SpecFlow limits the length of step definitions to five lines of code</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Step definitions are a thin glue between the plain-language description in a scenario and the software that we&#8217;re building. If the business domain and the solution domain are aligned, then there should be little translation to do in the step definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_does_it_mean_when_specflow_complains_about_an_ambiguous_step">What does it mean when SpecFlow complains about an <em>ambiguous</em> step?</h5>
<div class="ulist">
<ul>
<li>
<p>SpecFlow couldn&#8217;t find a step definition that matches a step</p>
</li>
<li>
<p>SpecFlow only found one step definition that matches a step</p>
</li>
<li>
<p>SpecFlow found more than one step definition that matches a step - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: If more than one step definition matches a step, then SpecFlow doesn&#8217;t know which one to call. When this ambiguity occurs, SpecFlow issues an error, rather than try to choose between the matching step definitions.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_backgrounds">4.6. Backgrounds</h3>
<div class="paragraph">
<p><a href="#shot-1753" id="shot-1753" title="Feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: Feature file</a>
Let’s switch back to the feature file to show you one more technique for improving the readability of your scenarios.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="err">Rule</span><span class="p">:</span> <span class="err">Shouts</span> <span class="err">c</span><span class="nf">an </span>be heard by other users

<span class="kn">Scenario</span><span class="p">:</span> Listener hears a message
	<span class="nf">Given </span>a person named Lucy
	<span class="nf">And </span>a person named Sean
	<span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message

<span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
	<span class="nf">Given </span>a person named Lucy
	<span class="nf">And </span>a person named Sean
	<span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>When we have common context steps - the Givens - <a href="#shot-1754" id="shot-1754" title="highlight Given" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: highlight Given</a> in all the scenarios in our feature, it can sometimes be useful to get those out of the way.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1755" id="shot-1755" title="move Given steps into background" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: move Given steps into background</a>
We can literally move them into the background, using a Background keyword, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Background</span><span class="p">:</span>
    <span class="nf">Given </span>a person named Lucy
    <span class="nf">And </span>a person named Sean</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1756" id="shot-1756" title="run test" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: run test</a>
As far as SpecFlow is concerned, these scenarios haven’t changed. It will still create both Lucy and Sean as the first things it does when running each of these scenarios.</p>
</div>
<div class="paragraph">
<p>But from a readability point of view, we can now see  more clearly what’s important and interesting about these two scenarios - in this case, the message being shouted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="err">Rule</span><span class="p">:</span> <span class="err">Shouts</span> <span class="err">c</span><span class="nf">an </span>be heard by other users

<span class="kn">Scenario</span><span class="p">:</span> Listener hears a message
	<span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message

<span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
	<span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
	<span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice we just went straight into When steps in our scenarios.<a href="#shot-1757" id="shot-1757" title="highlight When" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: highlight When</a> That’s absolutely fine. We still have a context for the scenario, but we’ve chosen to push it off into the background.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1758" id="shot-1758" title="Feature file, showing Background and shortened scenarios" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: Feature file, showing Background and shortened scenarios</a></p>
</div>
<div class="paragraph">
<p>Again, it’s debatable whether we’d bother to use a Background to do this on a real project, but this at least illustrates the technique. We rarely use Backgrounds in our projects, because although they can improve readability by removing the duplication of repeated contexts, they also harm readability by requiring people to read the Background in conjunction with each Scenario.</p>
</div>
<div class="videoblock">
<div class="content">
<video src="https://drive.google.com/uc?id=19VLE9qKbVN4bpMxsIVvPtPqc3RGw4bSW" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
<div class="paragraph">
<p>To maintain trust in the BDD process, it’s important to keep your features fresh. Even when you drive the development from BDD scenarios, you’ll still learn lessons from the implementation that might need to be fed back into your Gherkin documentation.</p>
</div>
<div class="paragraph">
<p>In this case, we discovered that we could find a smaller slice of this story, and defer the business rule about proximity until our next iteration. Splitting stories like this is a powerful agile technique, and one that BDD can help you to master. Now we have a clean codebase and suite of scenarios that reflects the current state of the system’s development.</p>
</div>
<div class="paragraph">
<p>We’re ready to start the next iteration.</p>
</div>
<div class="sect3">
<h4 id="_lesson_6_questions_specflow">4.6.1. Lesson 6 - Questions (SpecFlow)</h4>
<div class="sect4">
<h5 id="_what_does_the_gherkin_keyword_background_do">What does the Gherkin keyword <em>Background</em> do?</h5>
<div class="ulist">
<ul>
<li>
<p>It provides a place to write a description of why the feature is valuable</p>
</li>
<li>
<p>It is treated exactly like a scenario, but is run as soon as SpecFlow starts</p>
</li>
<li>
<p>It is treated exactly like a scenario, but is run once before any other scenario in the feature file</p>
</li>
<li>
<p>The steps from the background are run as if they were inserted at the beginning of every scenario in the feature file - TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: The background is used to reduce duplication in scenarios by moving steps that are common to all scenarios into a single location. The steps in the background are run before every scenario in the feature file.</p>
</div>
<div class="paragraph">
<p>There can be a maximum of one Background per feature file. A Background only affects scenarios that are in the same feature file as the Background.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_might_backgrounds_decrease_the_readability_or_maintainability_of_a_feature_file">How might Backgrounds decrease the readability or maintainability of a feature file?</h5>
<div class="ulist">
<ul>
<li>
<p>Backgrounds always improve readability</p>
</li>
<li>
<p>Readability can decrease because the reader must remember the contents of the background even when reading scenarios at the end of the feature file</p>
</li>
<li>
<p>Maintainability can decrease because the maintainer must be aware that there is a background even when adding scenarios to the end of the feature file</p>
</li>
<li>
<p>Maintainability can decrease because the maintainer must be aware of the background when moving a scenario to a different feature file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Answer: Backgrounds were created to aid readability, by reducing duplication in the scenarios. Unfortunately, moving important information out of a scenario means that anyone reading or modifying a feature file must be fully aware that of the existence and content of a background. Since feature files typically contain several scenarios, that means holding two sections of the feature file in your mind at the same time, making a feature file harder to read or maintain.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_loops">5. Loops</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_removing_redundant_scenarios">5.1. Removing redundant scenarios</h3>
<div class="paragraph">
<p>Welcome back to Cucumber School.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1759" id="shot-1759" title="feature file from end of Ch 4" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: feature file from end of Ch 4</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Shout

  Shouty allows users to "hear" other users "shouts" as long as they are close enough to each other.

  <span class="err">To do</span><span class="p">:</span>
    <span class="err">-</span> <span class="err">only</span> <span class="err">shout</span> <span class="err">to</span> <span class="err">people</span> <span class="err">within</span> <span class="nf">a </span>certain distance

  <span class="err">Rule</span><span class="p">:</span> <span class="err">Shouts</span> <span class="err">c</span><span class="nf">an </span>be heard by other users

    <span class="kn">Scenario</span><span class="p">:</span> Listener hears a message
      <span class="nf">Given </span>a person named Lucy
      <span class="nf">And </span>a person named Sean
      <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
      <span class="nf">Then </span>Lucy should hear Sean's message

    <span class="kn">Scenario</span><span class="p">:</span> Listener hears a different mesage
      <span class="nf">Given </span>a person named Lucy
      <span class="nf">And </span>a person named Sean
      <span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
      <span class="nf">Then </span>Lucy should hear Sean's message

  <span class="err">Rule</span><span class="p">:</span> <span class="err">Shouts</span> <span class="err">should</span> <span class="err">only</span> <span class="err">be</span> <span class="err">heard</span> <span class="err">if</span> <span class="err">listener</span> <span class="err">is</span> <span class="err">within</span> <span class="err">range</span>

    <span class="kn">Scenario</span><span class="p">:</span> Listener is within range

    <span class="kn">Scenario</span><span class="p">:</span> <span class="err">Listener</span> <span class="err">is</span> <span class="err">out</span> <span class="err">of</span> <span class="err">range</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Last time we worked on cleaning up the Shouty features to keep them in sync with the current status of the project. We stripped the scenarios back to only specify the behaviour of passing messages between people. We made it clear that the proximity rule had not yet been implemented.</p>
</div>
<div class="paragraph">
<p>You’ll already remember from the Cucumber expressions chapter how important it is to be expressive in your scenarios, and keep them readable. In this chapter we’re going to learn some new tricks with Gherkin that will give you even more flexibility about how you write scenarios.</p>
</div>
<div class="paragraph">
<p>Once again the Shouty developers&#8201;&#8212;&#8201;have been hard at work implementing that proximity rule. Let’s have a look at how they got on. <a href="#shot-1760" id="shot-1760" title="Show chapter 5 initial checkin feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: Show chapter 5 initial checkin feature file</a></p>
</div>
<div class="paragraph">
<p>Right, so those two scenarios we just left as placeholders: the one where the listener is within range,<a href="#shot-1761" id="shot-1761" title="show in feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: show in feature file</a> and the one where the listener is out of range <a href="#shot-1762" id="shot-1762" title="show in feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: show in feature file</a> are passing. <a href="#shot-1763" id="shot-1763" title="Show output from Cucumber showing the in-range/out-of-range results" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: Show output from Cucumber showing the in-range/out-of-range results</a> Fantastic! If we look at our step definitions, we can see how they have been implemented. <a href="#shot-1764" id="shot-1764" title="show the in-range/out-of-range scenarios in the step definitions" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: show the in-range/out-of-range scenarios in the step definitions</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">    <span class="kn">Scenario</span><span class="p">:</span> Listener is within range
      <span class="nf">Given </span>the range is 100
      <span class="nf">And </span>a person named Sean is located at 0
      <span class="nf">And </span>a person named Lucy is located at 50
      <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
      <span class="nf">Then </span>Lucy should hear Sean's message

    <span class="kn">Scenario</span><span class="p">:</span> Listener is out of range
      <span class="nf">Given </span>the range is 100
      <span class="nf">And </span>a person named Sean is located at 0
      <span class="nf">And </span>a person named Larry is located at 150
      <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
      <span class="nf">Then </span>Larry should not hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let’s review the changes to the feature file in more detail.</p>
</div>
<div class="paragraph">
<p>We now have four scenarios:<a href="#shot-1765" id="shot-1765" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7</a> our original two from the last time we looked at the code,<a href="#shot-1766" id="shot-1766" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8</a> and the two placeholders we wrote as reminders.<a href="#shot-1767" id="shot-1767" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kd">Feature</span><span class="p">:</span> Hear shout

  Shouty allows users to "hear" other users "shouts" as long as they are close enough to each other.

  <span class="err">Rule</span><span class="p">:</span> <span class="err">Shouts</span> <span class="err">c</span><span class="nf">an </span>be heard by other users

    <span class="kn">Scenario</span><span class="p">:</span> Listener hears a message
      <span class="nf">Given </span>the range is 100
      <span class="nf">And </span>a person named Sean is located at 0
      <span class="nf">And </span>a person named Lucy is located at 50
      <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
      <span class="nf">Then </span>Lucy should hear Sean's message

    <span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
      <span class="nf">Given </span>the range is 100
      <span class="nf">And </span>a person named Sean is located at 0
      <span class="nf">And </span>a person named Lucy is located at 50
      <span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
      <span class="nf">Then </span>Lucy should hear Sean's message

  <span class="err">Rule</span><span class="p">:</span> <span class="err">Shouts</span> <span class="err">should</span> <span class="err">only</span> <span class="err">be</span> <span class="err">heard</span> <span class="err">if</span> <span class="err">listener</span> <span class="err">is</span> <span class="err">within</span> <span class="err">range</span>

    <span class="kn">Scenario</span><span class="p">:</span> Listener is within range
      <span class="nf">Given </span>the range is 100
      <span class="nf">And </span>a person named Sean is located at 0
      <span class="nf">And </span>a person named Lucy is located at 50
      <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
      <span class="nf">Then </span>Lucy should hear Sean's message

    <span class="kn">Scenario</span><span class="p">:</span> Listener is out of range
      <span class="nf">Given </span>the range is 100
      <span class="nf">And </span>a person named Sean is located at 0
      <span class="nf">And </span>a person named Larry is located at 150
      <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
      <span class="nf">Then </span>Larry should not hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>We used the second scenario - Listener hears a different message <a href="#shot-1768" id="shot-1768" title="Highlight second scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: Highlight second scenario</a> - to triangulate and force us to replace the hard-coded message output with a proper implementation. Now we have a domain model that uses a variable for the message, there&#8217;s an insignificant chance of this behaviour regressing, so we can safely remove the second scenario. <a href="#shot-1769" id="shot-1769" title="removes second scenario: Listener hears a different message" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: removes second scenario: Listener hears a different message</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">    <span class="kn">Scenario</span><span class="p">:</span> Listener hears a different message
      <span class="nf">Given </span>the range is 100
      <span class="nf">And </span>a person named Sean is located at 0
      <span class="nf">And </span>a person named Lucy is located at 50
      <span class="nf">When </span>Sean shouts <span class="s">"Free coffee!"</span>
      <span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p>Keeping excess scenarios is wasteful: they clutter up your feature files, distracting your readers. When you run your features as tests, excess scenarios make them take longer to run than necessary. The one where a "listener hears a "message" is a perfectly good way of checking that the message has been sent correctly.</p>
</div>
<div class="sect3">
<h4 id="_lesson_1_questions">5.1.1. Lesson 1 - Questions</h4>
<div class="sect4">
<h5 id="_why_was_it_a_good_idea_to_delete_the_scenario">Why was it a good idea to delete the scenario?</h5>
<div class="ulist">
<ul>
<li>
<p>It doesn&#8217;t help illustrate the rule "Shouts can be heard by other users"&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>No one should give away free coffee</p>
</li>
<li>
<p>There should only be one scenario per rule</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
We created the scenario "Listener hears a different message" to force us to replace our hard-coded implementation. Now we have a domain model that uses a variable for the message, there&#8217;s an insignificant chance of this behaviour regressing, so we can safely remove the second scenario.</p>
</div>
<div class="paragraph">
<p>Keeping excess scenarios is wasteful: they clutter up your feature files and slow down feedback.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_incidental_details">5.2. Incidental details</h3>
<div class="paragraph">
<p>The first scenario has changed since we last looked at it <a href="#shot-1770" id="shot-1770" title="hear_shout.feature" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: hear_shout.feature</a> - it now specifies the range of a shout and the location of Sean and Lucy.<a href="#shot-1771" id="shot-1771" title="Highlight the first three line of the first scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: Highlight the first three line of the first scenario</a> This scenario exists to illustrate that a listener hears the message exactly as the shouter shouted it. All the additional details are incidental and make the scenario harder to read.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener hears a message
    <span class="nf">Given </span>the range is 100
    <span class="nf">And </span>a person named Sean is located at 0
    <span class="nf">And </span>a person named Lucy is located at 50
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
    <span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1772" id="shot-1772" title="Edit context of first scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: Edit context of first scenario</a>
Let&#8217;s ensure that this scenario includes only essential information for the reader and remove all references to location and range.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener hears a message
    <span class="nf">Given </span>a person named Sean
    <span class="nf">And </span>a person named Lucy
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
    <span class="nf">Then </span>Lucy should hear Sean's message</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1773" id="shot-1773" title="Add Network creation, including const" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: Add Network creation, including const</a>
We&#8217;ll need to make changes to the step definitions to make sure that a Network class is always created - which we can do using an instance field.</p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">DEFAULT_RANGE</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

        <span class="k">private</span> <span class="kt">string</span> <span class="n">messageFromSean</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Network</span> <span class="n">network</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Network</span><span class="p">(</span><span class="n">DEFAULT_RANGE</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve defaulted the range to 100. <a href="#shot-1774" id="shot-1774" title="Highlight DEFAULT_RANGE const" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: Highlight DEFAULT_RANGE const</a></p>
</div>
<div class="paragraph">
<p>If a scenario needs to document specific range, that can still be done by explicitly including a "Given the range is &#8230;&#8203;" step. <a href="#shot-1775" id="shot-1775" title="Highlight step definition GivenTheRangeIs method" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5.2: Highlight step definition GivenTheRangeIs method</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">DEFAULT_RANGE</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ll also need to add a step definition that can create a person without the scenario needing to specify where they are located.<a href="#shot-1776" id="shot-1776" title="Create new step definition method header" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: Create new step definition method header</a> The step definition gives each person <a href="#shot-1777" id="shot-1777" title="type up to new person" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: type up to new person</a> created this way a default location of 0.<a href="#shot-1778" id="shot-1778" title="type 0 as distance" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: type 0 as distance</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named {word}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamed</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="m">0</span><span class="p">));</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1779" id="shot-1779" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: run tests</a>
Let&#8217;s run the scenarios to check we haven&#8217;t broken anything&#8230;&#8203; and we&#8217;re good!</p>
</div>
<div class="paragraph">
<p><a href="#shot-1780" id="shot-1780" title="show last two scenarios in feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: show last two scenarios in feature file</a>
Looking at the two new scenarios - Listener is within range <a href="#shot-1781" id="shot-1781" title="move cursor to scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: move cursor to scenario</a> &amp; Listener is out of range <a href="#shot-1782" id="shot-1782" title="move cursor to scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: move cursor to scenario</a> - we can see that they also contain incidental details. Since their purpose is to illustrate the "Shouts should only be heard if listener is within range" rule, there&#8217;s no need to actually document the content of the shout. <a href="#shot-1783" id="shot-1783" title=""highlight free bagels at seans" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: "highlight free bagels at seans</a></p>
</div>
<div class="listingblock">
<div class="title">hear_shout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener is within range
    <span class="nf">Given </span>the range is 100
    <span class="nf">And </span>a person named Sean is located at 0
    <span class="nf">And </span>a person named Lucy is located at 50
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span>
    <span class="nf">Then </span>Lucy should hear Sean's message

<span class="kn">Scenario</span><span class="p">:</span> Listener is out of range
    <span class="nf">Given </span>the range is 100
    <span class="nf">And </span>a person named Sean is located at 0
    <span class="nf">And </span>a person named Larry is located at 150
    <span class="nf">When </span>Sean shouts <span class="s">"free bagels at Sean's"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1784" id="shot-1784" title="Delete message text and change then step from both scenarios" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: Delete message text and change then step from both scenarios</a>
Let&#8217;s remove the details that aren&#8217;t relevant to the range rule.</p>
</div>
<div class="listingblock">
<div class="title">hear_shout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener is within range
    <span class="nf">Given </span>the range is 100
    <span class="nf">And </span>a person named Sean is located at 0
    <span class="nf">And </span>a person named Lucy is located at 50
    <span class="nf">When </span>Sean shouts
    <span class="nf">Then </span>Lucy should hear a shout

<span class="kn">Scenario</span><span class="p">:</span> Listener is out of range
    <span class="nf">Given </span>the range is 100
    <span class="nf">And </span>a person named Sean is located at 0
    <span class="nf">And </span>a person named Larry is located at 150
    <span class="nf">When </span>Sean shouts
    <span class="nf">Then </span>Larry should not hear a shout</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1785" id="shot-1785" title="Add new step definition" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: Add new step definition</a>
Next we add a step definition that allows Sean to shout, without needing us to specify the exact message.</p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShouts</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">people</span><span class="p">[</span><span class="s">"Sean"</span><span class="p">].</span><span class="nf">Shout</span><span class="p">(</span><span class="s">"Hello, world"</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1786" id="shot-1786" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16</a>
One that allows us to check that Lucy has heard exactly one shout - because she&#8217;s in range of the shouter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucy should hear a shout"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyShouldHearAShout</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">people</span><span class="p">[</span><span class="s">"Lucy"</span><span class="p">].</span><span class="nf">GetMessagesHeard</span><span class="p">().</span><span class="n">Count</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1787" id="shot-1787" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17</a>
And one that allows us to check that Larry hasn&#8217;t heard any messages at all - because he&#8217;s out-of-range.</p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Larry should not hear a shout"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLarryShouldNotHearAShout</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">people</span><span class="p">[</span><span class="s">"Larry"</span><span class="p">].</span><span class="nf">GetMessagesHeard</span><span class="p">().</span><span class="n">Count</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1788" id="shot-1788" title="Run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: Run tests</a>
And finally run all tests - and we&#8217;re still green.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1789" id="shot-1789" title="Show hear_shout.feature" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19: Show hear_shout.feature</a>
That&#8217;s better. We&#8217;ve removed inessential details, so that each scenario contains only the information needed to illustrate its business rule.</p>
</div>
<div class="paragraph">
<p>The scenarios would still run green if we removed the steps that set the range of a shout <a href="#shot-1790" id="shot-1790" title="Highlight in last two scenarios" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20: Highlight in last two scenarios</a> , because the range already has a default value. We&#8217;re not going to, because since those scenarios are illustrating the rule that deals with the range of a shout, it&#8217;s an essential part of context for anyone reading them.</p>
</div>
<div class="paragraph">
<p>A happy side-effect is that, in order to set the range from our scenario, we’ve had to make it a configurable property of the system <a href="#shot-1791" id="shot-1791" title="highlight Network constructor" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21: highlight Network constructor</a>. So if our business stakeholders ever change their minds about the range, we won’t have to go hunting around in the code for where it&#8217;s been hard-coded.</p>
</div>
<div class="sect3">
<h4 id="_lesson_2_questions_3">5.2.1. Lesson 2 - Questions</h4>
<div class="sect4">
<h5 id="_why_did_we_remove_any_reference_to_range_or_location_from_the_first_scenario_listener_hears_a_message">Why did we remove any reference to range or location from the first scenario "Listener hears a message"?</h5>
<div class="ulist">
<ul>
<li>
<p>They are essential to system behaviour</p>
</li>
<li>
<p>They are incidental to the rule being illustrated&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>They were only needed to triangulate the implementation</p>
</li>
<li>
<p>They made the scenario too long</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
The first scenario exists to illustrate the rule "Listener hears a message." Since the behaviour is not affected by the range of a shout, neither the range nor the distance between the shouter and the listener is relevant. The information is therefore <em>incidental</em> and should be omitted from the scenario.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_do_we_need_to_know_the_names_of_people_using_shouty">Why do we need to know the names of people using Shouty?</h5>
<div class="ulist">
<ul>
<li>
<p>It&#8217;s important that every person in the system has a real name</p>
</li>
<li>
<p>It&#8217;s necessary to use <em>persona</em>, where the shouter is called Sean and the listeners are called Lucy or Larry</p>
</li>
<li>
<p>It doesn&#8217;t matter what we call them&#8201;&#8212;&#8201;but the automation code does need to be able to tell them apart&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>The automation code has been written to recognise the names Sean, Lucy, and Larry</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
It&#8217;s necessary to be able to distinguish the people that are involved in the scenario. We have called them Sean, Lucy, and Larry, but we could have called them Shouter, Listener1, and Listener2 (or even User1, User2, and User3).</p>
</div>
<div class="paragraph">
<p>We find that using <em>persona</em> (where the name gives an indication of the person&#8217;s purpose in the scenario) can be a useful way of conveying information, without cluttering up the scenario. If the names conveyed no information at all, they would not contribute to the readability of the scenario, and could be considered incidental.</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_pieces_of_information_are_incidental_in_this_scenario">Which pieces of information are incidental in this scenario?</h5>
<div class="paragraph">
<p>Rule: Offer is only valid for Shouty users
  Scenario: Customer is not a Shouty user
    Given Nora is not a Shouty user
    And Sean shouted "free bagels until midday"
    When Nora orders a bagel and a coffee at 11:00am
    Then she should be charged 75¢ for the bagel</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nora is not a Shouty user</p>
</li>
<li>
<p>Sean is offering "free bagels!"</p>
</li>
<li>
<p>Sean&#8217;s offer is only valid until midday&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>Nora orders a bagel</p>
</li>
<li>
<p>Nora orders a coffee&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>Nora places her order at 11:00am&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>Nora gets charged for the bagel</p>
</li>
<li>
<p>Nora get charged 75¢ for the bagel&#8201;&#8212;&#8201;TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
This scenario is illustrating the rule that the "offer is only valid for Shouty users". It&#8217;s therefore essential to know that Nora is not a Shouty user, because this means that she is not eligible for the offer.</p>
</div>
<div class="paragraph">
<p>We don&#8217;t need to know that Nora orders a coffee, because that has no relevance to the rule. Nor do we need to know when the offer expires, when Nora places the order, or how much she will be charged&#8201;&#8212;&#8201;there will be other rules (and other scenarios) that illustrate that behaviour.</p>
</div>
<div class="paragraph">
<p>Although it&#8217;s incidental that the offer is for bagels, it is necessary to illustrate that Nora has ordered the item that is on offer to Shouty users&#8201;&#8212;&#8201;and that she will be charged for that item. We use "bagels" as an example to make the scenario easier to read, not because there&#8217;s something inherently special about bagels!</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_refactoring_to_data_tables">5.3. Refactoring to Data Tables</h3>
<div class="paragraph">
<p>Let&#8217;s look at the two scenarios that illustrate the rule about range again <a href="#shot-1792" id="shot-1792" title="show the range rule &amp; scenarios" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: show the range rule &amp; scenarios</a>. Notice how the steps that create the Sean,<a href="#shot-1793" id="shot-1793" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2</a> Lucy,<a href="#shot-1794" id="shot-1794" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3</a> and Larry <a href="#shot-1795" id="shot-1795" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4</a> are very similar.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#"><span class="n">Rule</span><span class="p">:</span> <span class="n">Shouts</span> <span class="n">should</span> <span class="n">only</span> <span class="n">be</span> <span class="n">heard</span> <span class="k">if</span> <span class="n">listener</span> <span class="k">is</span> <span class="n">within</span> <span class="n">range</span>

<span class="n">Scenario</span><span class="p">:</span> <span class="n">Listener</span> <span class="k">is</span> <span class="n">within</span> <span class="n">range</span>
    <span class="n">Given</span> <span class="n">the</span> <span class="n">range</span> <span class="k">is</span> <span class="m">100</span>
    <span class="n">And</span> <span class="n">a</span> <span class="n">person</span> <span class="n">named</span> <span class="n">Sean</span> <span class="k">is</span> <span class="n">located</span> <span class="n">at</span> <span class="m">0</span>
    <span class="n">And</span> <span class="n">a</span> <span class="n">person</span> <span class="n">named</span> <span class="n">Lucy</span> <span class="k">is</span> <span class="n">located</span> <span class="n">at</span> <span class="m">50</span>
    <span class="n">When</span> <span class="n">Sean</span> <span class="n">shouts</span>
    <span class="n">Then</span> <span class="n">Lucy</span> <span class="n">should</span> <span class="n">hear</span> <span class="n">a</span> <span class="n">shout</span>

<span class="n">Scenario</span><span class="p">:</span> <span class="n">Listener</span> <span class="k">is</span> <span class="k">out</span> <span class="n">of</span> <span class="n">range</span>
    <span class="n">Given</span> <span class="n">the</span> <span class="n">range</span> <span class="k">is</span> <span class="m">100</span>
    <span class="n">And</span> <span class="n">a</span> <span class="n">person</span> <span class="n">named</span> <span class="n">Sean</span> <span class="k">is</span> <span class="n">located</span> <span class="n">at</span> <span class="m">0</span>
    <span class="n">And</span> <span class="n">a</span> <span class="n">person</span> <span class="n">named</span> <span class="n">Larry</span> <span class="k">is</span> <span class="n">located</span> <span class="n">at</span> <span class="m">150</span>
    <span class="n">When</span> <span class="n">Sean</span> <span class="n">shouts</span>
    <span class="n">Then</span> <span class="n">Larry</span> <span class="n">should</span> <span class="n">not</span> <span class="n">hear</span> <span class="n">a</span> <span class="n">shout</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When we see steps like this, Gherkin’s Given When Then syntax starts to feel a bit clunky. Imagine if we could just write out a table, like this:</p>
</div>
<div class="paragraph">
<p><a href="#shot-1796" id="shot-1796" title="feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: feature file</a></p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">    <span class="nf">And </span>people are located at
        <span class="p">|</span> <span class="nv">name</span> <span class="p">|</span> <span class="nv">location</span> <span class="p">|</span>
        <span class="p">|</span> <span class="n">Sean</span> <span class="p">|</span> <span class="n">0</span>        <span class="p">|</span>
        <span class="p">|</span> <span class="n">Lucy</span> <span class="p">|</span> <span class="n">50</span>       <span class="p">|</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Well, we’re in luck. We can!</p>
</div>
<div class="paragraph">
<p>Gherkin has a special syntax called Data Tables, that allows you to specify tabular data for a step, using pipe characters to mark the boundary between cells. <a href="#shot-1797" id="shot-1797" title="highlight data table" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: highlight data table</a></p>
</div>
<div class="paragraph">
<p><a href="#shot-1798" id="shot-1798" title="copy snippet, paste into StepDefinitions.cs" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: copy snippet, paste into StepDefinitions.cs</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"people are located at"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenPeopleAreLocatedAt</span><span class="p">(</span><span class="n">Table</span> <span class="n">table</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">PendingStepException</span><span class="p">();</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the step definition implicitly takes a single argument <a href="#shot-1799" id="shot-1799" title="highlight stepdef parameters" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: highlight stepdef parameters</a> of type <code>Table</code>, which is a representation of a Data Table in SpecFlow. As it represents a table of Person objects, we can rename it to <code>personsTable</code> <a href="#shot-1800" id="shot-1800" title="rename parameter" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: rename parameter</a></p>
</div>
<div class="paragraph">
<p>This object has a rich API for using the tabular data. <a href="#shot-1801" id="shot-1801" title="split screen" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: split screen</a> The <code>Rows</code> property of the table class <a href="#shot-1802" id="shot-1802" title="type personsTable.Rows" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11.1: type personsTable.Rows</a> can be used to access the data rows of the table&#8201;&#8212;&#8201;all rows, except the header row.<a href="#shot-1803" id="shot-1803" title="highlight rows in scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11.2: highlight rows in scenario</a>  A particular cell value can be retrieved from a row by using the header name. So, Lucy&#8217;s location can be accessed by getting the "name" cell of the row at index 1. <a href="#shot-1804" id="shot-1804" title="extend row, wrap it to an an exception" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11.3: extend row, wrap it to an an exception</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"people are located at"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenPeopleAreLocatedAt</span><span class="p">(</span><span class="n">Table</span> <span class="n">personTable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">(</span><span class="s">"Lucy's location: "</span> <span class="p">+</span> <span class="n">personTable</span><span class="p">.</span><span class="n">Rows</span><span class="p">[</span><span class="m">1</span><span class="p">][</span><span class="s">"location"</span><span class="p">]);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1805" id="shot-1805" title="run tests, highlight 'Lucy&#8217;s location'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: run tests, highlight 'Lucy&#8217;s location'</a></p>
</div>
<div class="paragraph">
<p>Now we can easily iterate <a href="#shot-1806" id="shot-1806" title="close split, write the loop" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12.2: close split, write the loop</a> through the rows and turn them into instances of Person:</p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"people are located at"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenPeopleAreLocatedAt</span><span class="p">(</span><span class="n">Table</span> <span class="n">personTable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">row</span> <span class="k">in</span> <span class="n">personTable</span><span class="p">.</span><span class="n">Rows</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"name"</span><span class="p">],</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"location"</span><span class="p">])));</span>
            <span class="p">}</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1807" id="shot-1807" title="run tests&#8201;&#8212;&#8201;all green" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: run tests&#8201;&#8212;&#8201;all green</a></p>
</div>
<div class="paragraph">
<p>With that done, we can update the other scenario <a href="#shot-1808" id="shot-1808" title="update other scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: update other scenario</a> &#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Listener is out of range
    <span class="nf">Given </span>the range is 100
    <span class="nf">And </span>people are located at
        <span class="p">|</span> <span class="nv">name</span>  <span class="p">|</span> <span class="nv">location</span> <span class="p">|</span>
        <span class="p">|</span> <span class="n">Sean</span>  <span class="p">|</span> <span class="n">0</span>        <span class="p">|</span>
        <span class="p">|</span> <span class="n">Larry</span> <span class="p">|</span> <span class="n">150</span>      <span class="p">|</span>
    <span class="nf">When </span>Sean shouts
    <span class="nf">Then </span>Larry should not hear a shout</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can check that everything is still green. <a href="#shot-1809" id="shot-1809" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15</a></p>
</div>
<div class="paragraph">
<p>and delete our old step definition, which is now unused.  <a href="#shot-1810" id="shot-1810" title="delete unused step def" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: delete unused step def</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named {word} is located at {int}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamedIsLocatedAt</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">location</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">location</span><span class="p">));</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1811" id="shot-1811" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17: run tests</a></p>
</div>
<div class="paragraph">
<p>SpecFlow strips all the white space surrounding each cell <a href="#shot-1812" id="shot-1812" title="show lining up of pipe characters" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: show lining up of pipe characters</a>, so we can have a nice neat table in the Gherkin but still get clean values in the step definition underneath.</p>
</div>
<div class="paragraph">
<p>Notice we’ve still had to convert the location from a string to an integer <a href="#shot-1813" id="shot-1813" title="Conversion in step def" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19: Conversion in step def</a>, because SpecFlow can’t know that’s the type of value in our table.</p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">                <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"name"</span><span class="p">],</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"location"</span><span class="p">])));</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To improve the readability and maintainability of your step definition you can have SpecFlow automatically convert the table into a list of any class you want. If our Person object had a <code>name</code> field we could automatically create instances of Person from this table. But things aren’t always that simple.</p>
</div>
<div class="paragraph">
<p>Instead, we’ll define a simple Whereabouts class to represent the data in the table. <a href="#shot-1814" id="shot-1814" title="creates the class" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20: creates the class</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="k">public</span> <span class="k">class</span> <span class="nc">Whereabouts</span>
        <span class="p">{</span>
            <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">public</span> <span class="kt">int</span> <span class="n">Location</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We’ve made it a nested type to the step definition class, as it doesn’t form part of our core domain.</p>
</div>
<div class="paragraph">
<p>Then we can <a href="#shot-1815" id="shot-1815" title="write ConvertWhereabouts()" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21: write ConvertWhereabouts()</a> create a conversion method similarly to the ones we created in Chapter 3 that converts a Table instance to an array of Whereabouts. <a href="#shot-1816" id="shot-1816" title="add attribute" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22: add attribute</a> We have to add the <code>[StepArgumentTransformation]</code> attribute to it so that SpecFlow recognizes this conversion.</p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="n">StepArgumentTransformation</span><span class="p">]</span>
        <span class="k">public</span> <span class="n">Whereabouts</span><span class="p">[]</span> <span class="nf">ConvertWhereabouts</span><span class="p">(</span><span class="n">Table</span> <span class="n">table</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">table</span><span class="p">.</span><span class="n">Rows</span>
                <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">row</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">Whereabouts</span>
                <span class="p">{</span>
                    <span class="n">Name</span> <span class="p">=</span> <span class="n">row</span><span class="p">[</span><span class="s">"name"</span><span class="p">],</span>
                    <span class="n">Location</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"location"</span><span class="p">])</span>
                <span class="p">})</span>
                <span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, if you declare your table parameter as a Whereabouts array <a href="#shot-1817" id="shot-1817" title="modify stepdef" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23: modify stepdef</a>, SpecFlow will automatically call our conversion method.</p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"people are located at"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenPeopleAreLocatedAt</span><span class="p">(</span><span class="n">Whereabouts</span><span class="p">[]</span> <span class="n">whereaboutsList</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">whereabouts</span> <span class="k">in</span> <span class="n">whereaboutsList</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">whereabouts</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">whereabouts</span><span class="p">.</span><span class="n">Location</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1818" id="shot-1818" title="Run Tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24: Run Tests</a>
Let&#8217;s run the scenarios to check that we&#8217;re still green. And we are!</p>
</div>
<div class="paragraph">
<p><a href="#shot-1819" id="shot-1819" title="hear_shout.feature data tables" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 25: hear_shout.feature data tables</a>
That looks much nicer -  people positioned using a table in the feature file and <a href="#shot-1820" id="shot-1820" title="people_are_located_at()" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 26: people_are_located_at()</a> really clean code that creates and positions people according to the data.</p>
</div>
<div class="sect3">
<h4 id="_lesson_3_questions_specflow">5.3.1. Lesson 3 - Questions (SpecFlow)</h4>
<div class="sect4">
<h5 id="_what_is_the_name_of_the_gherkin_syntax_that_allows_you_to_specify_pipe_separated_tabular_data_for_a_step">What is the name of the Gherkin syntax that allows you to specify pipe-separated, tabular data for a step?</h5>
<div class="ulist">
<ul>
<li>
<p>Array</p>
</li>
<li>
<p>Data Matrix</p>
</li>
<li>
<p>Data Table&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>Example Table</p>
</li>
<li>
<p>Table</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
The Gherkin syntax is called a Data Table. It represents a 2-dimensional array, with cell boundaries indicated by pipe characters <code>|</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_what_value_would_be_retrieved_from_cell_rows1c_in_the_following_table">What value would be retrieved from cell Rows[1]["C"] in the following table?</h5>
<div class="paragraph">
<p>| A | B | C |
| 0 | 1 | 2 |
| 3 | 4 | 5 |
| 6 | 7 | 8 |</p>
</div>
<div class="ulist">
<ul>
<li>
<p>0</p>
</li>
<li>
<p>1</p>
</li>
<li>
<p>2</p>
</li>
<li>
<p>3</p>
</li>
<li>
<p>4</p>
</li>
<li>
<p>5&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>6</p>
</li>
<li>
<p>7</p>
</li>
<li>
<p>8</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
SpecFlow treats the first row as the header, and the Rows property returns each subsequent row indexed, starting from 0. The cells within a row can be retrieved by indexing the row with the header name. We need two pairs of brackets, because the first selects the row and the second selects the cell within the row.</p>
</div>
<div class="sect5">
<h6 id="_which_of_the_following_data_tables_will_this_method_process_successfully">Which of the following Data Tables will this method process successfully?</h6>
<div class="paragraph">
<p>public void GivenTheOrderContainsTheFollowingItems(Table orderItemsTable)
{
    foreach (var row in orderItemsTable.Rows)
    {
        order.AddLine(row["Item Name"], int.Parse(row["Quantity"]));
    }
}</p>
</div>
<div class="ulist">
<ul>
<li>
<p>| Item Name       | Quantity |&#8201;&#8212;&#8201;TRUE
| Cheese &amp; tomato | 1        |</p>
</li>
<li>
<p>| name            | quantity |
| Cheese &amp; tomato | 1        |</p>
</li>
<li>
<p>| Item Name       | Quantity |&#8201;&#8212;&#8201;TRUE
| Cheese &amp; tomato | 1        |
| Pepperoni       | 1        |</p>
</li>
<li>
<p>| Item Name       | Quantity |&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>| Item Name       | Quantity | Notes        |&#8201;&#8212;&#8201;TRUE
| Cheese &amp; tomato | 1        | Extra cheese |</p>
</li>
<li>
<p>| Cheese &amp; tomato | 1        |
| Pepperoni       | 1        |</p>
</li>
<li>
<p>| Quantity | Item Name       | &#8201;&#8212;&#8201;TRUE
| 1        | Cheese &amp; tomato |</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
The Rows property of the Table class contains all non-header rows in the data table. To be able retrieve a cell from the row, the header cell text must match the hard coded index strings used in the method exactly. The order of the columns is not significant and any extra columns are ignored. A Data Table with only a header row would have an empty Rows collection and hence it would not add any items to the order.</p>
</div>
</div>
<div class="sect5">
<h6 id="_how_would_you_need_to_change_the_step_definition_in_order_to_be_able_to_use_the_orderitem_list_converted_from_a_data_table_with_the_following_conversion_method">How would you need to change the step definition in order to be able to use the OrderItem list converted from a Data Table with the following conversion method</h6>
<div class="paragraph">
<p>public OrderItem[] ConvertOrderItems(Table orderItemsTable)
{
    return orderItemsTable.CreateSet&lt;OrderItem&gt;().ToArray();
}</p>
</div>
<div class="ulist">
<ul>
<li>
<p>[Given("the order contains the following items {OrderItems[]}")]
public void GivenTheOrderContainsTheFollowingItems(OrderItem[] orderItems) { &#8230;&#8203; }</p>
</li>
<li>
<p>[Given("the order contains the following items")]&#8201;&#8212;&#8201;TRUE
public void GivenTheOrderContainsTheFollowingItems(OrderItem[] orderItems) { &#8230;&#8203; }</p>
</li>
<li>
<p>[Given("the order contains the following items")]
public void GivenTheOrderContainsTheFollowingItems(IEnumerable&lt;OrderItem&gt; orderItems) { &#8230;&#8203; }</p>
</li>
<li>
<p>[Given("the order contains the following items")]
public void GivenTheOrderContainsTheFollowingItems(Table orderItemsTable) { &#8230;&#8203; }</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
In order to access the Data Table attached to the step, you don&#8217;t have to add parameters to the Cucumber Expression. The parameters of the expression refer to the parts of the step text only. The parameter type of the method should be exactly the same as the return type of the conversion method. So even though that the array implements the IEnumerable interface, SpecFlow will not find that. If the parameter is defined as a Table, the conversion method will not be invoked.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deeper_into_data_tables">5.4. Deeper into Data Tables</h3>
<div class="paragraph">
<p><a href="#shot-1821" id="shot-1821" title="open step def" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: open step def</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"people are located at"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GivenPeopleAreLocatedAt</span><span class="p">(</span><span class="n">Whereabouts</span><span class="p">[]</span> <span class="n">whereaboutsList</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">whereabouts</span> <span class="k">in</span> <span class="n">whereaboutsList</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">whereabouts</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">whereabouts</span><span class="p">.</span><span class="n">Location</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We separated the Data Table conversion from the step definition. The step definition is nice and clean now, but our conversion method is still fairly complex as it needs to handle the table headers and the cell data conversion. <a href="#shot-1822" id="shot-1822" title="open conversion" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: open conversion</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="n">StepArgumentTransformation</span><span class="p">]</span>
        <span class="k">public</span> <span class="n">Whereabouts</span><span class="p">[]</span> <span class="nf">ConvertWhereabouts</span><span class="p">(</span><span class="n">Table</span> <span class="n">table</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">table</span><span class="p">.</span><span class="n">Rows</span>
                <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">row</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">Whereabouts</span>
                <span class="p">{</span>
                    <span class="n">Name</span> <span class="p">=</span> <span class="n">row</span><span class="p">[</span><span class="s">"name"</span><span class="p">],</span>
                    <span class="n">Location</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"location"</span><span class="p">])</span>
                <span class="p">})</span>
                <span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>But even though it is complex, we can notice a pattern in it. We take the "name" cell and update the <code>Name</code> property of the Whereabouts object. We take the "location" cell and update the <code>Location</code> property&#8230;&#8203; This is not a big surprise for us, because we let the domain terms in the scenarios drive our domain model.</p>
</div>
<div class="paragraph">
<p>When this happens, this sort of consistency allows us to simplify the code further. SpecFlow defines an extension method on the Table class, called <code>CreateSet</code>. <code>CreateSet</code> can do exactly what we need here: create instances of a particular class and update its properties based on the table cells. <a href="#shot-1823" id="shot-1823" title="change DefineWhereabouts to use CreateSet" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: change DefineWhereabouts to use CreateSet</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="n">StepArgumentTransformation</span><span class="p">]</span>
        <span class="k">public</span> <span class="n">Whereabouts</span><span class="p">[]</span> <span class="nf">ConvertWhereabouts</span><span class="p">(</span><span class="n">Table</span> <span class="n">table</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">table</span><span class="p">.</span><span class="n">CreateSet</span><span class="p">&lt;</span><span class="n">Whereabouts</span><span class="p">&gt;().</span><span class="nf">ToArray</span><span class="p">();</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>CreateSet</code> extension method is defined in the <code>TechTalk.SpecFlow.Assist</code> namespace, so we have to add a using statement for that. <a href="#shot-1824" id="shot-1824" title="add using statement" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: add using statement</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#"><span class="k">using</span> <span class="nn">TechTalk.SpecFlow.Assist</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1825" id="shot-1825" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: run tests</a> With that change our conversion method is also clean and our tests still pass.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1826" id="shot-1826" title="show data tables in feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: show data tables in feature file</a>
Data tables are very useful for setting up data in Given steps, but you can also use them for specifying outcomes.</p>
</div>
<div class="paragraph">
<p>One rule that we’ve been implying, but have never actually explored with an example, is that people can hear more than one shout. So far we’ve only specified a single message, so let’s try writing a scenario where Sean shouts more than once: <a href="#shot-1827" id="shot-1827" title="write two-shouts scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: write two-shouts scenario</a></p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="err">Rule</span><span class="p">:</span> <span class="err">Listener</span> <span class="err">should</span> <span class="err">be</span> <span class="err">able</span> <span class="err">to</span> <span class="err">hear</span> <span class="err">multiple</span> <span class="err">shouts</span>

<span class="kn">Scenario</span><span class="p">:</span> Two shouts
    <span class="nf">Given </span>a person named Sean
    <span class="nf">And </span>a person named Lucy
    <span class="nf">When </span>Sean shouts <span class="s">"Free bagels!"</span>
    <span class="nf">And </span>Sean shouts <span class="s">"Free toast!"</span>
    <span class="err">Then Lucy hears the following messages</span><span class="p">:</span>
        <span class="p">|</span> <span class="nv">message</span>     <span class="p">|</span>
        <span class="p">|</span> <span class="n">Free</span> <span class="n">bagels</span> <span class="p">|</span>
        <span class="p">|</span> <span class="n">Free</span> <span class="n">toast</span>  <span class="p">|</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See how natural it is to use a Data Table here?</p>
</div>
<div class="paragraph">
<p>So how do we implement this step definition? First, let&#8217;s paste the generated snippet into the StepDefinitions class and rename the parameter. <a href="#shot-1828" id="shot-1828" title="define steps, copy, paste snippet, rename parameter to expectedMessagesTable" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: define steps, copy, paste snippet, rename parameter to expectedMessagesTable</a> What we want to do in this step definition is compare the messages that are actually heard with the messages we expected to hear. Getting the actual messages is easy, we just need to call the <code>GetMessagesHeard</code> method. <a href="#shot-1829" id="shot-1829" title="add actualMessages" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: add actualMessages</a> For the expected messages, we need to take the "message" cell from each table row like this. <a href="#shot-1830" id="shot-1830" title="add expectedMessages" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: add expectedMessages</a> And finally we can make sure they are the same using an assert statement. <a href="#shot-1831" id="shot-1831" title="add assert" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: add assert</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucy hears the following messages:"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyHearsTheFollowingMessages</span><span class="p">(</span><span class="n">Table</span> <span class="n">expectedMessagesTable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">actualMessages</span> <span class="p">=</span> <span class="n">people</span><span class="p">[</span><span class="s">"Lucy"</span><span class="p">].</span><span class="nf">GetMessagesHeard</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">expectedMessages</span> <span class="p">=</span> <span class="n">expectedMessagesTable</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">r</span> <span class="p">=&gt;</span> <span class="n">r</span><span class="p">[</span><span class="s">"message"</span><span class="p">]);</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">expectedMessages</span><span class="p">,</span> <span class="n">actualMessages</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1832" id="shot-1832" title="runs tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: runs tests</a> Oops! It looks like there is a problem. The two lists are different. By checking the error message we can see that there is a typo in our scenario. <a href="#shot-1833" id="shot-1833" title="highlight error message" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: highlight error message</a> But let&#8217;s not fix this yet. Instead, let&#8217;s look at another typical pattern for a data table related assertion.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1834" id="shot-1834" title="show type of actualResults" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: show type of actualResults</a> The <code>GetMessagesHeard</code> method returned a list of strings, but in many cases the list that we want to compare the Data Table with is a list of objects. Let&#8217;s imagine that later we will extend the <code>GetMessagesHeard</code> method to not only return the message but also the person who shouted it. <a href="#shot-1835" id="shot-1835" title="add HeardMessage and GetMessagesHeardEx" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: add HeardMessage and GetMessagesHeardEx</a> To simulate that let&#8217;s add an alternative version of <code>GetMessagesHeard</code>, called <code>GetMessagesHeardEx</code>. The new method returns a list of <code>HeardMessage</code> instances. <a href="#shot-1836" id="shot-1836" title="highlight method return type" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14.2: highlight method return type</a> The HeardMessage class has only one property, the message, <a href="#shot-1837" id="shot-1837" title="highlight Message property" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: highlight Message property</a> but later we might extend it.</p>
</div>
<div class="listingblock">
<div class="title">Person.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="k">public</span> <span class="k">class</span> <span class="nc">HeardMessage</span>
        <span class="p">{</span>
            <span class="k">public</span> <span class="kt">string</span> <span class="n">Message</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">HeardMessage</span><span class="p">&gt;</span> <span class="nf">GetMessagesHeardEx</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">messagesHeard</span>
                <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">HeardMessage</span> <span class="p">{</span><span class="n">Message</span> <span class="p">=</span> <span class="n">m</span><span class="p">})</span>
                <span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s first change the part of the step definition that calculates the actual messages by calling our extended method. <a href="#shot-1838" id="shot-1838" title="change actualMessages calculation, show type of the result" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: change actualMessages calculation, show type of the result</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">            <span class="kt">var</span> <span class="n">actualMessages</span> <span class="p">=</span> <span class="n">people</span><span class="p">[</span><span class="s">"Lucy"</span><span class="p">].</span><span class="nf">GetMessagesHeardEx</span><span class="p">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To compare this with the expected messages in the table, we need to check if the "message" cell matches the <code>Message</code> property for each row. If there was a "shouter name" cell we would have to match that to a <code>ShouterName</code> property and so on. This is the same consistency that we had when we used CreateSet. For such assertions, we can use another helper method, called <code>CompareToSet</code>.</p>
</div>
<div class="paragraph">
<p>It works similarly to CreateSet. <a href="#shot-1839" id="shot-1839" title="add CompareToSet call" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17: add CompareToSet call</a> The CompareToSet is an extension method on the Table class from the Assist namespace, and you need to pass the list of objects that you would like to compare the table with. <a href="#shot-1840" id="shot-1840" title="highlight actualMessages argument" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: highlight actualMessages argument</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucy hears the following messages:"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyHearsTheFollowingMessages</span><span class="p">(</span><span class="n">Table</span> <span class="n">expectedMessagesTable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">actualMessages</span> <span class="p">=</span> <span class="n">people</span><span class="p">[</span><span class="s">"Lucy"</span><span class="p">].</span><span class="nf">GetMessagesHeardEx</span><span class="p">();</span>
            <span class="n">expectedMessagesTable</span><span class="p">.</span><span class="nf">CompareToSet</span><span class="p">(</span><span class="n">actualMessages</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Both CreateSet and CompareToSet can be further customized, but this is just enough for us. Let&#8217;s run the tests and look at the error message.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1841" id="shot-1841" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19: run tests</a></p>
</div>
<div class="paragraph">
<p>Oh! We&#8217;ve found the typo: we should have included exclamation marks on the expected messages. <a href="#shot-1842" id="shot-1842" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20</a> Well, at least this gives you a chance to see the nice diff output from CompareToSet when the table and the list are different. We see the expected values prefixed with a minus, and the actual values prefixed with a plus.</p>
</div>
<div class="paragraph">
<p>Let’s fix just one of these <a href="#shot-1843" id="shot-1843" title="add an exclamation mark" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21: add an exclamation mark</a> so you can see how the diff output changes.</p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">        <span class="p">|</span> <span class="nv">Free</span> <span class="nv">bagels!</span> <span class="p">|</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1844" id="shot-1844" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22: run tests</a>
The matching bagels! line no longer has a minus, and for the mismatched row, the actual value still has a minus, and the expected value has a plus.</p>
</div>
<div class="paragraph">
<p>Let’s fix this last typo <a href="#shot-1845" id="shot-1845" title="add another exclamation mark" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23: add another exclamation mark</a>, and we should be green again.</p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin">        <span class="p">|</span> <span class="nv">Free</span> <span class="nv">toast!</span>  <span class="p">|</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1846" id="shot-1846" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24: run tests</a></p>
</div>
<div class="paragraph">
<p>Great.</p>
</div>
<div class="sect3">
<h4 id="_lesson_4_questions_specflow">5.4.1. Lesson 4 - Questions (SpecFlow)</h4>
<div class="sect4">
<h5 id="_which_statements_are_true_for_the_createset_method">Which statements are true for the CreateSet method</h5>
<div class="ulist">
<ul>
<li>
<p>CreateSet is an extension method that extends the Table class&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>CreateSet updates the properties based on the column headers with a case-sensitive exact match</p>
</li>
<li>
<p>When succeeds, CreateSet returns an enumerable that has exactly as many items as many non-header row the Data Table had&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>To be able to use the CreateSet extension method, the TechTalk.SpecFlow.Assist namespace has to be listed among the using statements of the file&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>CreateSet can detect the type of the objects to be created based on the Data Table header</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
CreateSet is an extension method for the Table class that is defined in the TechTalk.SpecFlow.Assist namespace. The target type has to be specified as a generic type parameter. The fields and properties of the target type are found using case-insensitive match. Whitespace in the header name is also ignored, so cells with the header "shouter name" will update the property ShouterName. CreateSet returns an object for each non-header row in the Data Table. By default it creates the objects using their default constructor, but you can also specify a delegate to create the instance differently.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_extension_method_on_the_table_class_compares_the_table_with_a_list_of_objects_and_produces_a_textual_output_showing_their_differences">What extension method on the Table class compares the table with a list of objects and produces a textual output showing their differences?</h5>
<div class="ulist">
<ul>
<li>
<p>Compare</p>
</li>
<li>
<p>AssertEqual</p>
</li>
<li>
<p>CompareToList</p>
</li>
<li>
<p>CompareToSet&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>Covariance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
The method that compares two data tables is called <strong>CompareToSet</strong>. It is defined in the TechTalk.SpecFlow.Assist namespace.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_docstring">5.5. DocString</h3>
<div class="paragraph">
<p>When writing scenarios, occasionally we want to use a really long piece of data. <a href="#shot-1847" id="shot-1847" title="Show feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: Show feature file</a></p>
</div>
<div class="paragraph">
<p>For example, let’s introduce a new rule about the maximum length of a message <a href="#shot-1848" id="shot-1848" title="New rule" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: New rule</a></p>
</div>
<div class="listingblock">
<div class="title">HearShout.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="err">Rule</span><span class="p">:</span>  <span class="err">Maximum</span> <span class="err">length</span> <span class="err">of</span> <span class="err">message</span> <span class="err">is</span> <span class="err">180</span> <span class="err">characters</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and add a scenario to illustrate it <a href="#shot-1849" id="shot-1849" title="New scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: New scenario</a>, making the string just over the boundary of the rule:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Message is too long
    <span class="nf">Given </span>a person named Sean
    <span class="nf">And </span>a person named Lucy
    <span class="nf">When </span>Sean shouts <span class="s">"123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890x"</span>
    <span class="nf">Then </span>Lucy should not hear a shout</code></pre>
</div>
</div>
<div class="paragraph">
<p>That’s pretty ugly isn’t it!</p>
</div>
<div class="paragraph">
<p>Still, we’ll press on and get it to green, then we’ll show you how to clean it up.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1850" id="shot-1850" title="select line with long text" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4.1: select line with long text</a> Our existing step definition handles that ugly step with the long message just fine, but the last outcome step is undefined <a href="#shot-1851" id="shot-1851" title="select Then" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4.2: select Then</a>. We could either add a new step definition, or parametrize "Larry should not hear a shout". Let&#8217;s modify the existing step definition <a href="#shot-1852" id="shot-1852" title="Modify stepdef" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: Modify stepdef</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"{word} should not hear a shout"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ThenPersonShouldNotHearAShout</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">people</span><span class="p">[</span><span class="n">name</span><span class="p">].</span><span class="nf">GetMessagesHeard</span><span class="p">().</span><span class="n">Count</span><span class="p">);</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1853" id="shot-1853" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: run tests</a></p>
</div>
<div class="paragraph">
<p>OK, so we have a failing acceptance test.<a href="#shot-1854" id="shot-1854" title="select failing test in test explorer" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: select failing test in test explorer</a> Let’s dive down into our solution and implement this new rule. It seems like the Network should be responsible for implementing this rule,  so let’s go to its unit tests. <a href="#shot-1855" id="shot-1855" title="show NetworkTest" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: show NetworkTest</a> As we explain in more detail in the next lesson, we start by adding a new unit test to specify this extra responsibility. <a href="#shot-1856" id="shot-1856" title="start creating new unit test" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: start creating new unit test</a></p>
</div>
<div class="paragraph">
<p>We’ll create a 181-character message like this <a href="#shot-1857" id="shot-1857" title="finish implementing unit test" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: finish implementing unit test</a> and then assert that the message should not be heard when it’s broadcast.<a href="#shot-1858" id="shot-1858" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11</a></p>
</div>
<div class="listingblock">
<div class="title">NetworkTests.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Does_not_broadcast_a_message_over_180_characters_even_if_listener_is_in_range</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">seanLocation</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

            <span class="kt">var</span> <span class="n">longMessage</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">(</span><span class="sc">'x'</span><span class="p">,</span> <span class="m">181</span><span class="p">);</span>

            <span class="n">Person</span> <span class="n">laura</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="n">network</span><span class="p">.</span><span class="nf">Broadcast</span><span class="p">(</span><span class="n">longMessage</span><span class="p">,</span> <span class="n">seanLocation</span><span class="p">);</span>

            <span class="n">Assert</span><span class="p">.</span><span class="nf">DoesNotContain</span><span class="p">(</span><span class="n">longMessage</span><span class="p">,</span> <span class="n">laura</span><span class="p">.</span><span class="nf">GetMessagesHeard</span><span class="p">());</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let’s run that test. <a href="#shot-1859" id="shot-1859" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: run tests</a><a href="#shot-1860" id="shot-1860" title="show the unit test results" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: show the unit test results</a> Good, it fails. Laura’s still getting the message at the moment. Now how are we going to implement this?</p>
</div>
<div class="paragraph">
<p>It looks like we’re already implementing the proximity rule here in the broadcast method. <a href="#shot-1861" id="shot-1861" title="show Network proximity logic" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: show Network proximity logic</a> Let’s add another if statement here about the message length. <a href="#shot-1862" id="shot-1862" title="add message length logic" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: add message length logic</a></p>
</div>
<div class="listingblock">
<div class="title">Network.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">                <span class="k">if</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="nf">Abs</span><span class="p">(</span><span class="n">listener</span><span class="p">.</span><span class="n">Location</span> <span class="p">-</span> <span class="n">shouterLocation</span><span class="p">)</span> <span class="p">&lt;=</span> <span class="n">range</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">Length</span> <span class="p">&lt;=</span> <span class="m">180</span><span class="p">)</span>
                        <span class="n">listener</span><span class="p">.</span><span class="nf">Hear</span><span class="p">(</span><span class="n">message</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1863" id="shot-1863" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: run tests</a>
Run the unit test again… and it’s passing. Great.</p>
</div>
<div class="paragraph">
<p>The code here has got a little bit messy and hard to read. <a href="#shot-1864" id="shot-1864" title="show the modified logic in the Network class" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17: show the modified logic in the Network class</a>
One very basic move we could make to improve it would be to just extract a couple of temporary variables, one for the range rule <a href="#shot-1865" id="shot-1865" title="extract range temporary variable" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: extract range temporary variable</a> and one for the length rule. <a href="#shot-1866" id="shot-1866" title="extract length temporary variable" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19: extract length temporary variable</a></p>
</div>
<div class="listingblock">
<div class="title">Network.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">                <span class="kt">var</span> <span class="n">withinRange</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Abs</span><span class="p">(</span><span class="n">listener</span><span class="p">.</span><span class="n">Location</span> <span class="p">-</span> <span class="n">shouterLocation</span><span class="p">)</span> <span class="p">&lt;=</span> <span class="n">range</span><span class="p">;</span>
                <span class="kt">var</span> <span class="n">shortEnough</span> <span class="p">=</span> <span class="n">message</span><span class="p">.</span><span class="n">Length</span> <span class="p">&lt;=</span> <span class="m">180</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">withinRange</span> <span class="p">&amp;&amp;</span> <span class="n">shortEnough</span><span class="p">)</span>
                    <span class="n">listener</span><span class="p">.</span><span class="nf">Hear</span><span class="p">(</span><span class="n">message</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>That’s better. This code could be improved even further of course, but at least we haven’t made it any worse.</p>
</div>
<div class="paragraph">
<p>Let’s just run the tests to check. <a href="#shot-1867" id="shot-1867" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20: run tests</a> Great - everything’s still green.</p>
</div>
<div class="paragraph">
<p>As now we have everything passing again, we can tidy up the Gherkin to use a new piece of syntax we’ve been wanting to tell you about: a DocString. <a href="#shot-1868" id="shot-1868" title="show message length scenario in feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21: show message length scenario in feature file</a></p>
</div>
<div class="paragraph">
<p>DocStrings allow you to specify a text argument for a step that spans over multiple lines.  We could change our step to look like this instead: <a href="#shot-1869" id="shot-1869" title="convert message to DocString" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22: convert message to DocString</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="kn">Scenario</span><span class="p">:</span> Message is too long
    <span class="nf">Given </span>a person named Sean
    <span class="nf">And </span>a person named Lucy
    <span class="nf">When </span>Sean shouts the following message
        <span class="s">"""
        This is a really long message
        so long in fact that I am not going to
        be allowed to send it, at least if I keep
        typing like this until the length is over
        the limit of 180 characters.
        """</span>
    <span class="nf">Then </span>Lucy should not hear a shout</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the scenario is much more readable.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1870" id="shot-1870" title="highlight step" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23: highlight step</a>
We have to add a new step definition too <a href="#shot-1871" id="shot-1871" title="add sean_shouts_the_following_message stepdef" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24: add sean_shouts_the_following_message stepdef</a>. It doesn&#8217;t need a parameter in the Cucumber Expression <a href="#shot-1872" id="shot-1872" title="show expression" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 25: show expression</a>&#8201;&#8212;&#8201;the DocString gets passed as a string argument to the step definition automatically.<a href="#shot-1873" id="shot-1873" title="show param" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 26: show param</a></p>
</div>
<div class="paragraph">
<p>Now we can fill out the rest of our new step definition. <a href="#shot-1874" id="shot-1874" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 27</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts the following message"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShoutsTheFollowingMessage</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">people</span><span class="p">[</span><span class="s">"Sean"</span><span class="p">].</span><span class="nf">Shout</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
            <span class="n">messageFromSean</span> <span class="p">=</span> <span class="n">message</span><span class="p">;</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s check that we&#8217;re still green <a href="#shot-1875" id="shot-1875" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 28: run tests</a>&#8201;&#8212;&#8201;and we are!</p>
</div>
<div class="paragraph">
<p>These two step definitions do the same thing and they even have the same parameters. So we can keep just one of them and add the When attribute of the other to it. <a href="#shot-1876" id="shot-1876" title="move second When attribute up, delete second method" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 29: move second When attribute up, delete second method</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#">        <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts {string}"</span><span class="p">)]</span>
        <span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts the following message"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShoutsAMessage</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">people</span><span class="p">[</span><span class="s">"Sean"</span><span class="p">].</span><span class="nf">Shout</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
            <span class="n">messageFromSean</span> <span class="p">=</span> <span class="n">message</span><span class="p">;</span>
        <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1877" id="shot-1877" title="run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 30: run tests</a> Having multiple Given, When or Then attributes on the same method is another way to handle alternates.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1878" id="shot-1878" title="switch back to feature file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 31: switch back to feature file</a>
We don’t use DocStrings very often - having such a lot of data in a test can often make it quite brittle. But when you do need it, it&#8217;s useful to know about.</p>
</div>
<div class="sect3">
<h4 id="_lesson_5_questions_specflow_2">5.5.1. Lesson 5 - Questions (SpecFlow)</h4>
<div class="sect4">
<h5 id="_we_start_implementing_the_maximum_message_length_rule_by_writing_a_scenario_and_seeing_it_fail_what_did_we_do_next">We start implementing the maximum message length rule by writing a scenario and seeing it fail. What did we do next?</h5>
<div class="ulist">
<ul>
<li>
<p>Write another scenario to triangulate the new behaviour of the Network class</p>
</li>
<li>
<p>Implement the changed behaviour in the Network class</p>
</li>
<li>
<p>Add a new unit test to NetworkTest that specifies the change in behaviour of the Network class&#8201;&#8212;&#8201;TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
We wrote a new unit test in NetworkTest. We&#8217;ll talk more about this in the next lesson.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_would_we_use_a_docstring">Why would we use a DocString?</h5>
<div class="ulist">
<ul>
<li>
<p>It&#8217;s the only way to include multi-line strings in a scenarios</p>
</li>
<li>
<p>It&#8217;s a readable way to include long strings in a scenario&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>DocStrings support multiple languages</p>
</li>
<li>
<p>SpecFlow provides a DocString type that provides useful string manipulation features</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
The DocString is Gherkin syntax that allows long strings to be readably represented in a scenario.</p>
</div>
<div class="paragraph">
<p>All the magic happens when the DocString is read from the Gherkin. The content of the DocString gets passed to the step definition as a normal string&#8201;&#8212;&#8201;there&#8217;s no corresponding SpecFlow type.</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_the_following_snippets_of_code_are_correct_for_the_step_below">Which of the following snippets of code are correct for the step below?</h5>
<div class="literalblock">
<div class="content">
<pre>Then Simone says
"""
Now on that limb there was a branch
A rare branch and a rattlin' branch
And the branch on the limb
And the limb on the tree
And the tree in the bog
And the bog down in the valley-o
"""</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>[Then("Simone says")]
public void SimoneSays() { }</p>
</li>
<li>
<p>[Then("Simone says")]
public void SimoneSays(string lyrics) { }&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>[Then("Simone says {string}")]
public void SimoneSays(string lyrics) { }</p>
</li>
<li>
<p>[Then("Simone says {docstring}")]
public void SimoneSays(string lyrics) { }</p>
</li>
<li>
<p>[Then("Simone says {docstring}")]
public void SimoneSays(DocString lyrics) { }</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
When using a DocString in a scenario, you do not add any parameter to the matching Cucumber Expression. You do need to provide a string parameter to the step definition to receive the contents of the DocString.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tdd_loops">5.6. TDD Loops</h3>
<div class="paragraph">
<p><a href="#shot-1879" id="shot-1879" title="original animation" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: original animation</a></p>
</div>
<div class="paragraph">
<p>You might have noticed that we’ve followed a pattern when we added behaviour to the system during this episode.</p>
</div>
<div class="paragraph">
<p>First we expressed the behaviour we wanted in a Gherkin scenario, wired up the step definitions, then ran SpecFlow to watch it fail.</p>
</div>
<div class="paragraph">
<p>Then, we found the first class in our domain model that needed to change in order to support that new behaviour. In this case, the Network class. We used a unit test to describe how we wanted instances of that class to behave. Then we ran the unit test and watched it fail.</p>
</div>
<div class="paragraph">
<p>We focused in and made changes to the class until its unit tests were passing. When the unit tests were passing, we then made some minor changes to clean up the code and make it more readable. This is the basic test-driven-development cycle: red, green, clean.</p>
</div>
<div class="paragraph">
<p>The technical name for this last clean-up step is refactoring. Refactoring is an ugly name for an extremely valuable activity: improving the design of existing code without changing its behaviour. You can think about it like cleaning up and washing the dishes after you’ve prepared a meal: basic housekeeping. But imagine the state of your kitchen if you never made time to do the dishes.</p>
</div>
<div class="paragraph">
<p>Go on, imagine it for a second.</p>
</div>
<div class="paragraph">
<p>Yuck!</p>
</div>
<div class="paragraph">
<p>Well, that’s how many, many codebase end up. The good thing about taking this course is that we’re teaching you how to write solid automated tests, and the good thing about having solid automated tests is that you can refactor with confidence, knowing that if you accidentally change the system’s behaviour, your tests will tell you.</p>
</div>
<div class="paragraph">
<p>Once we’re done refactoring, what do we do next? Run SpecFlow, of course! In this case, our scenario was passing with a single trip round the inner TDD loop, but sometimes you can spend several hours working through all the unit tests you need to get a single scenario to green.</p>
</div>
<div class="paragraph">
<p>Once the acceptance test is passing, we figure out the next most valuable scenario on our todo list, and start the whole thing all over again!</p>
</div>
<div class="paragraph">
<p>Together, these two loops make the BDD cycle. The outer loop, which starts with an acceptance test, keeps us focussed on what the business needs us to do next. The inner loop, where we continuously test, implement then refactor small units of code, is where we decide how we’ll implement that behaviour.</p>
</div>
<div class="paragraph">
<p>Both of these levels of feedback are important. It’s sometimes said that your acceptance tests ensure you’re building the right thing, and your unit tests ensure you’re building the thing right.</p>
</div>
<div class="paragraph">
<p>That’s all for this chapter. See you next time!</p>
</div>
<div class="sect3">
<h4 id="_lesson_6_questions">5.6.1. Lesson 6 - Questions</h4>
<div class="sect4">
<h5 id="_which_of_the_following_is_the_best_definition_of_the_term_refactoring">Which of the following is the best definition of the term "refactoring"?</h5>
<div class="ulist">
<ul>
<li>
<p>Improving the efficiency of the code without changing its behaviour</p>
</li>
<li>
<p>Adding new functionality to the application</p>
</li>
<li>
<p>Changing the behaviour of the code</p>
</li>
<li>
<p>Tidying up the code without changing its behaviour&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>Rearchitecting the code to get ready for adding new functionality</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
The definition of refactoring is: improve the design (of some code) without changing its behaviour.</p>
</div>
</div>
<div class="sect4">
<h5 id="_when_can_refactoring_happen">When can refactoring happen?</h5>
<div class="ulist">
<ul>
<li>
<p>When a refactoring story gets prioritised by the Product Owner</p>
</li>
<li>
<p>Whenever all tests are green&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>When at least one test is failing</p>
</li>
<li>
<p>First thing in the morning</p>
</li>
<li>
<p>Before committing code to source control</p>
</li>
<li>
<p>At the end of an iteration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Refactoring is part of the day-to-day work of every software developer. It&#8217;s when they tidy up the code once they&#8217;ve got it working.</p>
</div>
<div class="paragraph">
<p>Since part of the definition of refactoring is that it shouldn&#8217;t change the behaviour of the code, they will run the tests to make sure nothing was broken. Which means that the tests MUST be passing BEFORE they start refactoring. Otherwise, how can they be sure that the behaviour hasn&#8217;t changed?</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_are_the_acceptance_test_and_unit_test_related">How are the acceptance test and unit test related?</h5>
<div class="ulist">
<ul>
<li>
<p>Acceptance tests ensure we "build the right thing"; unit tests ensure we "build the thing right"&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>An acceptance test should be passing before we start writing unit tests</p>
</li>
<li>
<p>We may write many unit tests before the currently failing acceptance test passes&#8201;&#8212;&#8201;TRUE</p>
</li>
<li>
<p>All unit tests should be passing before we write an acceptance test</p>
</li>
<li>
<p>BDD consists of two loops: an outer acceptance test loop and an inner unit test loop&#8201;&#8212;&#8201;TRUE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Once we have a scenario, we automate it&#8201;&#8212;&#8201;and we expect it to fail, because we haven&#8217;t added the functionality it specifies to the system yet. This is the beginning of the outer, acceptance test loop, that ensures we&#8217;re building what the Product Owner wants: "build the right thing."</p>
</div>
<div class="paragraph">
<p>We then enter the inner, unit test loop. It&#8217;s unit tests that define the precise behaviour of small units of code&#8201;&#8212;&#8201;and ensure that we "build the thing right." They give us the safety to improve the code&#8217;s design (refactor), because they will fail if we accidentally change the code&#8217;s behaviour while refactoring. We may have to go round the inner loop a number of times, adding several unit tests, before we&#8217;ve added enought functionality to make the outer acceptance test pass.</p>
</div>
<div class="paragraph">
<p>And then we write the next failing acceptance test&#8230;&#8203;</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_cucumber">6. Working with Cucumber</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_basic_filtering">6.1. Basic Filtering</h3>
<div class="paragraph">
<p><a href="#shot-1880" id="shot-1880" title="Animation" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: Animation</a>
Hello, and welcome back to Cucumber School.</p>
</div>
<div class="paragraph">
<p>Last time we learned about two very different kinds of loops. First, we used DataTables to loop over data in your scenarios.</p>
</div>
<div class="paragraph">
<p>Then we learned about BDD cycles. We saw how the outer loop of BDD helps you to build the right thing while the inner loop helps you build the thing right.</p>
</div>
<div class="paragraph">
<p>In this lesson, we’re going to teach you all about how to run different SpecFlow scenarios.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1881" id="shot-1881" title="Scroll through shout.feature, end by showing scenario 'Message too long'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: Scroll through shout.feature, end by showing scenario 'Message too long'</a>
When we start working on a new scenario we often take a dive down to the inner TDD loop where we use a unit testing tool to drive out new classes or modify the behaviour of existing ones. When our unit tests are green and the new code is implemented we return to the SpecFlow scenarios to verify whether we have made overall progress or not.</p>
</div>
<div class="paragraph">
<p>If we have lots of SpecFlow scenarios, it can be distracting to run all of them each time we do this. We often want to focus on a single scenario - or perhaps just a couple - to get feedback on what we’re currently working on.</p>
</div>
<div class="paragraph">
<p>There are several ways to do this. SpecFlow converts the scenarios to tests that can be executed by the test execution framework we configured for the project, which is xUnit in our case. Because of that the SpecFlow scenarios appear as regular coded tests in the test runner tools you use, for example in the Visual Studio Test Explorer window. These tools usually provide several filtering options.</p>
</div>
<div class="paragraph">
<p>Probably the easiest way to filter is to run only the scenario with a specified name.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1882" id="shot-1882" title="type 'Message too long' into the VS test explorer search box" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: type 'Message too long' into the VS test explorer search box</a></p>
</div>
<div class="paragraph">
<p>Simply typing the name of the scenario to the Test Explorer window search box filters the list to that particular scenario. <a href="#shot-1883" id="shot-1883" title="Select test and show context menu" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: Select test and show context menu</a> You can run or debug the selected scenario from the context menu but the easiest is <a href="#shot-1884" id="shot-1884" title="click run all" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5.1: click run all</a> to hit <strong>Run All</strong> that runs all scenarios in the filtered view. It is worth spending a few minutes learning the keyboard shortcut of that, <a href="#shot-1885" id="shot-1885" title="hover over run all" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5.2: hover over run all</a> Ctrl R,V by default, as it can speed up your loops drastically.</p>
</div>
<div class="paragraph">
<p>You can filter for the scenario name as you have seen but you can use the search box to filter for keywords as well. Let&#8217;s use it to run all scenarios with the text "range" in their name. <a href="#shot-1886" id="shot-1886" title="type 'range' to the search box, open up hierarchy nodes, and run all" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: type 'range' to the search box, open up hierarchy nodes, and run all</a></p>
</div>
<div class="paragraph">
<p>The Test Explorer window can also be used <a href="#shot-1887" id="shot-1887" title="clear search and hover over failing test filter" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: clear search and hover over failing test filter</a> to filter for the outcome, for example if you want to re-run all failing tests, <a href="#shot-1888" id="shot-1888" title="click through hierarchy nodes" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: click through hierarchy nodes</a> or you can also run tests based on their hierarchy. Since the feature files appear as a separate node in the hierarchy, <a href="#shot-1889" id="shot-1889" title="run scenarios from HearShoutyFeature node" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9.1: run scenarios from HearShoutyFeature node</a> you can use this to run all scenarios from a particular feature file.</p>
</div>
<div class="paragraph">
<p>The search box can contain complex search expressions. You can discover these options <a href="#shot-1890" id="shot-1890" title="show links" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9.2: show links</a> by clicking on the <strong>Add search filter</strong> links or by checking out the documentation. We&#8217;ll use this to show you how to filter using tags.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1891" id="shot-1891" title="show 'Listener is out of range' scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: show 'Listener is out of range' scenario</a>
Let&#8217;s say we want to work on this scenario for the next couple of hours. First, we’ll put a focus tag right here, above this scenario. <a href="#shot-1892" id="shot-1892" title="add a @focus tag to the 'Listener is out of range' scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: add a @focus tag to the 'Listener is out of range' scenario</a> Tags start with an at-sign and are case sensitive.</p>
</div>
<div class="paragraph">
<p>As we said, SpecFlow converts the scenarios to tests. This conversion happens at compile-time, so I need to build my solution to be able to have the changes applied. <a href="#shot-1893" id="shot-1893" title="build" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: build</a></p>
</div>
<div class="paragraph">
<p>SpecFlow converts the tags to test categories or <strong>traits</strong> as the Test Explorer window calls these. So to be able to filter for a particular tag, we have to enter a trait expression.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1894" id="shot-1894" title="type Trait:focus into the search box" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: type Trait:focus into the search box</a> Trait expressions start with the word <strong>Trait</strong> followed by a colon and the name of the tag without the at sign.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Trait:focus</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can run only the scenarios tagged with focus&#8230;&#8203; <a href="#shot-1895" id="shot-1895" title="run all" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: run all</a></p>
</div>
<div class="paragraph">
<p>It’s entirely up to you what you name your tags. When we’re working on a particular area of the application it is common to use a temporary tag like this - we’ll remove it before we check our code into source control.</p>
</div>
<div class="paragraph">
<p>Tags can be used for other purposes as well. If you have lots of scenarios it can be time-consuming to run them all every time. For example, you can tag a few of them with @smoke and run only those before you check in code to source control. <a href="#shot-1896" id="shot-1896" title="tag first and third scenario with @smoke" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: tag first and third scenario with @smoke</a> Running just the smoke tests will give you a certain level of confidence that nothing is broken without having to run them all. <a href="#shot-1897" id="shot-1897" title="filter for smoke" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: filter for smoke</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Trait:smoke</code></pre>
</div>
</div>
<div class="paragraph">
<p>We filtered the Test Explorer window but as you can see no scenarios are shown. This is because the list haven&#8217;t refreshed yet. In fact we haven&#8217;t even saved the file yet! We could save the file, build the project and run the tests, but the <strong>Run All</strong> command does all of these steps. <a href="#shot-1898" id="shot-1898" title="run all and open up hierarchies" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17.1: run all and open up hierarchies</a></p>
</div>
<div class="paragraph">
<p>Here it is! Now you probably understand better why learning the keyboard shortcut for this command helps a lot. <a href="#shot-1899" id="shot-1899" title="hover over run all" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17.2: hover over run all</a> Ctrl R,V!</p>
</div>
<div class="paragraph">
<p>Running the smoke tests gives you a quick feedback. If you’re running SpecFlow on a Continuous Integration Server as well, you could run all the scenarios there, detecting any regressions you might have missed by only running the smoke tests.</p>
</div>
<div class="paragraph">
<p>Tags give you a way to organize your scenarios that cut across feature files. You can think of them like sticky labels you might put into a book to mark interesting pages that you want to refer back to.</p>
</div>
<div class="paragraph">
<p>Some teams also use tags to reference external documents, for example, tickets in an issue tracker or planning tool. Let’s pretend we are using an issue tracker while working on Shouty and all the behaviour we built so far is related to the issue number 15. We could tag the whole feature file with this single line at the top. <a href="#shot-1900" id="shot-1900" title="tag feature with @issue:15" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: tag feature with @issue:15</a> All the scenarios within that file now inherit that tag, so if we filter for this tag, Visual Studio will run all the scenarios in the feature file. <a href="#shot-1901" id="shot-1901" title="filter for issue:15 and run all" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19: filter for issue:15 and run all</a></p>
</div>
<div class="paragraph">
<p>You can use more complex tag expressions to select the scenarios you want to run. For example, you could use a trait expression to exclude all the scenarios tagged as @slow. Let&#8217;s mark a few of them as slow&#8230;&#8203; <a href="#shot-1902" id="shot-1902" title="tag last two scenarios with @slow" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20: tag last two scenarios with @slow</a> and this time I build the project to show the filtering results. <a href="#shot-1903" id="shot-1903" title="build" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21: build</a> Then rewrite the trait expression in the search box to filter for the slow scenarios. <a href="#shot-1904" id="shot-1904" title="type expression: Trait:slow" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22: type expression: Trait:slow</a> Now if I add a dash ("-") to the front you can see all that are not slow. <a href="#shot-1905" id="shot-1905" title="change expression: -Trait:slow" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23: change expression: -Trait:slow</a> Now when we run the tests, the "@slow" scenarios won&#8217;t be run. <a href="#shot-1906" id="shot-1906" title="run all" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24: run all</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>-Trait:slow</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can read about how to build more complicated filter expressions in Visual Studio in the <a href="https://docs.microsoft.com/en-us/visualstudio/test/run-unit-tests-with-test-explorer?view=vs-2019#search-and-filter-the-test-list">Visual Studio documentation</a></p>
</div>
<div class="paragraph">
<p>There&#8217;s one more thing to learn about tags. They can be combined with hooks, so that you can be selective about which hooks to run when. We&#8217;ll cover that in a future chapter.</p>
</div>
<div class="sect3">
<h4 id="_lesson_1_questions_2">6.1.1. Lesson 1 - Questions</h4>
<div class="sect4">
<h5 id="_which_of_the_filter_expressions_below_would_cause_the_scenario_two_to_be_included_in_a_visual_studio_test_explorer_run_based_on_this_feature_file_steps_omitted_multiple_choice">Which of the filter expressions below would cause the scenario "Two" to be included in a Visual Studio Test Explorer run based on this feature file (steps omitted): <strong> MULTIPLE_CHOICE </strong></h5>
<div class="paragraph">
<p>@MVP
Feature: My feature</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Rule: rule A
  Scenario: One</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>@smoke
@slow @regression-pack
Scenario: Two</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>@regression-pack @pricing
Scenario: Three</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Two ----TRUE</p>
</li>
<li>
<p>Scenario: Two ----FALSE</p>
</li>
<li>
<p>Trait:regression-pack ----TRUE</p>
</li>
<li>
<p>Trait:MVP ----TRUE</p>
</li>
<li>
<p>-Trait:pricing ----TRUE</p>
</li>
<li>
<p>Trait:@smoke ----FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Tags are inherited from the enclosing scope, so a Scenario inherits tags from the Feature. At present Rules cannot be tagged, although we expect this to be fixed in the near future, at which point tags will be inherited like this: Feature&#8594;Rule&#8594;Scenario.</p>
</div>
<div class="paragraph">
<p>Tags can be on the same line and on consecutive lines.</p>
</div>
<div class="paragraph">
<p>The filter expressions can contain the scenario name (without the 'Scenario' keyword) or a trait expression (Trait:smoke) that can filter for tags (without the '@' character). For excluding scenarios tagged with a specific tag, the trait expression has to be prefixed with a '-' (-Trait:pricing).</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_is_it_useful_to_learn_the_keyboard_shortcut_of_the_run_all_command_of_visual_studio_multiple_choice">Why is it useful to learn the keyboard shortcut of the "Run All" command of Visual Studio? <strong> MULTIPLE_CHOICE </strong></h5>
<div class="ulist">
<ul>
<li>
<p>Because the command can be used to quickly re-run the scenarios we want to focus on and configured as a filter expression.  ----TRUE</p>
</li>
<li>
<p>Because it runs all tests regardless of the configured filter expression. ----FALSE</p>
</li>
<li>
<p>Because the run all commands saves the modified files, builds the project and runs the tests in one step. ----TRUE</p>
</li>
<li>
<p>Because it increases your chance to win the 'Who knows more Visual Studio shortcuts' competition. ----FALSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Preparing a development environment where you can focus on the current task increases the productivity. Adding a @focus tag to the scenarios you&#8217;re working allows you to get fast feedback by re-running just those scenarios. The default shortcut of Visual Studio&#8217;s Test Explorer is Ctrl R,V.</p>
</div>
<div class="paragraph">
<p>These commands ensure that the changes are saved and the necessary projects compiled.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_scenarios_from_the_command_line">6.2. Running the scenarios from the command line</h3>
<div class="paragraph">
<p><a href="#shot-1907" id="shot-1907" title="show feature file with tagged scenarios" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: show feature file with tagged scenarios</a></p>
</div>
<div class="paragraph">
<p>In the previous lesson, we ran the SpecFlow scenarios in Visual Studio. That gives you the quick feedback that you need during development.</p>
</div>
<div class="paragraph">
<p>But we also would like to regularly ensure that the changes we made didn&#8217;t cause any regressions. For that we can kick off the full test execution on a Continuous Integration Server or from a console on your local machine so we can keep working on other things while it&#8217;s finished.</p>
</div>
<div class="paragraph">
<p>It does not matter whether you need to configure your Continuous Integration build or you want to run the test from a console locally, the .NET command line tools have to be used for this. But fortunately it is pretty easy.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s open a CMD console or a PowerShell window and change the directory to the folder of your project. <a href="#shot-1908" id="shot-1908" title="open cmd and cd to project folder" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: open cmd and cd to project folder</a></p>
</div>
<div class="paragraph">
<p>Now use the <code>dotnet test</code> command. <a href="#shot-1909" id="shot-1909" title="type 'dotnet test' and run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: type 'dotnet test' and run</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet test</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>dotnet test</strong> command is part of the cross-platform .NET framework, so you can do the same on Linux or on macOS as well. And also inside a Docker container of course.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Starting test execution, please wait...
A total of 1 test files matched the specified pattern.

Passed!  - Failed:     0, Passed:     5, Skipped:     0, Total:     5, Duration: 99 ms - Shouty.Specs.dll (netcoreapp3.1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output is not very verbose but it clearly shows that all of our test were passing, so our changes did not cause any unwanted side-effects. Good to know.</p>
</div>
<div class="paragraph">
<p>We wanted to perform a full regression test by running the tests from the command line, therefore we did not apply any filters. But sometimes we need to. Maybe we just want to run the smoke tests.</p>
</div>
<div class="paragraph">
<p>The <strong>dotnet test</strong> command provides a <code>--filter</code> option where you can specify a filter expression. In the previous lesson we discussed that SpecFlow converts tags to test categories or traits. In Visual Studio we used a trait expression, but unfortunately the same expression won&#8217;t work here. The exact expression syntax that has to be used depends on the test execution framework you use. Since we&#8217;re use xUnit, we have to filter using the <code>Category=smoke</code> expression. <a href="#shot-1910" id="shot-1910" title="type dotnet test --filter Category=smoke" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: type dotnet test --filter Category=smoke</a> In MsTest and NUnit we would have to say <code>TestCategory</code> instead of <code>Category</code>, <a href="#shot-1911" id="shot-1911" title="change to dotnet test --filter TestCategory=smoke" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: change to dotnet test --filter TestCategory=smoke</a> but the expression is otherwise the same. Let&#8217;s fix this for xUnit and run the tests. <a href="#shot-1912" id="shot-1912" title="change back to dotnet test --filter Category=smoke, run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: change back to dotnet test --filter Category=smoke, run</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet test --filter Category=smoke</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Starting test execution, please wait...
A total of 1 test files matched the specified pattern.

Passed!  - Failed:     0, Passed:     2, Skipped:     0, Total:     2, Duration: 77 ms - Shouty.Specs.dll (netcoreapp3.1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, only two tests ran, so the filtering worked.</p>
</div>
<div class="paragraph">
<p>You can also use the filter expression to exclude tagged scenarios from the execution. For that you have to use the not equal operator. Let&#8217;s exclude the slow tests now. <a href="#shot-1913" id="shot-1913" title="type --filter Category!=slow" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7.1: type --filter Category!=slow</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet test --filter Category!=slow</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, with MsTest or NUnit you would need to use TestCategory here. <a href="#shot-1914" id="shot-1914" title="run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7.2: run</a> You can compose even more complex filter expressions for dotnet test. It is worth checking out the <a href="https://docs.microsoft.com/en-us/dotnet/core/testing/selective-unit-tests?pivots=xunit">documentation</a> for details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Starting test execution, please wait...
A total of 1 test files matched the specified pattern.

Passed!  - Failed:     0, Passed:     3, Skipped:     0, Total:     3, Duration: 99 ms - Shouty.Specs.dll (netcoreapp3.1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Teams often use such filters on the Continuous Integration Server if they write - or we can say formulate - the scenarios some time before the actual implementation work starts. Having these scenarios in source control would cause the build fail although there is nothing wrong with the implementation. We just have tests that are not supposed to pass yet. If the team agree to tag these scenarios, for example with <code>@formulated</code> than they can easily exclude them on the build server with this expression. <a href="#shot-1915" id="shot-1915" title="type dotnet test --filter TestCategory!=formulated and run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: type dotnet test --filter TestCategory!=formulated and run</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet test --filter Category!=formulated</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Starting test execution, please wait...
A total of 1 test files matched the specified pattern.

Passed!  - Failed:     0, Passed:     5, Skipped:     0, Total:     5, Duration: 99 ms - Shouty.Specs.dll (netcoreapp3.1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Seeing all these scenarios pass means that we are progressing well. Just don&#8217;t forget to remove the @formulated tag once you are done!</p>
</div>
<div class="paragraph">
<p>In this lesson you&#8217;ve learnt how to run scenarios from the command line and how to filter the set of scenarios to run using tags. On the Continuous Integration Server we probably also want to preserve and publish the test results. We&#8217;ll cover that in lesson 4.</p>
</div>
<div class="sect3">
<h4 id="_lesson_2_questions_4">6.2.1. Lesson 2 - Questions</h4>
<div class="sect4">
<h5 id="_which_of_the_commands_below_would_run_all_scenarios_not_tagged_with_slow_when_executed_from_a_specflow_project_folder_that_has_been_configured_to_use_mstest">Which of the commands below would run all scenarios NOT tagged with @slow when executed from a SpecFlow project folder that has been configured to use MsTest?</h5>
<div class="ulist">
<ul>
<li>
<p>dotnet test --filter Category!=slow</p>
</li>
<li>
<p>dotnet test --filter TestCategory!=slow ----TRUE</p>
</li>
<li>
<p>dotnet test --filter TestCategory!=@slow</p>
</li>
<li>
<p>dotnet test --filter -Trait:slow</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
SpecFlow converts Gherkin tags into test categories for the configured test execution framework. When using <code>dotnet test</code>, the filter expression syntax you should use depends on the test execution framework. With MsTest and NUnit, the <code>TestCategory</code> keyword has to be used, while xUnit uses 'Category'.</p>
</div>
<div class="paragraph">
<p>For the test category expression the <code>=</code> and the <code>!=</code> operators can be used. The tag name has to be supplied without the <code>@</code> character.</p>
</div>
<div class="paragraph">
<p>The trait expressions used in Visual Studio Test Explorer cannot be used for <code>dotnet test</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_more_control">6.3. More Control</h3>
<div class="paragraph">
<p><a href="#shot-1916" id="shot-1916" title="feature file is open" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: feature file is open</a></p>
</div>
<div class="paragraph">
<p>SpecFlow is first and foremost a tool that facilitates a common understanding between people on a project. To be able to express the domain requirements of projects implemented specifically for a non-English speaking local market, translating everything to English might be a barrier. In this case it is better to describe the requirements in the spoken language the stakeholders speak.</p>
</div>
<div class="paragraph">
<p>SpecFlow supports over 70 different languages, thanks to contributions from people from all over the world.</p>
</div>
<div class="paragraph">
<p>To see the translation of the Gherkin keywords for a particular language, check out the <a href="https://cucumber.io/docs/gherkin/languages/">Gherkin syntax documentation</a>. <a href="#shot-1917" id="shot-1917" title="open docs" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2.1: open docs</a> For example, this is how the keywords translate to Hungarian. <a href="#shot-1918" id="shot-1918" title="scroll to Hungarian" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2.2: scroll to Hungarian</a></p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how someone would create a feature file written in a different spoken language. I will do this for the Hungarian language, but you can choose another language you speak.</p>
</div>
<div class="paragraph">
<p>For that we can add a new feature file first&#8230;&#8203; and make it empty. <a href="#shot-1919" id="shot-1919" title="add feature file, delete content" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: add feature file, delete content</a></p>
</div>
<div class="paragraph">
<p>The first line tells SpecFlow which language the feature file is written in. <a href="#shot-1920" id="shot-1920" title="" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4</a></p>
</div>
<div class="listingblock">
<div class="title">Hungarian.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="c">#language: hu-HU</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can start writing our feature file. Remember, it should start with the feature keyword. The auto-complete feature of the Visual Studio integration is for your help. <a href="#shot-1921" id="shot-1921" title="invoke auto-complete, choose 'Jellemző'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: invoke auto-complete, choose 'Jellemző'</a> It shows which keyword I should use. <a href="#shot-1922" id="shot-1922" title="finish line" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: finish line</a></p>
</div>
<div class="listingblock">
<div class="title">Hungarian.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="c">#language: hu-HU</span>

<span class="kd">Jellemző</span><span class="p">:</span> <span class="err">Kiáltás</span> <span class="err">meghallása</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can keep editing the file by adding a scenario. In the selected language, of course&#8230;&#8203; <a href="#shot-1923" id="shot-1923" title="add scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: add scenario</a></p>
</div>
<div class="listingblock">
<div class="title">Hungarian.feature</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="gherkin"><span class="c">#language: hu-HU</span>

<span class="kd">Jellemző</span><span class="p">:</span> Kiáltás meghallása

<span class="kn">Forgatókönyv</span><span class="p">:</span> <span class="nf">A </span>hallható meghall egy üzenetet
	<span class="nf">Adott </span>egy ember Sean
	<span class="nf">És </span>egy ember Lucy
	<span class="nf">Ha </span>Sean azt kiáltja, hogy <span class="s">"Ingyen bagel a Sean's-nál"</span>
	<span class="nf">Akkor </span>Lucynak meg kell hallania Sean üzenetét</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is Cucumber School and not a Hungarian lesson, but you might have guessed that my scenario tells the same story that we described in the "Listener hears a message" scenario earlier. <a href="#shot-1924" id="shot-1924" title="show 'Listener hears a message' scenario" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: show 'Listener hears a message' scenario</a> But if we look at this new scenario <a href="#shot-1925" id="shot-1925" title="switch back to the hungarian, highlight orange steps" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: switch back to the hungarian, highlight orange steps</a> we can see that Visual Studio reports the steps as undefined. This is because we have used the English step texts in our Cucumber Expressions. <a href="#shot-1926" id="shot-1926" title="jump to stepdef GivenAPersonNamed" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: jump to stepdef GivenAPersonNamed</a> In order to make this pass, we would need to add step definitions with Hungarian texts in the expressions or add an additional Given, When or Then attribute to our step definition methods with the Hungarian text, like this. <a href="#shot-1927" id="shot-1927" title="add hun Given attribute to the method" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: add hun Given attribute to the method</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#"><span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"egy ember {word}"</span><span class="p">)]</span>
<span class="p">[</span><span class="nf">Given</span><span class="p">(</span><span class="s">"a person named {word}"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAPersonNamed</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">people</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="m">0</span><span class="p">));</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we build the project, the first two steps appear to be defined now. <a href="#shot-1928" id="shot-1928" title="build and see the feature file coloring changing" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: build and see the feature file coloring changing</a></p>
</div>
<div class="paragraph">
<p>We can fix the other two step definitions as well&#8230;&#8203; <a href="#shot-1929" id="shot-1929" title="add the two other attributes, run tests" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: add the two other attributes, run tests</a> and we have our first Hungarian shouty scenario pass! <a href="#shot-1930" id="shot-1930" title="show new scenario in the test explorer window" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: show new scenario in the test explorer window</a></p>
</div>
<div class="listingblock">
<div class="title">StepDefinitions.cs</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="c#"><span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean azt kiáltja, hogy {string}"</span><span class="p">)]</span>
<span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts {string}"</span><span class="p">)]</span>
<span class="p">[</span><span class="nf">When</span><span class="p">(</span><span class="s">"Sean shouts the following message"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">WhenSeanShoutsAMessage</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">people</span><span class="p">[</span><span class="s">"Sean"</span><span class="p">].</span><span class="nf">Shout</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="n">messageFromSean</span> <span class="p">=</span> <span class="n">message</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucynak meg kell hallania Sean üzenetét"</span><span class="p">)]</span>
<span class="p">[</span><span class="nf">Then</span><span class="p">(</span><span class="s">"Lucy should hear Sean's message"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">ThenLucyShouldHearSeansMessage</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Assert</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">messageFromSean</span><span class="p">,</span> <span class="n">people</span><span class="p">[</span><span class="s">"Lucy"</span><span class="p">].</span><span class="nf">GetMessagesHeard</span><span class="p">());</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Usually the feature file languages are not mixed within a project. If you don&#8217;t want to add the same language header line <a href="#shot-1931" id="shot-1931" title="highlight #language" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: highlight #language</a> to all of the feature files, you can also change the default feature file language in SpecFlow.</p>
</div>
<div class="paragraph">
<p>For that we need to add a SpecFlow configuration file to our project. The SpecFlow configuration file is a simple JSON file, named <code>specflow.json</code>. <a href="#shot-1932" id="shot-1932" title="add specflow.json" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: add specflow.json</a>. This file needs to be copied to the output directory. <a href="#shot-1933" id="shot-1933" title="set 'copy to output directory' to 'copy if newer'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17: set 'copy to output directory' to 'copy if newer'</a></p>
</div>
<div class="paragraph">
<p>As there is no auto-complete support for this file, it&#8217;s easiest to check out the <a href="https://docs.specflow.org/projects/specflow/en/latest/Installation/Configuration.html">SpecFlow documentation</a>. <a href="#shot-1934" id="shot-1934" title="open doc" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: open doc</a> The first example here does exactly what we want, so we can just copy and paste it into our project, <a href="#shot-1935" id="shot-1935" title="copy paste sample" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 19: copy paste sample</a> and change the language to the one we have chosen. <a href="#shot-1936" id="shot-1936" title="set lang to hu-hu" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20: set lang to hu-hu</a></p>
</div>
<div class="listingblock">
<div class="title">specflow.json</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"language"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"feature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hu-HU"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When we build the project, <a href="#shot-1937" id="shot-1937" title="build, show errors" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21: build, show errors</a> we got lots of errors from our English feature file. This is because we changed the default and this file does not have a language setting at the top. <a href="#shot-1938" id="shot-1938" title="show eng feature file, fix by adding #language: en-US" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22: show eng feature file, fix by adding #language: en-US</a> But the new file works without the language setting now&#8230;&#8203; <a href="#shot-1939" id="shot-1939" title="switch to hun, remove language setting" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23: switch to hun, remove language setting</a></p>
</div>
<div class="paragraph">
<p>In Chapter 3 we talked about step definition parameters and that SpecFlow helps you to convert them to a .NET data type. SpecFlow performs these conversions using the feature file language. So for example if you include a fractional number that needs to be converted to double, SpecFlow will expect the decimal separator character used in the language of your feature file. In the Hungarian language for example, a comma is used as the decimal separator instead of a dot. This is also important for date conversions.</p>
</div>
<div class="paragraph">
<p>This default behavior can be changed by explicitly declaring what culture setting SpecFlow should use for conversions. For example we can force the conversions to be made using US English culture even in Hungarian feature files. <a href="#shot-1940" id="shot-1940" title="change config file to" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24: change config file to</a></p>
</div>
<div class="listingblock">
<div class="title">specflow.json</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"language"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"feature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hu-HU"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"bindingCulture"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are a few other things you can configure that you can find in the documentation. <a href="#shot-1941" id="shot-1941" title="switch to doc, scroll through to the bottom" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 25: switch to doc, scroll through to the bottom</a> It&#8217;s worth highlighting the one that can instruct SpecFlow to load step definitions from other external projects as well. <a href="#shot-1942" id="shot-1942" title="highlight stepAssemblies" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 26: highlight stepAssemblies</a> This is useful in bigger applications with multiple SpecFlow projects.</p>
</div>
<div class="paragraph">
<p>For the rest of this chapter, let&#8217;s remove the non-English feature file and reset the configuration by removing the <code>specflow.json</code> file. <a href="#shot-1943" id="shot-1943" title="remove Hungarian.feature, specflow.json" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 27: remove Hungarian.feature, specflow.json</a></p>
</div>
<div class="paragraph">
<p>That&#8217;s quite a lot to digest, but to make SpecFlow really useful to your team, it’s good to spend some time learning the details of how to configure it. In this lesson, we showcased the SpecFlow configuration options and you learned how to write your scenarios in different spoken languages.</p>
</div>
<div class="sect3">
<h4 id="_lesson_3_questions_2">6.3.1. Lesson 3 - Questions</h4>
<div class="sect4">
<h5 id="_which_of_the_following_first_lines_changes_the_language_of_a_feature_file">Which of the following first lines changes the language of a feature file?</h5>
<div class="ulist">
<ul>
<li>
<p># language: hu-HU ----TRUE</p>
</li>
<li>
<p>! language: hu-HU</p>
</li>
<li>
<p>language: hu-HU</p>
</li>
<li>
<p># i18n: hu-HU</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
Gherkin supports lots of languages on a per feature file basis. It has to be the first line in the feature file, and has to be a comment with the content <code>language: &lt;language_identifier&gt;</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_how_can_you_configure_the_behavior_of_specflow">How can you configure the behavior of SpecFlow?</h5>
<div class="ulist">
<ul>
<li>
<p>By adding a file 'specflow.json' to the project root and enable "Copy to output folder" ----TRUE</p>
</li>
<li>
<p>By adding a file 'config.json' to the project in any folder</p>
</li>
<li>
<p>By adding a file 'specflow.yaml' to the project root and enable "Copy to output folder"</p>
</li>
<li>
<p>By adding a file 'specflow.json' to the project in any folder</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
SpecFlow configuration settings can be provided by adding a JSON file named 'specflow.json' to the project root and enabling "Copy to output folder" for the file. A reference guide of the possible settings can be found in the <a href="https://docs.specflow.org/projects/specflow/en/latest/Installation/Configuration.html">documentation</a>. For backwards compatibility you can also specify the settings in an XML configuration file or in the App.config file for older projects.</p>
</div>
<div class="paragraph">
<p>The test execution framework (MsTest, NUnit, etc.) and other plugins can be enabled by adding the appropriate NuGet package (e.g. SpecFlow.MsTest) to the project references.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dealing_with_execution_results">6.4. Dealing with execution results</h3>
<div class="paragraph">
<p><a href="#shot-1944" id="shot-1944" title="show output of the test execution in a command line shell, Hungarian feature file and specflow.json removed from the project" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: show output of the test execution in a command line shell, Hungarian feature file and specflow.json removed from the project</a></p>
</div>
<div class="paragraph">
<p>In the previous lessons we&#8217;ve learnt how to configure SpecFlow and how to run scenarios from Visual Studio and from the command line. The test output we have seen there contains a brief summary of the execution and the failures. If the test were executed on a Continuous Integration Server we probably also want to preserve and publish the test results. This is what we will look at in this lesson.</p>
</div>
<div class="paragraph">
<p>The <code>dotnet test</code> tool outputs the execution results through configurable loggers. The logger can be specified using the <code>--logger</code> option. There are multiple logger providers you can choose from. You can even write your own. But most of the teams use the TRX logger, that saves the execution results into a <strong>Visual Studio Test Results</strong> or TRX file. Let&#8217;s use this. <a href="#shot-1945" id="shot-1945" title="type dotnet test --logger trx, run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: type dotnet test --logger trx, run</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet test --logger trx</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Starting test execution, please wait...
A total of 1 test files matched the specified pattern.
Results File: W:\CucumberSchool\bdd-with-cucumber-code-dotnet\Shouty\Shouty.Specs\TestResults\gaspar_SPECSOL-D01_2021-01-22_15_46_29.trx

Passed!  - Failed:     0, Passed:     5, Skipped:     0, Total:     5, Duration: 137 ms - Shouty.Specs.dll (netcoreapp3.1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The execution finished and reported that the results <a href="#shot-1946" id="shot-1946" title="highlight test result file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: highlight test result file</a> have been saved to a file that has the current timestamp inside the TestResults folder of the project. Let&#8217;s look at this file.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1947" id="shot-1947" title="open file explorer by typing <code>explorer .</code>, go to TestResults folder, highlight trx file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: open file explorer by typing <code>explorer .</code>, go to TestResults folder, highlight trx file</a>
Visual Studio has been associated to this file extension, so if I open this file from file explorer <a href="#shot-1948" id="shot-1948" title="double-click on the file" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: double-click on the file</a>, it opens it in Visual Studio. <a href="#shot-1949" id="shot-1949" title="show test results" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: show test results</a> We can see all the individual test executions and even the details <a href="#shot-1950" id="shot-1950" title="show details of one of that" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: show details of one of that</a> of each of them where we see the step execution results.</p>
</div>
<div class="paragraph">
<p>The TRX files are XML files so it is easy to make any tools that processes the results and converts them to another format. It is, for example, a common expectation to present the execution results as an HTML file that can be checked by all stakeholders even if they don&#8217;t have Visual Studio.</p>
</div>
<div class="paragraph">
<p>There are many small open source tools that can do such a conversion. <a href="#shot-1951" id="shot-1951" title="show github project in a browser" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: show github project in a browser</a> For example the <a href="https://github.com/stevencohn/trxer">fork of the Trxer project by @stevencohn</a> on GitHub is a nice one that provides some dedicated styling for SpecFlow results.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1952" id="shot-1952" title="back to console" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: back to console</a>
This one is a .NET assembly that I downloaded earlier, so now I can invoke it with the dotnet command we have seen already. <a href="#shot-1953" id="shot-1953" title="type command and run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: type command and run</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet &lt;TrxReporter-path&gt;\TrxReporter\TrxReporter.dll --input TestResults\gaspar_SPECSOL-D01_2021-01-22_15_46_29.trx</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is a single HTML file that I could publish to my team workspace or just open locally. <a href="#shot-1954" id="shot-1954" title="open HTML by typing start path-to-html" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: open HTML by typing start path-to-html</a> It shows the execution summary <a href="#shot-1955" id="shot-1955" title="show summary and highlight details" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: show summary and highlight details</a> as well as the individual scenario results grouped by features.</p>
</div>
<div class="paragraph">
<p>The TRX file format is also understood by most of the Continuous Integration platforms as well, so they can show the details included in the build results or even highlight whether the same tests were failing for the first time.</p>
</div>
<div class="paragraph">
<p>Processing the TRX file on the build server is not that easy with non-deterministic file names. In this case it is more useful to specify the output file name for the TRX logger. This can be done by specifying the <code>logfilename</code> parameter of the TRX logger like this. <a href="#shot-1956" id="shot-1956" title="type command and run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: type command and run</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet test --logger trx;logfilename=shouty-result.trx</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#shot-1957" id="shot-1957" title="show soecflow+ livingdoc page" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: show soecflow+ livingdoc page</a>
The <a href="https://specflow.org/blog/introducing-the-specflow-plus-livingdoc-generator/">SpecFlow+ LivingDoc Generator</a> from the Tricentis SpecFlow team uses a slightly different approach. This free tool does not process the TRX file, but produces its own result file and from that it is able to generate comprehensive documentation of your requirements based on the feature files and the scenarios you defined. Although the generated documentation also contains the test results, its primary focus is to produce the so-called <strong>Living Documentation</strong>&#8201;&#8212;&#8201;documentation that shows whether the application currently fulfills the requirements.</p>
</div>
<div class="paragraph">
<p>In order to setup SpecFlow+ LivingDoc Generator, we need to install the <code>SpecFlow.Plus.LivingDocPlugin</code> NuGet package. <a href="#shot-1958" id="shot-1958" title="invoke dotnet add package command" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15.1: invoke dotnet add package command</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet add package SpecFlow.Plus.LivingDocPlugin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s run the tests. We don&#8217;t need the TRX file now, so running <code>dotnet test</code> is enough. <a href="#shot-1959" id="shot-1959" title="invoke dotnet test command" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15.2: invoke dotnet test command</a> The SpecFlow+ LivingDoc plugin generates a result file in the output folder, named <code>TestExecution.json</code> by default. <a href="#shot-1960" id="shot-1960" title="dir in folder, highlight TestExecution.json" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: dir in folder, highlight TestExecution.json</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dir bin\Debug\netcoreapp3.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here it is!</p>
</div>
<div class="paragraph">
<p>Now we need to run the actual generator. The generator has to be installed as a .NET tool for the project.</p>
</div>
<div class="paragraph">
<p>Since this is the first .NET tool that we have install for this project, we need to first initialize the .NET tool configuration. For that we need to go up to the solution folder in our console window <a href="#shot-1961" id="shot-1961" title="invoke cd .." style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 17: invoke cd ..</a> and invoke <code>dotnet new tool-manifest</code> <a href="#shot-1962" id="shot-1962" title="invoke command" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 18: invoke command</a>. This creates a file named  <code>dotnet-tools.json</code> in the <code>.config</code> folder of the solution. You should add this file to your source control.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;cd ..
C:\...\Shouty&gt;dotnet new tool-manifest
Getting ready...
The template "Dotnet local tool manifest file" was created successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can install the SpecFlow+ LivingDoc Generator. This can be done, using the <code>dotnet tool install</code> command that pulls the generator from NuGet.org and installs it for this project. <a href="#shot-1963" id="shot-1963" title="invoke command" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 20: invoke command</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty&gt;dotnet tool install SpecFlow.Plus.LivingDoc.CLI

You can invoke the tool from this directory using the following commands: 'dotnet tool run livingdoc' or 'dotnet livingdoc'.
Tool 'specflow.plus.livingdoc.cli' (version '3.5.286') was successfully installed. Entry is added to the manifest file W:\CucumberSchool\bdd-with-cucumber-code-dotnet\Shouty\.config\dotnet-tools.json.</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the message says, the tool has been installed successfully and can be used with <a href="#shot-1964" id="shot-1964" title="highlight dotnet livingdoc" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 21: highlight dotnet livingdoc</a> the <code>dotnet livingdoc</code> command.</p>
</div>
<div class="paragraph">
<p>First, let&#8217;s step back to our SpecFlow project folder and start with <code>dotnet livingdoc</code>. <a href="#shot-1965" id="shot-1965" title="cd to specs" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22.1: cd to specs</a><a href="#shot-1966" id="shot-1966" title="start typing" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 22.2: start typing</a> Now we need to specify a couple of settings for the generator. If you get lost, you can always call dotnet livingdoc help or check the <a href="https://docs.specflow.org/projects/specflow-livingdoc/en/latest/LivingDocGenerator/Generating-Documentation.html">documentation</a>.</p>
</div>
<div class="paragraph">
<p>We need to say <code>test-assembly</code>, <a href="#shot-1967" id="shot-1967" title="type test-assembly" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 23: type test-assembly</a> because we want to generate the result from an assembly, and we have to <a href="#shot-1968" id="shot-1968" title="type assembly name" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 24: type assembly name</a> specify the compiled assembly of our Shouty project.</p>
</div>
<div class="paragraph">
<p>Finally we need to <a href="#shot-1969" id="shot-1969" title="type rest of the command" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 25: type rest of the command</a> provide the path of the generated TestExecution.json file using the <code>--test-execution-json</code> option. And run. <a href="#shot-1970" id="shot-1970" title="run" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 26: run</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>C:\...\Shouty\Shouty.Specs&gt;dotnet livingdoc test-assembly bin\Debug\netcoreapp3.1\Shouty.Specs.dll --test-execution-json bin\Debug\netcoreapp3.1\TestExecution.json

W:\CucumberSchool\bdd-with-cucumber-code-dotnet\Shouty\Shouty.Specs\LivingDoc.html was successfully generated.</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve got the generated HTML file. <a href="#shot-1971" id="shot-1971" title="open html with start" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 27: open html with start</a> As you can see, the result focuses on the feature structure, <a href="#shot-1972" id="shot-1972" title="open structure, highlight results" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 28: open structure, highlight results</a> but the details are also displayed.</p>
</div>
<div class="paragraph">
<p>Since the result is a single HTML file, it is easy to share it with all stakeholders. If you use Azure DevOps to track your work items, you can use the integrated version of SpecFlow+ LivingDoc as well.</p>
</div>
<div class="paragraph">
<p>There are more and more tools that can help you to implement living documentation for SpecFlow, <a href="#shot-1973" id="shot-1973" title="show page" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 29: show page</a> like <a href="https://www.picklesdoc.com/">Pickles Doc</a>, <a href="#shot-1974" id="shot-1974" title="show page" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 30: show page</a><a href="https://github.com/Augurk/Augurk">Augurk</a> or <a href="#shot-1975" id="shot-1975" title="show page" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 31: show page</a> <a href="https://www.specsolutions.eu/specsync/">SpecSync for Azure DevOps</a>. The SmartBear Cucumber team is working on a platform <a href="#shot-1976" id="shot-1976" title="show page" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 32: show page</a> called <a href="https://reports.cucumber.io/">Cucumber Reports</a> that can be used to publish and share living documentation. At the time of the recording this is not yet available for SpecFlow, but hopefully it will be soon.</p>
</div>
<div class="paragraph">
<p>In this lesson we have enumerated a couple of options to share your results and your living documentation with the entire team. This is essential in order to facilitate a common understanding between people on the project&#8201;&#8212;&#8201;which is our ultimate goal.</p>
</div>
<div class="paragraph">
<p>With that we finished this chapter. See you next time!</p>
</div>
<div class="sect3">
<h4 id="_lesson_4_questions_3">6.4.1. Lesson 4 - Questions</h4>
<div class="sect4">
<h5 id="_which_of_the_commands_below_would_run_all_scenarios_and_save_the_execution_results_to_a_file_result_trx">Which of the commands below would run all scenarios and save the execution results to a file 'result.trx'?</h5>
<div class="ulist">
<ul>
<li>
<p>dotnet test --logger trx</p>
</li>
<li>
<p>dotnet test --out result.trx</p>
</li>
<li>
<p>dotnet test --logger trx;logfilename=result.trx ----TRUE</p>
</li>
<li>
<p>TRX file format is not supported by <code>dotnet test</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Explanation:
The test output of the <code>dotnet test</code> command can be configured by specifying a logger. The trx logger can be used for saving the results to a TRX file. By default it saves the result to a file name containing the current timestamp. To use a deterministic filename, the <code>logfilname</code> parameter has to be provided.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_is_it_valuable_to_generate_reports_about_the_specflow_test_execution_results_multiple_choice">Why is it valuable to generate reports about the SpecFlow test execution results? <strong> MULTIPLE-CHOICE </strong></h5>
<div class="ulist">
<ul>
<li>
<p>The readable report can help the business stakeholders follow the progress of the implementation and therefore increases trust. ----TRUE</p>
</li>
<li>
<p>Without HTML reports, the test execution results cannot be checked.</p>
</li>
<li>
<p>It is easier to assess the impact of a test failure when it is connected to the business expectations. ----TRUE</p>
</li>
<li>
<p>It is easier to quickly react to failures coming from the Continuous Integration Server (CI) when you don&#8217;t need special tools, like Visual Studio to view the results. ----TRUE</p>
</li>
<li>
<p>The reports are not directly valuable, they are just required to fulfill the policies of the development process.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_details">7. Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the last lesson we took a break from the code to sharpen up your skills with Cucumber’s command-line interface.</p>
</div>
<div class="paragraph">
<p>Now it’s time to dive right back into the code. We’re going to explore one of the hottest topics that teams come across when they start to get to grips with Cucumber and BDD: how much detail to use in your scenarios.</p>
</div>
<div class="paragraph">
<p>Many teams find they can’t easily agree on this. It can often seem like a matter of personal preference. It’s true there are no right and wrong answers, but we’re going to teach you some heuristics you can apply to help you make better decisions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_mapping">8. Example Mapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="#shot-1977" id="shot-1977" title="Animation of Matt talking to camera" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: Animation of Matt talking to camera</a></p>
</div>
<div class="paragraph">
<p>In the last lesson we saw how easily incidental details can creep into your scenarios, talked about why they’re a problem, and showed you some techniques for massaging them back out again.
But, as we pushed the details out of our scenarios, we made the step definition code more complicated. We promised to show you how to deal with that extra complexity, and we&#8217;re going to get to that in the next chapter, Chapter 9.</p>
</div>
<div class="paragraph">
<p>First though, we want to look at how we could have prevented the Premium Accounts feature from getting into such a mess in the first place.</p>
</div>
<div class="paragraph">
<p>We&#8217;re going to learn about a practice called Example Mapping, a way to structure the conversation between the <em>Three Amigos</em> - Tester, Developer and Product Owner - to develop shared understanding before you write any code.</p>
</div>
<div class="sect2">
<h3 id="_example_mapping_why">8.1. Example Mapping: Why?</h3>
<div class="paragraph">
<p><a href="#shot-1978" id="shot-1978" title="BDD circles diagram" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: BDD circles diagram</a>
In terms of the three practices we introduced in Chapter 1 - Discovery, Formulation and Automation - what went wrong with the Premium Accounts feature?</p>
</div>
<div class="paragraph">
<p>Thinking about it, we can see that the development team
<a href="#shot-1979" id="shot-1979" title="BDD circles diagram - (1) pointing to Automation" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: BDD circles diagram - (1) pointing to Automation</a>
jumped straight into <em>Automation</em> - writing the implementation of the feature. They did the bare minimum of
<a href="#shot-1980" id="shot-1980" title="BDD circles diagram - (2) pointing to Formulation" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: BDD circles diagram - (2) pointing to Formulation</a>
<em>Formulation</em> - just enough to automate a test for the feature, but really we did a lot of the Formulation later on as we cleaned it up. Finally, much of the
<a href="#shot-1981" id="shot-1981" title="BDD circles diagram - (3) pointing to Discovery" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: BDD circles diagram - (3) pointing to Discovery</a>
<em>Discovery</em> happened at the end once Tamsin had a chance to test the feature by hand.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1982" id="shot-1982" title="BDD circles diagram - draw a red 'X' over the three arrows" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: BDD circles diagram - draw a red 'X' over the three arrows</a>
So in essence, they did everything backwards.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1983" id="shot-1983" title="Animation ending with 'Deliberate Discovery'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: Animation ending with 'Deliberate Discovery'</a>
In software projects, it’s often the unknown unknowns that can make the biggest difference between success and failure. In BDD, we always try to assume we’re ignorant of some important information and try to <em>deliberately discover</em> those unknown unknowns as early as possible, so they don’t surprise us later on.</p>
</div>
<div class="paragraph">
<p>A team that invests just a little bit extra in Discovery, before they write any code, saves themselves a huge amount of wasted time further down the line.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1984" id="shot-1984" title="Animation introducing three people, showing them talking" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: Animation introducing three people, showing them talking</a>
In lesson 1, we showed you an example of the <em>Three Amigos</em> - Tester, Developer and Product owner - having a conversation about a new user story.</p>
</div>
<div class="paragraph">
<p>Nobody likes long meetings, so we’ve developed a simple framework for this conversation that keeps it quick and effective. We call this
<a href="#shot-1985" id="shot-1985" title="Example Mapping" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: Example Mapping</a>
<em>Example Mapping</em>.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1986" id="shot-1986" title="diagram: User Story &#8594; Example Mapping" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: diagram: User Story &#8594; Example Mapping</a></p>
</div>
<div class="paragraph">
<p>An Example Mapping session takes a single User Story as input, and aims to produce four outputs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Business Rules,
<a href="#shot-1987" id="shot-1987" title="diagram: &#8594; Rules" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: diagram: &#8594; Rules</a>
that must be satisified for the story to be implemented correctly</p>
</li>
<li>
<p>Examples
<a href="#shot-1988" id="shot-1988" title="diagram: &#8594; Examples" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: diagram: &#8594; Examples</a>
of those business rules playing out in real-world scenarios</p>
</li>
<li>
<p>Questions or Assumptions
<a href="#shot-1989" id="shot-1989" title="diagram: &#8594; Questions" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: diagram: &#8594; Questions</a>
that the group of people in the conversation need to deal with soon, but cannot resolve during the immediate conversation</p>
</li>
<li>
<p>New User Stories
<a href="#shot-1990" id="shot-1990" title="diagram: &#8594; New User Stories" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: diagram: &#8594; New User Stories</a>
sliced out from the one being discussed in order to simplify it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We capture these, as we talk, using index cards, or another virtual equivalent.</p>
</div>
<div class="paragraph">
<p>Working with these simple artefacts rather than trying to go straight to formulating Gherkin, allows us to keep the conversation at the right level - seeing the whole picture of the user story without getting lost in details.</p>
</div>
<div class="sect3">
<h4 id="_lesson_1_questions_3">8.1.1. Lesson 1 - Questions</h4>
<div class="sect4">
<h5 id="_why_did_we_say_the_development_teams_initial_attempt_at_the_premium_accounts_feature_was_done_backwards">Why did we say the development team&#8217;s initial attempt at the premium accounts feature was "done backwards"?</h5>
<div class="ulist">
<ul>
<li>
<p>They did Discovery before Automation</p>
</li>
<li>
<p>They did Discovery before Formulation</p>
</li>
<li>
<p>They started with Automation, without doing enough Discovery or Formulation first (<strong>Correct</strong>)</p>
</li>
<li>
<p>They started with Discovery, then did Formulation and finally Automation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>The intended order is Discovery, Formulation then Automation. Each of these steps teaches us a little more about the problem.</p>
</div>
<div class="paragraph">
<p>Our observation was that the the team jumped straight into coding (Automation), retro-fitting a scenario later. The discovery only happened when Tamsin tested the feature.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_does_deliberate_discovery_mean_multiple_choice">What does "Deliberate Discovery" mean (Multiple choice)</h5>
<div class="ulist">
<ul>
<li>
<p>One person is responsible for gathering the requirements</p>
</li>
<li>
<p>Discovery is something you can only do in collaboration with others</p>
</li>
<li>
<p>Having the humility to assume there are things you don&#8217;t yet understand about the problem you&#8217;re working on (<strong>Correct</strong>)</p>
</li>
<li>
<p>Embracing your ignorance about what you&#8217;re building (<strong>Correct</strong>)</p>
</li>
<li>
<p>There are no unknown unknowns on your project</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>Deliverate Discovery means we assume that there are important things we don&#8217;t yet know about the project we&#8217;re working on, and so make a deliberate effort to look for them at every opportunity.</p>
</div>
<div class="paragraph">
<p>Although we very much encouage doing that collaboratively, it&#8217;s not the main emphasis here.</p>
</div>
<div class="paragraph">
<p>Read Daniel Terhorst-North&#8217;s <a href="https://dannorth.net/2010/08/30/introducing-deliberate-discovery/">original blog post</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_is_it_a_good_idea_to_try_and_slice_a_user_story">Why is it a good idea to try and slice a user story?</h5>
<div class="ulist">
<ul>
<li>
<p>Working in smaller pieces allows us to iterate and get feedback faster (<strong>Correct</strong>)</p>
</li>
<li>
<p>We can defer behaviour that&#8217;s lower priority (<strong>Correct</strong>)</p>
</li>
<li>
<p>Smaller stories are less likely to contain unknown unknowns (<strong>Correct</strong>)</p>
</li>
<li>
<p>Doing TDD and refactoring becomes much easier when we proceed in small steps (<strong>Correct</strong>)</p>
</li>
<li>
<p>Small steps help us keep momentum, which is motivating (<strong>Correct</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>Just like grains of sand flow through the neck of a bottle faster than pebbles, the smaller you can slice your stories, the faster they will flow through your development team.</p>
</div>
<div class="paragraph">
<p>It&#8217;s important to preserve stories as a <em>vertical slice</em> right through your application, that changes the behaviour of the system from the point of view of a user, even in a very simple way.</p>
</div>
<div class="paragraph">
<p>That&#8217;s why we call it slicing rather than splitting.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_did_we_discourage_doing_formulation_as_part_of_an_example_mapping_conversation">Why did we discourage doing Formulation as part of an Example Mapping conversation?</h5>
<div class="ulist">
<ul>
<li>
<p>Trying to write Gherkin slows the conversation down, which means you might miss the bigger picture. (<strong>Correct</strong>)</p>
</li>
<li>
<p>It&#8217;s usually an unneccesary level of detail to go into when you&#8217;re trying to discover unknown unknowns. (<strong>Correct</strong>)</p>
</li>
<li>
<p>Formulation should be done by a separate team</p>
</li>
<li>
<p>One person should be in charge of the documentation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation</strong></p>
</div>
<div class="paragraph">
<p>This is why we&#8217;ve separated Discovery from Formulation. It&#8217;s better to stay relatively shallow and go for breadth at this stage - making sure you&#8217;ve looked over the entire user story without getting pulled into rabbit holes.</p>
</div>
<div class="paragraph">
<p>Product Owners and Domain Experts are often busy people who only have limited time with the team. Make the most of this time by keeping the conversation at the level where the team can learn the maximum amount from them.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_mapping_how">8.2. Example Mapping: How?</h3>
<div class="paragraph">
<p><a href="#shot-1991" id="shot-1991" title="index cards and pens" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: index cards and pens</a></p>
</div>
<div class="paragraph">
<p>We first developed example mapping in face-to-face meeting using a simple a multi-colour pack of index cards and some pens. For teams that are working remotely, there are many virtual equivalents of that nowadays.</p>
</div>
<div class="paragraph">
<p>We use the four different coloured cards to represent the four main kinds of information that arise in the conversation.</p>
</div>
<div class="paragraph">
<p>We can start with the easy stuff: Take a yellow card and write down the name of the story.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1992" id="shot-1992" title="write 'premium accounts' on a yellow card" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: write 'premium accounts' on a yellow card</a></p>
</div>
<div class="paragraph">
<p>Now, do we already know any rules or acceptance criteria about this story?</p>
</div>
<div class="paragraph">
<p>Write each rule down on a blue card:</p>
</div>
<div class="paragraph">
<p><a href="#shot-1993" id="shot-1993" title="write two rules on blue cards" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: write two rules on blue cards</a></p>
</div>
<div class="paragraph">
<p>They look pretty straightforward, but let’s explore them a bit by coming up with some examples.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1994" id="shot-1994" title="Show male character, with text appearing on their left" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: Show male character, with text appearing on their left</a></p>
</div>
<div class="paragraph">
<p>Darren the developer comes up with a simple scenario to check he understands the basics of the “buy” rule: "I start with 10 credits, I shout <em>buy my muffins</em> and then <em>I want to buy some socks</em>, then I have zero credits. Correct?"</p>
</div>
<div class="paragraph">
<p>"Yes", says Paula.
<a href="#shot-1995" id="shot-1995" title="Write up Darren&#8217;s example on a green card" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: Write up Darren&#8217;s example on a green card</a></p>
</div>
<div class="paragraph">
<p>Darren writes this example up on a green card, and places it underneath the rule that it illustrates.</p>
</div>
<div class="paragraph">
<p><a href="#shot-1996" id="shot-1996" title="Show female character" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: Show female character</a>
Tammy the tester chimes in: "How about the one where you shout a word that contains <em>buy</em>, like <em>buyer</em> for example?
<a href="#shot-1997" id="shot-1997" title="Show female character with text appearing" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: Show female character with text appearing</a>
If you were to shout <em>I need a buyer for my house</em>. Would that lose credits too?"</p>
</div>
<div class="paragraph">
<p><a href="#shot-1998" id="shot-1998" title="Show second female character in foreground" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: Show second female character in foreground</a>
Paula thinks about it for a minute, and
<a href="#shot-1999" id="shot-1999" title="Second female character opens arms and smiles" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: Second female character opens arms and smiles</a>
decides that no, only the whole word <em>buy</em> counts. They’ve discovered a new rule!
<a href="#shot-2000" id="shot-2000" title="Modify text on blue card, add new green card" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 10: Modify text on blue card, add new green card</a>
They write that up on the rule card, and place the example card underneath it.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2001" id="shot-2001" title="Show male character in foreground, talking" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 11: Show male character in foreground, talking</a>
Darren asks: "How do the users get these credits? Are we building that functionality as part of this story too?"</p>
</div>
<div class="paragraph">
<p><a href="#shot-2002" id="shot-2002" title="Show female character in foreground, talking" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 12: Show female character in foreground, talking</a>
Paula tells him that’s part of another story, and they can assume the user can already purchase credits. They write that down as a rule too.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2003" id="shot-2003" title="Write 'assumption: credit purchase has already been implemented'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 13: Write 'assumption: credit purchase has already been implemented'</a></p>
</div>
<div class="paragraph">
<p>This isn’t a behaviour rule - it’s a rule about the scope of the story. It’s still useful to write it down since we’ve agreed on it. But it won’t need any examples. We could also have chosen to use a red card her to write down our assumption.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2004" id="shot-2004" title="Female character speaking, blank background; writing appears" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 14: Female character speaking, blank background; writing appears</a>
Still focussed on the “buy” rule, Tammy asks: "What if they run out of credit? Say you start with 10 credits and shout <em>buy</em> three times. What’s the outcome?"</p>
</div>
<div class="paragraph">
<p>Paula looks puzzled. "I don’t know". She says. I’ll need to give that some thought.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2005" id="shot-2005" title="Write out red card: 'What should happen when one runs out of credits?" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 15: Write out red card: 'What should happen when one runs out of credits?</a>
Darren takes a red card and writes this up as a question.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2006" id="shot-2006" title="More (empty) cards appearing" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 16: More (empty) cards appearing</a>
They apply the same technique to the other rule about long messages, and pretty soon the table is covered in cards, reflecting the rules, examples and questions that have come up in their conversation. Now they have a picture in front of them that reflects back what they know, and still don’t know, about this story.</p>
</div>
<div class="sect3">
<h4 id="_lesson_2_questions_5">8.2.1. Lesson 2 - Questions</h4>
<div class="sect4">
<h5 id="_what_do_the_green_cards_represent_in_an_example_map">What do the <strong>Green</strong> cards represent in an example map?</h5>
<div class="ulist">
<ul>
<li>
<p>Stories</p>
</li>
<li>
<p>Rules</p>
</li>
<li>
<p>Examples (<strong>Correct</strong>)</p>
</li>
<li>
<p>Questions or assumptions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>We use the green card to represent examples because when we turn them into tests we want them to go green and pass!</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_do_the_blue_cards_represent_in_an_example_map">What do the <strong>Blue</strong> cards represent in an example map?</h5>
<div class="ulist">
<ul>
<li>
<p>Stories</p>
</li>
<li>
<p>Rules (<strong>Correct</strong>)</p>
</li>
<li>
<p>Examples</p>
</li>
<li>
<p>Questions or assumptions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>We use the blue cards to represent rules because they&#8217;re fixed, or frozen, like blue ice.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_do_the_red_cards_represent_in_an_example_map">What do the <strong>Red</strong> cards represent in an example map?</h5>
<div class="ulist">
<ul>
<li>
<p>Stories</p>
</li>
<li>
<p>Rules</p>
</li>
<li>
<p>Examples</p>
</li>
<li>
<p>Questions or assumptions (<strong>Correct</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>We use the red cards to represent questions and assumptions because it indicates danger! There&#8217;s still some uncertainty to be resolved here.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_do_the_yellow_cards_represent_in_an_example_map">What do the <strong>Yellow</strong> cards represent in an example map?</h5>
<div class="ulist">
<ul>
<li>
<p>Story (<strong>Correct</strong>)</p>
</li>
<li>
<p>Rule</p>
</li>
<li>
<p>Example</p>
</li>
<li>
<p>Question or assumption</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>We chose the yellow cards to represent stories in our example mapping sessions, mostly because that was the last colour left over in the pack!</p>
</div>
</div>
<div class="sect4">
<h5 id="_look_at_the_following_example_map_do_you_think_the_team_is_ready_to_start_coding_yet">Look at the following example map. Do you think the team is ready to start coding yet?</h5>
<div class="imageblock">
<div class="content">
<img src="example-map-1.png" alt="example map 1">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>No. There are still a lot of questions to resolve.</p>
</li>
<li>
<p>No. They probably haven&#8217;t explored the story enough yet. More conversation needed. (<strong>Correct</strong>)</p>
</li>
<li>
<p>No. There are too many rules. They should try to slice the story first.</p>
</li>
<li>
<p>Yes. There&#8217;s a good number of examples for each rule, and no questions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>When an example map shows only a few cards, and some rules with no examples at all, it suggests that either the story is very simple, or the discussion hasn&#8217;t gone deep enough yet.</p>
</div>
</div>
<div class="sect4">
<h5 id="_look_at_the_following_example_map_do_you_think_the_team_is_ready_to_start_coding_yet_2">Look at the following example map. Do you think the team is ready to start coding yet?</h5>
<div class="imageblock">
<div class="content">
<img src="example-map-2.png" alt="example map 2">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>No. There are still a lot of questions to resolve.</p>
</li>
<li>
<p>No. They probably haven&#8217;t explored the story enough yet. More conversation needed.</p>
</li>
<li>
<p>No. There are too many rules. They should try to slice the story first.</p>
</li>
<li>
<p>Yes. There&#8217;s a good number of examples for each rule, and no questions. (<strong>Correct</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>This example map shows a good number of examples for each rule, and no questions. If the team feel like the conversation is finished, then they&#8217;re probably ready to start hacking on this story.</p>
</div>
</div>
<div class="sect4">
<h5 id="_look_at_the_following_example_map_do_you_think_the_team_is_ready_to_start_coding_yet_3">Look at the following example map. Do you think the team is ready to start coding yet?</h5>
<div class="imageblock">
<div class="content">
<img src="example-map-3.png" alt="example map 3">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>No. There are still a lot of questions to resolve. (<strong>Correct</strong>)</p>
</li>
<li>
<p>No. They probably haven&#8217;t explored the story enough yet. More conversation needed.</p>
</li>
<li>
<p>No. There are too many rules. They should try to slice the story first.</p>
</li>
<li>
<p>Yes. There&#8217;s a good number of examples for each rule, and no questions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>The large number of red cards here suggests that the team have encountered a number of questions that they couldn&#8217;t resolve themselves. Often this is an indication that there&#8217;s someone missing from the conversation. It would probably be irresponsible to start coding until at least some of those questions have been resolved.</p>
</div>
</div>
<div class="sect4">
<h5 id="_look_at_the_following_example_map_do_you_think_the_team_is_ready_to_start_coding_yet_4">Look at the following example map. Do you think the team is ready to start coding yet?</h5>
<div class="imageblock">
<div class="content">
<img src="example-map-4.png" alt="example map 4">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>No. There are still a lot of questions to resolve.</p>
</li>
<li>
<p>No. They probably haven&#8217;t explored the story enough yet. More conversation needed.</p>
</li>
<li>
<p>No. There are too many rules. They should try to slice the story first. (<strong>Correct</strong>)</p>
</li>
<li>
<p>Yes. There&#8217;s a good number of examples for each rule, and no questions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>When an example map is wide like this, with a lot of different rules, it&#8217;s often a signal that there&#8217;s an opportunity to slice the story up by de-scoping some of those rules from the first iteration. Even if it&#8217;s not something that would be high enough quality to ship to a customer, you can often defer some of the rules into another story that you can implement later.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_mapping_conclusions">8.3. Example Mapping: Conclusions</h3>
<div class="paragraph">
<p><a href="#shot-2007" id="shot-2007" title="Animation of Matt talking to camera" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 1: Animation of Matt talking to camera</a></p>
</div>
<div class="paragraph">
<p>As you’ve just seen, an example mapping session should go right across the breadth of the story, trying to get a complete picture of the behaviour. Inviting all three amigos - product owner, tester and developer - is important because each perspective adds something to the conversation.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2008" id="shot-2008" title="Diagram showing user story &#8594; example mapping &#8594; rules / examples" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 2: Diagram showing user story &#8594; example mapping &#8594; rules / examples</a></p>
</div>
<div class="paragraph">
<p>Although the apparent purpose of an example mapping session is to take a user story, and try to produce rules and examples that illustrate the behaviour, the underlying goal is to achieve a
<a href="#shot-2009" id="shot-2009" title="Show <strong>shared understanding</strong> appearing" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 3: Show <strong>shared understanding</strong> appearing</a>
 <em>shared understanding</em> and agreement about the precise scope of a user story. Some people tell us that example mapping has helped to build empathy within their team!</p>
</div>
<div class="paragraph">
<p>With this goal in mind, make sure the session isn’t just a rubber-stamping exercise, where one person does all the talking. Notice how in our example, everyone in the group was asking questions and writing new cards.</p>
</div>
<div class="paragraph">
<p>In the conversation, we often end up
<a href="#shot-2010" id="shot-2010" title="show feedback arrow going back to 'User Story'" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 4: show feedback arrow going back to 'User Story'</a>
refining, or even slicing out new user stories
<a href="#shot-2011" id="shot-2011" title="show New user Stories" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 5: show New user Stories</a>
to make the current one smaller.  Deciding what a story is not - and maximising the amount of work not done - is one of the most useful things you can do in a three amigos session. Small stories are the secret of a successful agile team.</p>
</div>
<div class="paragraph">
<p>Each time you come up with an example, try to understand what the underlying rule or rules are. If you discover an example that doesn’t fit your rules, you’ll need to reconsider your rules. In this way, the scope of the story is refined by the group.</p>
</div>
<div class="paragraph">
<p>Although there’s no doubt of the power of examples for exploring and talking through requirements, it’s the rules that will go into the code. If you understand the rules, you’ll be able to build an elegant solution.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2012" id="shot-2012" title="David West / Object Thinking quote" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 6: David West / Object Thinking quote</a>
As Dr David West says in his excellent book "Object Thinking", <em>If you problem the solution well enough, the solution will take care of itself</em>.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2013" id="shot-2013" title="Return to diagram" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 7: Return to diagram</a></p>
</div>
<div class="paragraph">
<p>Sometimes, you’ll come across questions that nobody can answer. Instead of getting stuck trying to come up with an answer, just write down the question.
<a href="#shot-2014" id="shot-2014" title="show questions / assumptions as output" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 8: show questions / assumptions as output</a></p>
</div>
<div class="paragraph">
<p>Congratulations! You’ve just turned an unknown unknown into a known unknown. That’s progress.</p>
</div>
<div class="paragraph">
<p><a href="#shot-2015" id="shot-2015" title="Animation of Matt talking to camera" style="border-radius: 10px; padding: 2px 5px 2px 5px; color: white; font-weight: bold; background-color: red; font-family: sans-serif; text-decoration: none;">🎬 9: Animation of Matt talking to camera</a></p>
</div>
<div class="paragraph">
<p>Many people think they need to produce formal Gherkin scenarios from their three amigos conversations, but in our experience that’s only occasionally necessary. In fact, it can often slow the discussion down.</p>
</div>
<div class="paragraph">
<p>The point of an example mapping session is to do the <em>discovery</em> work. You can do <em>formulation</em> as a separate activity, next.</p>
</div>
<div class="paragraph">
<p>One last tip is to run your example mapping sessions in a timebox. When you’re practiced at it, you should be able to analyse a story within 25 minutes. If you can’t, it’s either too big, or you don’t understand it well enough yet. Either way, it’s not ready to play.</p>
</div>
<div class="paragraph">
<p>At the end of the 25 minutes, you can check whether everyone thinks the story is ready to start work on. If lots of questions remain, it would be risky to start work, but people might be comfortable taking on a story with only a few minor questions to clear up. Check this with a quick thumb-vote.</p>
</div>
<div class="sect3">
<h4 id="_lesson_3_questions_3">8.3.1. Lesson 3 - Questions</h4>
<div class="sect4">
<h5 id="_which_of_the_following_are_direct_outcomes_you_could_expect_if_your_team_starts_practcing_example_mapping">Which of the following are direct outcomes you could expect if your team starts practcing Example Mapping?</h5>
<div class="ulist">
<ul>
<li>
<p>Less rework due to bugs found in your stories (<strong>Correct</strong>)</p>
</li>
<li>
<p>Greater empathy and mutual respect between team members (<strong>Correct</strong>)</p>
</li>
<li>
<p>Amazing Gherkin that reads really well</p>
</li>
<li>
<p>Smaller user stories (<strong>Correct</strong>)</p>
</li>
<li>
<p>A shared understanding of what you&#8217;re going to build for the story (<strong>Correct</strong>)</p>
</li>
<li>
<p>More predicatable delivery pace (<strong>Correct</strong>)</p>
</li>
<li>
<p>A quick sense of whether a story is about the right size and ready to start writing code. (<strong>Correct</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>We don&#8217;t write Gherkin during an example mapping session, so that&#8217;s not one of the direct outcomes, though a good example mapping session should leave the team ready to write their best Gherkin.</p>
</div>
</div>
<div class="sect4">
<h5 id="_which_of_the_following_presents_the_most_risk_to_your_project">Which of the following presents the most risk to your project?</h5>
<div class="ulist">
<ul>
<li>
<p>Unknown unknowns (<strong>Correct</strong>)</p>
</li>
<li>
<p>Known unknowns</p>
</li>
<li>
<p>Known knowns</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong></p>
</div>
<div class="paragraph">
<p>In project management, there are famously "uknown unknowns", "known unknowns" and "known knowns". The most dangerous are the "unknown unknows" because not only do we not know the answer to them, we have not even realised yet that there&#8217;s a question!</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_support_code">9. Support Code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Chapter 7 we refined the Gherkin of the Premium Accounts feature, turning what had started out as nothing more than an automated test into some valuable documentation.</p>
</div>
<div class="paragraph">
<p>As we did that, we <em>pushed the "how" down</em>, making the scenarios themselves more declarative of the desired behaviour, pushing the implementation details of the testing into the code in the step defintions below.</p>
</div>
<div class="paragraph">
<p>In doing this, we got more readable, maintainable and useful scenarios in exchange for more complex automation code. In this chapter we&#8217;ll show you how to organise your automation support code so that you won&#8217;t be afraid of making this trade-off.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acceptance_tests_vs_unit_tests">10. Acceptance Tests vs Unit Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the last chapter, we extracted a layer of support code from your step definitions to keep your Cucumber code easy - and cost-effective - to maintain.</p>
</div>
<div class="paragraph">
<p>We’re going to keep things technical in this chapter. Remember that bug we spotted right back at the beginning of lesson seven, where the user was over-charged if they mentioned “buy” several times in the same message? It’s finally time to knuckle down and fix it.</p>
</div>
<div class="paragraph">
<p>As we do so, you’re going to get some more experience of the inner and outer BDD loops that we first introduced you to in lesson 5. We’ll learn about mock objects, and explore the difference between unit tests and acceptance tests, and learn the value of each.</p>
</div>
<div class="paragraph">
<p>If you’re someone who doesn’t normally dive deep into code, try not to worry. We’ll keep the example from moving too fast, and we hope you’ll find it educational to see how different kinds of tests complement each other in helping you to build a quality product.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_web_automation_with_selenium_webdriver">11. Web automation with Selenium Webdriver</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO: Import the original script.</p>
</div>
<div class="paragraph">
<p><a href="https://drive.google.com/drive/u/0/folders/0B1Qgdp5tWFyzZ25NQjloazhjTUk?ths=true" class="bare">https://drive.google.com/drive/u/0/folders/0B1Qgdp5tWFyzZ25NQjloazhjTUk?ths=true</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-06-06 17:46:55 UTC
</div>
</div>
</body>
</html>